---
title: "Eye-Tracking-Analysis"
output: html_notebook
---

#Download data for analysis

```{r}
install.packages("Rtools")
install.packages("tidyr")
library(dplyr)
library(tidyr)
library(ggplot2)
library(Matrix)#, lib.loc = "C:/Program Files/R/R-4.4.1/library") #may need to change dependent on where saved
library(readxl)
library(readr)
library(rlang)
library(tibble)

```


Open Excel File of demographic data and questionnaire answers: (can also download on the environment tab)
```{r}
Demographics <- read_excel("C:/Users/mande/OneDrive/Masters!/Project/Eye tracking/Data/Demographic Data FINAL.xlsx", #file path
     col_types = c("text", "text", "text", 
         "numeric", "text", "text", "text", 
         "text", "text", "text", "text", "text", 
         "text", "text", "text", "text", "date"), 
     na = "NA") #NA is empty info or none 
head(Demographics)
```

download data export file from tobii (tsv file) different info from metrics download so compare

```{r}
data_export_no_filter <- read_delim("C:/Users/mande/OneDrive/Masters!/Project/Eye tracking/Data/Data export new aois Export FINAL.tsv", 
     delim = "\t", escape_double = FALSE, 
     col_types = cols(`Recording date` = col_date(format = "%d/%m/%Y")), 
     trim_ws = TRUE)
head(data_export_no_filter)
View(data_export_no_filter) #opens in another R tab to view all 
```
metric file donload, takes awhile to download ! (very large file )

```{r}
#5401 parsing errors 
metrics_all_new <- read_delim("C:/Users/mande/OneDrive/Masters!/Project/Eye tracking/Data/Areej pilot Metrics FINAL FINAL ALL MEDIA AND METRICS.tsv", 
   delim = "\t", escape_double = FALSE, 
   trim_ws = TRUE)
View(metrics_all_new)
print(metrics_all_new)
```

#Data cleaning

need to clean datasets now! for both tobii datasets, need to adjust the participant columns so that i split participant name as currently like this 'char1' and to be able to merge with excel need it to be 'char 1'

```{R}
# insert a space between "participant" and the number
metrics_all_new$Participant <-gsub("Participant(\\d+)", "Participant \\1", metrics_all_new$Participant)
tail(metrics_all_new)
```

do the same for the raw data export tobii file 

```{r}
# insert a space between "Participant" and the number
data_export_no_filter$'Participant name' <- gsub("Participant(\\d+)", "Participant \\1", data_export_no_filter$'Participant name')

head(data_export_no_filter)
tail(data_export_no_filter)

```

need to view participant 21 as i forgot to change the participant name to the next number when administering the eye tracking; so the recording has the correct number 22 but is listed in the participant column as 21 - compare to recording name as it is correct --> then change for both dataframes as it's correct then 

```{r}
incorrect_rows <- metrics_all_new$Recording == "Participant 22" & metrics_all_new$Participant == "Participant 21"
print(metrics_all_new[incorrect_rows, ])

# update the participant number 
metrics_all_new$Participant[incorrect_rows] <- "Participant 22"

#now the recording name is for the right participant!
View(metrics_all_new)
unique(metrics_all_new$Participant)
```

now do the same for the raw data file 

```{r}
unique(data_export_no_filter$`Recording name`)
unique(data_export_no_filter$`Participant name`)
``` 
print rows in raw data with recording name participant 22

```{r}
# Print rows where Recording name is 'Recording 22'
print(data_export_no_filter[data_export_no_filter$`Recording name` == "Participant 22", ])
```


```{r}
#rows where the recording name is 'participant 22' and participant name is 'articipant 21'
incorrect_rows_raw <- data_export_no_filter$'Recording name' == "Participant 22" & data_export_no_filter$'Participant name' == "Participant 21"
print(data_export_no_filter[incorrect_rows_raw, ])

# update participant name for those rows
data_export_no_filter$`Participant name`[incorrect_rows_raw] <- "Participant 22"

# view the modified data
View(data_export_no_filter) #NOW CHANGED !
unique(data_export_no_filter$`Participant name`)
```

now i need to compare each of the dataframes to see the data in both of the them 
first the different variables (columns)
```{r}
#save column names in seperate df
raw_cols <- names(data_export_no_filter)
ff_cols <- names(metrics_all_new)

#columns in data export file but not in metrics file
cols_in_raw_not_in_ff <- setdiff(raw_cols, ff_cols)

#columns in metrics file but not in data export file
cols_in_ff_not_in_raw <- setdiff(ff_cols, raw_cols)

#print the differences
print(cols_in_raw_not_in_ff)
#print(cols_in_ff_not_in_raw) #Uncomment to run --> prints alot of colnames 

```
so we can see that AOI hits for each participant for each AOI for every image is in the data export file and not the metric export file, eye movement type - 300 columns missing but majority are AOI based as well as calibration and gaze point data (ie gaze fixation type etc)

we can also see that 9245 columns are in the metric export file and not in the raw data export file, and it includes all AOI data in relation to fixations, saccades, glances visits, etc for every participant, it has all averages, total duration for each aoi for each painting, so we can disregard the data export file as the other file as all the metrics and measures we need

so what we can do now is take the AOI hit data from the one dataframe and put it in the fixation_filter data but this is likely not needed as the AOI hits are binary (0,1) values of yes or no but the metric file has the info we need for analysis, so we can disregard that dataframe. 

Now we will double check the media column  in the chosen df to make sure it is not empty as this is vital to data exploration 

```{r}
#check if any missing values in the media column (stimuli)
na_check <- metrics_all_new %>% filter(is.na(Media))
if (nrow(na_check) > 0) {
  print(paste("There are", nrow(na_check), "missing values in the Media column."))
} else {
  print("There are no missing values in the Media column.")
}

```
Now i am going to check the interval value: to make sure that any duplicates of the image shown are removed: if 1 its fine if two then needs to be removed: but first i want to check which participants this applies to : should be only one and two 
```{r}
# find participants with interval value : 2
participants_with_interval_of_2 <- metrics_all_new %>% #metrics_fixation_filter %>%
  filter(Interval == 2) %>%
  select(Participant, Media)

print(participants_with_interval_of_2)

```
now remove the second interval data as it is now they've already seen it so will change gaze data (based on lit)
```{r}
# remove rows with interval value 2
metrics <- metrics_all_new %>% filter(Interval !=2) #put into new df called metrics
unique(metrics$Interval) #to double check that only 1 exists in this column now
```
it has changed from shape 630 x y to 624 x y meaning the 6 have been removed but lets double check
```{r}
interval_2 <- metrics %>%
  filter(Interval == 2) %>%
  select(Participant, Media)

print(interval_2)
#NO INTERVAL 2 DATA PERFECT !
```


```{r}
View(metrics)
```

good idea to check the columns are the same as only obsvs changed 

```{r}
#store column names 
original_columns <- colnames(metrics_all_new)
filtered_columns <- colnames(metrics)

# columns in original df and not in df filtered
columns_in_original_not_in_filtered <- setdiff(original_columns, filtered_columns)

# columns in df filtered but not in original df
columns_in_filtered_not_in_original <- setdiff(filtered_columns, original_columns)

print(columns_in_original_not_in_filtered)
print(columns_in_filtered_not_in_original)

```
so all the same columns no differences only the 6 duplicate obsv were removed !!

now am going to add a media and order column here , as doing it after merging esp for the order column was too difficult , and this is necessary for the analysis purposes !

```{r}
#assign each media to a condition
media_conditions <- c(
  "Realistic image 1" = "Realistic image", "Realistic image 2" = "Realistic image", "Realistic image 3" = "Realistic image", "Realistic image 4" = "Realistic image", "Realistic image 5" = "Realistic image",
  "Portrait Painting 1" = "Portrait Painting", "Portrait Painting 2" = "Portrait Painting", "Portrait Painting 3" = "Portrait Painting", "Portrait Painting 4" = "Portrait Painting", "Portrait Painting 5" = "Portrait Painting",
  "Semi-abstract 1" = "Semi-abstract", "Semi-abstract 2" = "Semi-abstract", "Semi-abstract 3" = "Semi-abstract", "Semi-abstract 4" = "Semi-abstract", "Semi-abstract 5" = "Semi-abstract",
  "Abstract 1" = "Abstract", "Abstract 3" = "Abstract", "Abstract 4" = "Abstract", "Abstract 5" = "Abstract", "Abstract 6" = "Abstract",
  "Very Abstract 1" = "Very Abstract", "Very Abstract 2" = "Very Abstract", "Very Abstract 3" = "Very Abstract", "Very Abstract 4" = "Very Abstract", "Very Abstract 5" = "Very Abstract"
)

#condition column based on media column
metrics <- metrics %>%
  mutate(Condition = media_conditions[Media])

# reorder columns 
metrics <- metrics %>%
  select(Participant, Recording, TOI, Interval, Media, Condition, everything())

print(metrics)
View(metrics)

```

now add order column (doing it here then join)
```{r}
#order media in terms of least abstract to most 
media_order <- c(
  "Realistic image 1", "Realistic image 2", "Realistic image 3", "Realistic image 4", "Realistic image 5",
  "Portrait Painting 1", "Portrait Painting 2", "Portrait Painting 3", "Portrait Painting 4", "Portrait Painting 5",
  "Semi-abstract 1", "Semi-abstract 2", "Semi-abstract 3", "Semi-abstract 4", "Semi-abstract 5",
  "Abstract 1", "Abstract 3", "Abstract 4", "Abstract 5", "Abstract 6",
  "Very Abstract 1", "Very Abstract 2", "Very Abstract 3", "Very Abstract 4", "Very Abstract 5"
)

#create order column via media
metrics <- metrics %>%
  group_by(Participant) %>%
  mutate(Order = row_number()) %>%
  ungroup()

#reorder
metrics <- metrics %>%
  select(Participant, Recording, TOI, Interval, Media, Order, Condition, everything())

#order in terms of abstractness
metrics %>%
  mutate(Media= factor(Media, levels = media_order))

print(metrics)
View(metrics)
```


##Reshape data from wide to long

###fixation metrics

need to reshape data : from long to wide BEFORE merging as most of the columns have mainly NA data and few values
 adn this is notgood for data analysis : needs to be tidy data format 
```{r}
#separate dataframe based on metrics AS TOO COMPLICATED TO RESHAPE ALL AT ONCCE
fixation_metrics <- metrics %>%
  select(Participant, Recording, TOI, Media, Order, Condition, Interval, contains("Fixation", ignore.case=TRUE))

print(fixation_metrics)
View(fixation_metrics)
#624 x 4391 --> double check in next block 
```
```{r}
#check column names  
View(fixation_metrics)  
```
so has printed all fixation columns which can now be reshaped --> bare in mind the groupings apply to specific features(5 AOIS: face, background, eyes, nose and mouth) and groups (realistic, portrait, semi-abstract, abstract and very abstract)

main fixation metrics are: total duration of fixation; avg duration of fixations; no of fixations; time to first fixation; duration of first fixation; total duration of whole fixations; avg duration of whole fixations; no of whole fixations; time to first whole fixation; duration of first whole fixation --> applied to each AOI of each painting (5x5), feature(5) and painting group(5)

so now lets reorder this: from wide to long format (read up about this)
```{r}
#reshape from wide to long
fixation_metrics_long <- fixation_metrics %>%
  pivot_longer(
    cols = -c(Participant, Recording, TOI, Media, Order, Condition, Interval),  #excludefrom reshape 
    names_to = "Metric",  #put all values in one metric column
    values_to = "Value",       #all numbers in one column 
    values_drop_na = TRUE #FALSE
  ) 

print(fixation_metrics_long)
View(fixation_metrics_long)

```

basically goes in order of abstract, portrait, realistic, semi, very, going through the AOIS for each image per metric

removing the "...+number" in the column names so that i can then use for analysis 
```{r}
# rename columns 
fixation_metrics_long <- fixation_metrics_long %>%
  mutate(Metric = gsub("\\.\\.\\.[0-9]+$", "", Metric))

View(fixation_metrics_long)

```
It worked! 

so now am gonna drop duplicates (some seen)
```{r}
fixation_metrics_long_final<- fixation_metrics_long %>%
  distinct()

View(fixation_metrics_long_final)
```


Perfect! now only distinct values for each of the AOIs for each media for each participant 

###saccade metrics 
now repeat for saccade, glance, visit and AOI metrics and then recombine back into one massive dataframe  
begin with saccade metrics 

```{r}
#saccade metrics
saccade_metrics <- metrics %>%
  select(Participant, Recording, TOI, Media, Order, Condition, Interval, contains("Saccade", ignore.case=TRUE))

print(saccade_metrics)
View(saccade_metrics)
#624 x 1481 --> double check in next block
#dont forget first couple metrics are singular so no NA in columns 
```
first few metrics are singular: number of saccades, avg peak velocity of saccades, min peak velocity of saccades, max peak velocity of saccades. std dev of peak velocity saccades; avg amplitude of saccades; min amp of saccades; max amplitude of saccades; total amplitude of saccades;time to first ssaccade, dirreciton of first saccade, peak velocity of first saccade, avg velocity of first saccade, amplitude of first saccade

although singular columns (no repeats), dont forget that theres at least 26 observations for each participant, based on the diff media being viewed at the time, as well as no. 26 : entire recording 

other saccade metrics split by AOI:
no of saccades in AOI (eyes, nose mouth, group);time to entry saccade; time to exit saccade;peak velocity of entry saccade; peak velocity of exit saccade;

```{r}
View(saccade_metrics)
```

```{r}
# reshape from wide to long format
saccade_metrics_long <- saccade_metrics %>%
  pivot_longer(
    cols = -c(Participant, Recording, TOI, Media, Order, Condition, Interval),  #exclude from reshaping
    names_to = "Metric",  
    values_to = "Value",       
    values_drop_na = TRUE
  ) 

print(saccade_metrics_long)
View(saccade_metrics_long)

```

```{r}
# remove "...+Number" from column names 
saccade_metrics_long_final <- saccade_metrics_long %>%
  mutate(Metric = gsub("\\.\\.\\.[0-9]+$", "", Metric))

View(saccade_metrics_long_final)
```

have removed the numbers from the columns now remove . feature to remove duplicates


```{r}
# drop duplicate rows based on relevant columns (can skip the size of df stays the same )
saccade_metrics_long_final <- saccade_metrics_long_final %>%
  distinct()

View(saccade_metrics_long_final)
print(saccade_metrics_long_final)
```
saccade is done perfectly !
glance metrics now !
###glance metrics

```{r}
glance_metrics <- metrics %>%
  select(Participant, Recording, TOI, Media, Order, Condition, Interval, contains("Glance", ignore.case=TRUE))

print(glance_metrics)
View(glance_metrics)
#624 x 2051 --> double check in next block

```
starts with AOI glance metrics (no singular metrics)
```{r}
View(glance_metrics)
```
glance is split into group further split by indidivual features by image :
total duration of glances;avg duration of glances; max duration of glances; minimum duration of glances;no of glances

```{r}
# reshape from wide to long format
glance_metrics_long <- glance_metrics %>%
  pivot_longer(
    cols = -c(Participant, Recording, TOI, Media, Order, Condition, Interval),  #exclude from reshaping
    names_to = "Metric",  
    values_to = "Value",  
    values_drop_na = TRUE
  ) 

print(glance_metrics_long)
View(glance_metrics_long)

```

```{r}
# Rename columns, remove column numbers in names 
glance_metrics_long <- glance_metrics_long %>%
  mutate(Metric = gsub("\\.\\.\\.[0-9]+$", "", Metric))


View(glance_metrics_long)
```

now drop duplicates

```{r}
# drop duplicates can skip as df size the same also
glance_metrics_long_final <- glance_metrics_long %>%
  distinct()

View(glance_metrics_long_final)
print(glance_metrics_long_final)
```
glance done! 

###visit metrics
now visit and then AOI
```{r}
visit_metrics <- metrics %>%
  select(Participant, Recording, TOI, Media, Order, Condition, Interval, contains("visit", ignore.case=TRUE))

print(visit_metrics)
View(visit_metrics)
#624 x 2051 

```

```{r}
View(visit_metrics)

```

visits is split by group and feature: total duration of visit; avg duration of visit; no of visits

```{r}
#reshape from wide to long format
visit_metrics_long <- visit_metrics %>%
  pivot_longer(
    cols = -c(Participant, Recording, TOI, Media, Order, Condition, Interval),  #exclude from reshaping
    names_to = "Metric",  
    values_to = "Value",      
    values_drop_na = TRUE
  ) 

print(visit_metrics_long)
View(visit_metrics_long)

```

same as others remove numbers from variable names

```{r}
#rename columns remove numbers in names
visit_metrics_long <- visit_metrics_long %>%
  mutate(Metric = gsub("\\.\\.\\.[0-9]+$", "", Metric))


View(visit_metrics_long)
print(visit_metrics_long)
```

drop duplicates now 

```{r}
#drop duplicates (changed from 9x40896 to 9x36746)
visit_metrics_long_final <- visit_metrics_long %>%
  distinct()

View(visit_metrics_long_final)
print(visit_metrics_long_final)
```

FIRST NEED  TO DOUBLE CHECK THERE ARE OTHER COLUMNS WITH AOIS IN IT NOT ALREADY COVERED  

```{r}
aoi_cols <- grep("aoi", names(metrics), ignore.case = TRUE, value = TRUE)

# print(aoi_cols) #unocmment to view (294 column names printed )

```

okay so no need to do that as the only metrics with AOI in them are saccade measurements and those are already done ! SO now i can join all them back together to make the `metrics_long` df and then join it with demographics .

#merging dfs
```{r}
#combine all reshpaed data together 
metrics_combined_long <- bind_rows(
  fixation_metrics_long_final,
  saccade_metrics_long_final,
  glance_metrics_long_final,
  visit_metrics_long_final
)

metrics_combined_long <- metrics_combined_long %>%
  arrange(Participant, Order, Media, Metric)

print(metrics_combined_long)
View(metrics_combined_long)
```

Now lets try and figure out how to merge the dataframe of metrics with the demographics when they have diff number of observations --> i need to duplicate the info for each participant ie metrics df has multiple of each participant so i need to make sure the demographics df merges and adds the same info to each observation as it has max 2 observations per participant !

left-join?
```{r}
# left join
metrics_demographics <- metrics_combined_long %>%
  left_join(Demographics, by = "Participant", relationship = "many-to-many")

print(dim(metrics_demographics))
view(metrics_demographics)

```
okay this is happening because i did tidy data format for the demographics so now what it has done is duplicate each row for the participants with 2 ND's, so each media repeats for participant one who is adhd and autistic but wont for those with just one or none  --> so double checked and it is many to many so will set relatiomship to many to many; "A many-to-many relationship occurs when multiple rows in both data frames match each other based on the join key."

so if you look at demographics P1 has 2 NDs so each media is duplicated (row is duplicated but with different ND diagnosis ) and then for eg P4 OR P3 who is autistic only and NT respectively they have one 

also doing it this way worked perfectly with the order for those with 2 ND's so each datapoint is repeated with a different diagnosis but order is the same number 

OBSERVATIONS ARE ONLY DUPLICATE FOR THOSE WITH TWO ND'S 
lets see that in filtered form

```{r}
 # count the number of unique ND diagnoses
diagnosis_count <- metrics_demographics %>%
  group_by(Participant) %>%
  summarise(unique_diagnoses = n_distinct(`Neurodiversity diagnosis`))

# those with more than one diagnosis
participants_with_multiple_diagnoses <- diagnosis_count %>%
  filter(unique_diagnoses > 1)
print(participants_with_multiple_diagnoses)

# join back to get the full data for these participants
filtered_df <- metrics_demographics %>%
  filter(Participant %in% participants_with_multiple_diagnoses$Participant)
print(filtered_df)

```

and this is correct !! only 4 people have more than one diagnosis of ND, and they are the only ones with each observartion duplicated but with the other diagnosis 

going to reorder columns so demographics in first couple columns not end 

```{r}
#reorder columns so demographics at the front (left all consent and other Qs at the end)
metrics_demographics <- metrics_demographics %>%
  select(Participant, 'Participant Code', Recording, Date,  Gender, Age, 'Do you identify as neurodiverse?', 'Neurodiversity diagnosis', TOI, Media, Order, Condition, Interval, Metric, Value, everything())

View(metrics_demographics)
```

bit complicated column names so let's rename the demographic column names: 

```{r}
#rename column names
metrics_demographics <- metrics_demographics %>%
  rename(
    'Participant_code' = 'Participant Code',
    'Neurodiverse' = 'Do you identify as neurodiverse?',
    'Diagnosis' = 'Neurodiversity diagnosis'
  )

print(names(metrics_demographics)[1:10])

```
okay so now lets change `Neurodiverse` into another column with binary where 0 = no and 1= yes (notes)

```{r}
metrics_demographics <- metrics_demographics %>%
  mutate(ND_or_NT_numeric = ifelse(Neurodiverse == "Yes", 1, 0))

metrics_demographics <- metrics_demographics %>%
  select(Participant, Participant_code, Date,  Gender, Age, Neurodiverse, ND_or_NT_numeric, everything())

print(head(metrics_demographics))
View(metrics_demographics)
```
now am also going to add another column based on the `diagnosis` column where 0 = NONE, 1=Autism, 2=ADHD, 3= OCD 4= Dyslexia, 5=additional support needs and 6=other 

```{r}
metrics_demographics <- metrics_demographics %>%
  mutate(Diagnosis_numeric = case_when(
    is.na(Diagnosis) | Diagnosis == "" ~ 0,
    Diagnosis == "Autism" ~ 1,
    Diagnosis == "ADHD" ~ 2,
    Diagnosis == "OCD" ~ 3,
    Diagnosis == "Dyslexia" ~ 4,
    Diagnosis == "Additional Support Needs" ~ 5,
    Diagnosis == "Other" ~ 6,
    TRUE ~ NA_real_  # for na values or unexpected 
  ))


metrics_demographics <- metrics_demographics %>%
  select(Participant, Participant_code, Date,  Gender, Age, Neurodiverse, ND_or_NT_numeric, Diagnosis, Diagnosis_numeric, everything())

print(metrics_demographics)
```

probably also a good idea to fill in the NT diagnosis that are currently empty with `None` or something so its not just empty data points 
```{r}
metrics_demographics <- metrics_demographics %>%
  mutate(Diagnosis = replace_na(Diagnosis, "None"))

print(unique(metrics_demographics$Diagnosis))
```

```{r}
glimpse(metrics_demographics) #Expand to view
```

OKAY SO I AM FROM THE FUTURE (line 1000) AND TO MAKE VISUALSIATIONS EASIER I AM GOING TO ADD ANOTHER COLUMN THAT HAS MULTIPLE DIAGNOSES FOR THE PARTICIPANTS AS SOME HAVE MORE THAN ONE AND WHEN PLOTTING I CAN ONLY SEE ONE SO 
```{r}
metrics_demographics <- metrics_demographics %>% group_by(Participant) %>%
  mutate(Combined_Diagnosis = paste(unique(Diagnosis), collapse = ", ")) %>%
  ungroup() %>%
  select(Participant, Participant_code, Date, Gender, Age, Neurodiverse, ND_or_NT_numeric, Diagnosis, Diagnosis_numeric, Combined_Diagnosis, everything())


print(metrics_demographics)
View(metrics_demographics)

```
okay lets double check its correct for the participants 
```{r}
unique_diagnoses <- metrics_demographics %>%
  select(Participant, Combined_Diagnosis) %>%
  distinct()

print(unique_diagnoses)
View(unique_diagnoses)

```
correct !
lets check for missing values now to make sure every basis covered

```{r}
# check for missing values
missing_values <- colSums(is.na(metrics_demographics))
print(missing_values) # condition and age need to be fixed  !!!
```
says age and condition have some missing? need to double check :

```{r}
# find rows with missing age values
missing_values <- metrics_demographics %>%
  filter(is.na(Age))

print(missing_values)
View(missing_values)

```
ADD AGE IN for participant 24 as did not put in excel file
double checked he said 25

```{R}
#ADD AGE for participant 24 

metrics_demographics <- metrics_demographics %>%
  mutate(Age = if_else(is.na(Age) & Participant == "Participant 24", 25, Age))

tail(metrics_demographics)
View(metrics_demographics)
```
double check its been filled
```{r}
missing_age <- metrics_demographics %>%
  filter(is.na(Age))
print(missing_age)

```
FIXED !!!
check condition column --> likely to be the all THE MEDIA (ENITRE RECORDING) can just change that but check first !
```{r}
missing_values_2 <- metrics_demographics %>%
  filter(is.na(Condition))

print(missing_values_2)
View(missing_values_2)

```
so change NA based on TOI to 'Entire Recording' as well as for media to make visualsiations easier 

```{r}
# fill condition values based on the Toi column
metrics_demographics <- metrics_demographics %>%
  mutate(Condition = if_else(is.na(Condition) & TOI == "Entire Recording", "Entire Recording", Condition))

print(metrics_demographics)
View(metrics_demographics)

```
double check if condition is still empty 

```{r}
missing_values_2 <- metrics_demographics %>%
  filter(is.na(Condition))

print(missing_values_2)

```
also change media to entire recording based on TOI so its not every single one listed (readability issues)

```{r}
# update media column based on the Toi column
metrics_demographics <- metrics_demographics %>%
  mutate(Media = if_else(TOI == "Entire Recording" & grepl(",", Media), "Entire Recording", Media))

print(metrics_demographics)
View(metrics_demographics)

```

```{R}
unique_media <- unique(metrics_demographics$Media)
print(unique_media)
```
PERFECTTTT 

now double check no more empty values in the df before splitting !
```{R}
# check for missing values
missing_values <- colSums(is.na(metrics_demographics))
print(missing_values) # no missing values !!!

```
the participants arent in order even tho i tried to order a few chunks up so lets view and arrange
```{r}
unique(metrics_demographics$Participant)

```
```{r}
#for some reason participants werent in order so order 
metrics_demographics <- metrics_demographics %>%
  mutate(participant_id_num = as.numeric(sub("Participant ", "", Participant))) %>%
  arrange(participant_id_num) %>%
  select(-participant_id_num)
unique(metrics_demographics$Participant)

View(metrics_demographics)
```
#ND and NT dfs

NOW SPLIT THE LARGE DF INTO ND AND NT 
so now lets have this big one dataframe with all data : `metric_demographics` and make two filtered df one for NT and one for ND participants

--ND one should only have the info for participants 1, 4, 6, 7, 10, 12, 13, 18, 20, 21, 23 and 24

```{r}
# neurodiverse participants
neurodiverse_data <- metrics_demographics %>%
  filter(`Neurodiverse` == "Yes")

print(unique(neurodiverse_data$Participant))
View(neurodiverse_data)

```

so just checked it has all the 12 ND participants

participant 2, 3, 5, 8, 9, 11, 14, 15, 16, 17, 19, 22 for NT 

```{r}
#neurotypical participants
neurotypical_data <- metrics_demographics %>%
  filter(`Neurodiverse` == "No")

print(unique(neurotypical_data$Participant))
View(neurotypical_data)
```

##demographic values (m,sd etc)
okay first lets check M and SD for each group

```{r}
# remove duplicate participants to make it easier to calculate M and SD
neurodiverse_unique <- neurodiverse_data %>% distinct(Participant, .keep_all = TRUE)
neurotypical_unique <- neurotypical_data %>% distinct(Participant, .keep_all = TRUE)
print(neurodiverse_unique$Combined_Diagnosis)
print(neurotypical_unique)
```
NT participant 2, 3, 5, 8, 9, 11, 14, 15, 16, 17, 19, 22
ND participant 1, 4, 6, 7, 10, 12, 13, 18, 20, 21, 23, 24

```{r}
# mean and SD age for neurodiverse group
neurodiverse_age_stats <- neurodiverse_unique %>%
  summarise(
    mean_age = mean(Age, na.rm = TRUE),
    sd_age = sd(Age, na.rm = TRUE)
  )

# frequency of gender for neurodiverse group
neurodiverse_gender_stats <- neurodiverse_unique %>%
  count(Gender) %>%
  mutate(freq = n / sum(n))

print(neurodiverse_age_stats)
print(neurodiverse_gender_stats)

```

```{r}

# mean and SD age for neurotypical group
neurotypical_age_stats <- neurotypical_unique %>%
  summarise(
    mean_age = mean(Age, na.rm = TRUE),
    sd_age = sd(Age, na.rm = TRUE)
  )

# frequency of gender for neurotypical group
neurotypical_gender_stats <- neurotypical_unique %>%
  count(Gender) %>%
  mutate(freq = n / sum(n))

print(neurotypical_age_stats)
print(neurotypical_gender_stats)
```
should probably also do for all participants too --> just realised i can use the demographics df 
```{r}
#remove duplicates to calculate M and SD
demographics_unique <- Demographics %>% distinct(Participant, .keep_all = TRUE)
print(demographics_unique)

# mean and SD age for all group 
all_data_age_stats <- demographics_unique %>%
  summarise(
    mean_age = mean(Age, na.rm = TRUE),
    sd_age = sd(Age, na.rm = TRUE)
  )

print(all_data_age_stats)

# frequency of gender for all groups
all_data_gender_stats <- demographics_unique %>%
  count(Gender) %>%
  mutate(freq = n / sum(n))

print(all_data_gender_stats)
```

Okay can now insert those number into my methodology participants section

```{r}
# separate multiple diagnoses into distinct rows
metrics_long <- metrics_demographics %>%
  separate_rows(Diagnosis, sep = ";")

# remove duplicate participants to ensure each participant is counted only once per diagnosis (as each participant has multiple observations)
unique_participants <- metrics_long %>% distinct(Participant, Diagnosis, .keep_all = TRUE)

# group by Diagnosis and count the number of participants
diagnosis_counts <- unique_participants %>%
  group_by(Diagnosis) %>%
  summarise(count = n())

print(diagnosis_counts)
```
#Visualisations 

now think abt analysis / graphs ; first need to have a play around with different graphs and metrics --> VISUALISATIONS AND THEN CREATE FEATURES BASED ON THIS --> FEATURES FROM LIST AND GRAPHS/ HEATMAPS ETC AND FOR ANOVA 
glances, visits, AOIs, fixations etc

okay so did codeacademcy and R data visualisations with ggplot2
list consists of: (these are also the features --> alot already built just need to figure out how to create features and visualise)

Fixation: fixation density; fixation number; fixation frequency; fixation duration (and total and avg); fixation count (avg); fixation density maps (TOBII), proportion of time looking at AOI and proportional fixation time based on AOIs; proportion of total fixation duration; fixations before; non-fixation locations
AOI based: fixation time to specific AOIs; gaze shifts between AOIs; first fixation to AOI; AOI fixation count comparison per group; dwell time per AOI
Gaze data: minimum time cutoff, proportion of screen gazetime as opposed to absolute values; fixation filter on raw data; (avg l and r eyes to calculate fixation);
Saccades: distribution of saccade velocities; saccade amplitude; saccade duration;   


okay so maybe lets try AOI based fixations per NT participant, AOI fixation count comparison per group  

so lets begin with saccades

###SACCADE VISUALISATION 
saccades (*main focus) : no of saccades; avg amplitude of saccades; total amplitude of saccades; max amplitude of saccades; maximum peak velocity of saccades

No of saccades across Conditions and Neurodiversity (Overview plot)
```{r}
order_of_conditions <- c("Realistic image", "Portrait Painting", "Semi-abstract","Abstract", "Very Abstract")

order_of_media = c("Realistic image 1", "Realistic image 2", "Realistic image 3", "Realistic image 4", "Realistic image 5",
                 "Portrait Painting 1", "Portrait Painting 2", "Portrait Painting 3", "Portrait Painting 4", "Portrait Painting 5",
                 "Semi-abstract 1", "Semi-abstract 2", "Semi-abstract 3", "Semi-abstract 4", "Semi-abstract 5",
                 "Abstract 1", "Abstract 3", "Abstract 4", "Abstract 5", "Abstract 6",
                 "Very Abstract 1", "Very Abstract 2", "Very Abstract 3", "Very Abstract 4", "Very Abstract 5")


```

###Number of saccades visualisations
```{R}

no_saccades <- metrics_demographics %>%
  filter(Metric== "Number_of_saccades" & Media!= "Entire Recording") %>%
  mutate(Condition = factor(Condition, levels = order_of_conditions))

viz_no_saccades_jitter <- ggplot(data = no_saccades, aes(x = Condition, y = Value, fill=Neurodiverse)) +
  geom_jitter(aes(color = Neurodiverse), size=3, alpha=0.5, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun = median, geom = "crossbar", linewidth = 0.3, position = position_dodge(width = 0.7), width=0.7, show.legend = FALSE)+
  scale_fill_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Number of Saccades per Condition",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Condition",
       y = "Number of Saccades") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) #+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_no_saccades_jitter

#ggsave("Number_saccade_condition_plot.png", viz_no_saccades_jitter, width = 15, height = 10, dpi = 300)
```
lets also do a boxplot version of this :
```{r}
viz_no_saccades_jitter_boxplot <- ggplot(data = no_saccades, aes(x = Condition, y = Value, color=Neurodiverse)) +
  geom_boxplot(fill= "grey", outlier.color="darkgrey", show.legend = FALSE)+ #, outlier.shape = NA) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.7)) +
  scale_color_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Number of Saccades per Condition",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Condition",
       y = "Number of Saccades") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) #+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_no_saccades_jitter_boxplot
#ggsave("no_saccade_boxplot_condition.png", viz_no_saccades_jitter_boxplot, width = 12, height = 8, dpi = 300)

```
Number of saccades per media :
```{r}
no_saccades_media <- metrics_demographics %>%
  filter(Metric== "Number_of_saccades" & Media!= "Entire Recording") %>%
  mutate(Media = factor(Media, levels = order_of_media))

viz_no_saccades_media_jitter <- ggplot(data = no_saccades_media, aes(x = Media, y = Value, fill=Neurodiverse)) +
  geom_jitter(aes(color = Neurodiverse), size=2, alpha=0.5, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun = median, geom = "crossbar", linewidth = 0.3, position = position_dodge(width = 0.7), width=0.7, show.legend = FALSE)+
  scale_fill_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Number of Saccades per Media",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Media",
       y = "Number of Saccades") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) #+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_no_saccades_media_jitter

#ggsave("no_saccade_all_media_plot.png", viz_no_saccades_media_jitter, width = 15, height = 10, dpi = 300)
```
individual conditions number of saccades
```{r}
number_saccade_realistic <- metrics_demographics %>%
  filter(Metric == "Number_of_saccades" & Condition == "Realistic image")
print(number_saccade_realistic)

viz_no_saccade_realistic <- ggplot(data=number_saccade_realistic, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.6),
               width=0.5, linewidth=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Number of Saccades for Realistic image Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Number of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0,40))

viz_no_saccade_realistic
#ggsave("no_saccade_realistic_plot.png", viz_no_saccade_realistic, width = 10, height = 8, dpi = 300)

```
PUT IN PPT WITH IMAGES --> WHY ARE THEY DIFFERENT ACROSS THE CONDITION? ALSO MAKE SURE TO KEEP SCALES CONSISTENT ACROSS GGRAPHS

```{r}
number_saccade_portrait <- metrics_demographics %>%
  filter(Metric == "Number_of_saccades" & Condition == "Portrait Painting")
print(number_saccade_portrait)

viz_no_saccade_portrait <- ggplot(data=number_saccade_portrait, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.6),
               width=0.5, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Number of Saccades for Portrait Painting Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Number of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0,40))

viz_no_saccade_portrait
#ggsave("no_saccade_portrait_plot.png", viz_no_saccade_portrait, width = 10, height = 8, dpi = 300)

```
```{r}
number_saccade_semi <- metrics_demographics %>%
  filter(Metric == "Number_of_saccades" & Condition == "Semi-abstract")
print(number_saccade_semi)

viz_no_saccade_semi <- ggplot(data=number_saccade_semi, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.6, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.6),
               width=0.5, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Number of Saccades for Semi-abstract Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Number of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0,40))

viz_no_saccade_semi

#ggsave("no_saccade_semiabstract_plot.png", viz_no_saccade_semi, width = 10, height = 8, dpi = 300)

```
```{r}
number_saccade_abstract <- metrics_demographics %>%
  filter(Metric == "Number_of_saccades" & Condition == "Abstract")
print(number_saccade_abstract)

viz_no_saccade_abstract <- ggplot(data=number_saccade_abstract, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.6),
               width=0.5, size=0.3,
               show.legend = FALSE) +
  stat_summary(fun=mean, geom="point",
               position=position_dodge(width=0.3),
               size=1.5, show.legend = FALSE) + #MEAN 
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Number of Saccades for Abstract Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Number of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0,40))


viz_no_saccade_abstract
#ggsave("no_saccade_abstract_plot.png", viz_no_saccade_abstract, width = 10, height = 8, dpi = 300)

```
```{r}
number_saccade_veryabstract <- metrics_demographics %>%
  filter(Metric == "Number_of_saccades" & Condition == "Very Abstract")
print(number_saccade_veryabstract)

viz_no_saccade_veryabstract <- ggplot(data=number_saccade_veryabstract, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.7, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.6),
               width=0.5, size=0.3,
               show.legend = FALSE) +
  stat_summary(fun=mean, geom="point",
               position=position_dodge(width=0.6),
               size=1.5, show.legend = FALSE) + #MEAN 
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Number of Saccades for Very Abstract Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Number of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0,40))


viz_no_saccade_veryabstract
#ggsave("no_saccade_veryabstract_plot.png", viz_no_saccade_veryabstract, width = 10, height = 8, dpi = 300)
```
###Average amplitude of saccades vosualisations

```{r}
avg_amp_saccade <- metrics_demographics %>%
  filter(Metric == "Average_amplitude_of_saccades" & Condition != "Entire Recording") %>%
  mutate(Condition = factor(Condition, levels= order_of_conditions))
print(avg_amp_saccade)


viz_avg_amp_saccades_jitter <- ggplot(data = avg_amp_saccade, aes(x = Condition, y = Value, fill=Neurodiverse)) +
  geom_jitter(aes(color = Neurodiverse), size=3, alpha=0.5, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.6),
              pch=21, stroke=0) +
  stat_summary(fun = median, geom = "crossbar", size = 0.3, position = position_dodge(width = 0.7), width=0.5, show.legend = FALSE)+
  scale_fill_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Average Amplitude of Saccades per Condition",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Condition",
       y = "Average Amplitude of Saccades") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))+
  scale_y_continuous(limits = c(1,10))#+
  #coord_flip() #FLIPS X AND Y AXIS 


viz_avg_amp_saccades_jitter
#ggsave("avg_amp_saccade_condition_plot.png", viz_avg_amp_saccades_jitter, width = 10, height = 8, dpi = 300)

```
```{r}
viz_avg_amp_saccade_jitter_boxplot <- ggplot(data = avg_amp_saccade, aes(x = Condition, y = Value, color=Neurodiverse)) +
  geom_boxplot(fill= "grey", outlier.colour = "darkgrey", show.legend = FALSE)+ #, outlier.shape = NA) +
  geom_jitter(aes(color = Neurodiverse), size=3, alpha=0.3, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.7)) +
  scale_color_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Average Amplitude of Saccades per Condition",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Condition",
       y = "Average Amplitude of Saccades") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(1, 10))#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_avg_amp_saccade_jitter_boxplot
#ggsave("avg_amp_saccade_condition_boxplot.png", viz_avg_amp_saccade_jitter_boxplot, width = 10, height = 8, dpi = 300)


```

then all media: 
```{r}
avg_amplitude_saccade_media <- metrics_demographics %>%
  filter(Metric== "Average_amplitude_of_saccades" & Media!= "Entire Recording") %>%
  mutate(Media = factor(Media, levels = order_of_media))

viz_avg_amp_saccades_media_jitter <- ggplot(data = avg_amplitude_saccade_media, aes(x = Media, y = Value, fill=Neurodiverse)) +
  geom_jitter(aes(color = Neurodiverse), size=2, alpha=0.5, position = position_jitterdodge(jitter.width = 0.1, dodge.width = 0.75),
              pch=21, stroke=0) +
  stat_summary(fun = median, geom = "crossbar", size = 0.3, position = position_dodge(width = 0.7), width=0.5, show.legend = FALSE)+
  scale_fill_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Average Amplitude of Saccades per Media",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Media",
       y = "Average Amplitude of Saccades") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(1,10))#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_avg_amp_saccades_media_jitter

#ggsave("avg_amp_saccade_all_media_plot.png", viz_avg_amp_saccades_media_jitter, width = 12, height = 8, dpi = 300)

```
then media in eahc condition : RI
```{r}
avg_amp_saccade_ri <- metrics_demographics %>%
  filter(Metric == "Average_amplitude_of_saccades" & Condition == "Realistic image")
print(avg_amp_saccade_ri)

viz_avg_amp_saccade_realistic <- ggplot(data=avg_amp_saccade_ri, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.6),
               width=0.5, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Average Amplitude of Saccades for Realistic image Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Average amplitude of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(1,10)) #+
  #coord_flip()

viz_avg_amp_saccade_realistic
#ggsave("avg_amp_saccade_realistic_plot.png", viz_avg_amp_saccade_realistic, width = 10, height = 8, dpi = 300)


```
```{r}
avg_amp_saccade_pp <- metrics_demographics %>%
  filter(Metric == "Average_amplitude_of_saccades" & Condition == "Portrait Painting")
print(avg_amp_saccade_ri)

viz_avg_amp_saccade_pp <- ggplot(data=avg_amp_saccade_pp, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.6),
               width=0.5, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Average Amplitude of Saccades for Portrait Painting Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Average amplitude of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(1,10)) #+
  #coord_flip()

viz_avg_amp_saccade_pp
#ggsave("avg_amp_saccade_portrait_plot.png", viz_avg_amp_saccade_pp, width = 10, height = 8, dpi = 300)


```

```{r}
avg_amp_saccade_sa <- metrics_demographics %>%
  filter(Metric == "Average_amplitude_of_saccades" & Condition == "Semi-abstract")
print(avg_amp_saccade_sa)

viz_avg_amp_saccade_sa <- ggplot(data=avg_amp_saccade_sa, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.6),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Average Amplitude of Saccades for Semi-abstract Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Average amplitude of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(1,10)) #+
  #coord_flip()

viz_avg_amp_saccade_sa
#ggsave("avg_amp_saccade_sa_plot.png", viz_avg_amp_saccade_sa, width = 10, height = 8, dpi = 300)


```

```{r}
avg_amp_saccade_ab <- metrics_demographics %>%
  filter(Metric == "Average_amplitude_of_saccades" & Condition == "Abstract")
print(avg_amp_saccade_ab)

viz_avg_amp_saccade_abstract <- ggplot(data=avg_amp_saccade_ab, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.6),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.6),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Average Amplitude of Saccades for Abstract Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Average amplitude of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(1,10)) #+
  #coord_flip()

viz_avg_amp_saccade_abstract
#ggsave("avg_amp_saccade_abstract_plot.png", viz_avg_amp_saccade_abstract, width = 10, height = 8, dpi = 300)

```
```{r}
avg_amp_saccade_va <- metrics_demographics %>%
  filter(Metric == "Average_amplitude_of_saccades" & Condition == "Very Abstract")
print(avg_amp_saccade_va)

viz_avg_amp_saccade_va <- ggplot(data=avg_amp_saccade_va, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.6),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Average Amplitude of Saccades for Very Abstract Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Average amplitude of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(1,10)) #+
  #coord_flip()

viz_avg_amp_saccade_va
#ggsave("avg_amp_saccade_veryabstract_plot.png", viz_avg_amp_saccade_va, width = 10, height = 8, dpi = 300)

```
```{r}
viz_avg_amp_saccade_jitter_boxplot_va <- ggplot(data = avg_amp_saccade_va, aes(x = Media, y = Value, color=Neurodiverse)) +
  geom_boxplot(fill= "grey", outlier.color="darkgrey", show.legend = FALSE)+ #, outlier.shape = NA) +
  geom_jitter(aes(color = Neurodiverse), size=3, alpha=0.3, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.7)) +
  scale_color_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Average Amplitude of Saccades for Very Abstract Condition",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Media",
       y = "Average Amplitude of Saccades") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(1, 10))#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_avg_amp_saccade_jitter_boxplot_va
#ggsave("avg_amp_saccade_va_boxplot_plot.png", viz_avg_amp_saccade_jitter_boxplot_va, width = 10, height = 8, dpi = 300)

```
### total amplitude of saccades visualisations

condition
```{r}
total_amp_saccade <- metrics_demographics %>%
  filter(Metric == "Total_amplitude_of_saccades" & Condition != "Entire Recording") %>%
  mutate(Condition = factor(Condition, levels= order_of_conditions))
print(total_amp_saccade)


viz_total_amp_saccades_jitter <- ggplot(data = total_amp_saccade, aes(x = Condition, y = Value, fill=Neurodiverse)) +
  geom_jitter(aes(color = Neurodiverse), size=3, alpha=0.5, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun = median, geom = "crossbar", size = 0.3, position = position_dodge(width = 0.7), width=0.5, show.legend = FALSE)+
  scale_fill_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Total Amplitude of Saccades per Condition",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Condition",
       y = "Total Amplitude of Saccades") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0,250))#+
  #coord_flip() #FLIPS X AND Y AXIS 


viz_total_amp_saccades_jitter
#ggsave("total_amp_saccade_condition_plot.png", viz_total_amp_saccades_jitter, width = 10, height = 8, dpi = 300)


```
boxplot of conditions: 
```{r}
viz_total_amp_saccade_jitter_boxplot <- ggplot(data = total_amp_saccade, aes(x = Condition, y = Value, color=Neurodiverse)) +
  geom_boxplot(fill= "grey", outlier.color="darkgrey", show.legend = FALSE)+ #, outlier.shape = NA) +
  geom_jitter(aes(color = Neurodiverse), size=3, alpha=0.3, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.7)) +
  scale_color_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Boxplots of Total Amplitude of Saccades across Conditions",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Condition",
       y = "Total Amplitude of Saccades") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0, 250))#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_total_amp_saccade_jitter_boxplot
#ggsave("total_amp_saccade_condition_boxplot.png", viz_total_amp_saccade_jitter_boxplot, width = 10, height = 8, dpi = 300)


```
```{R}
total_amplitude_saccade_media <- metrics_demographics %>%
  filter(Metric== "Total_amplitude_of_saccades" & Media!= "Entire Recording") %>%
  mutate(Media = factor(Media, levels = order_of_media))

viz_total_amp_saccades_media_jitter <- ggplot(data = total_amplitude_saccade_media, aes(x = Media, y = Value, fill=Neurodiverse)) +
  geom_jitter(aes(color = Neurodiverse), size=2, alpha=0.5, position = position_jitterdodge(jitter.width = 0.1, dodge.width = 0.75),
              pch=21, stroke=0) +
  stat_summary(fun = median, geom = "crossbar", size = 0.3, position = position_dodge(width = 0.7), width=0.5, show.legend = FALSE)+
  scale_fill_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Total Amplitude of Saccades per Media",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Media",
       y = "Total Amplitude of Saccades") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0,250))#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_total_amp_saccades_media_jitter
#ggsave("total_amp_saccade_all_media_plot.png", viz_total_amp_saccades_media_jitter, width = 12, height = 8, dpi = 300)


```

across different conditions:
```{r}
total_amp_saccade_ri <- metrics_demographics %>%
  filter(Metric == "Total_amplitude_of_saccades" & Condition == "Realistic image")
print(total_amp_saccade_ri)

viz_total_amp_saccade_ri <- ggplot(data=total_amp_saccade_ri, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.1,
                                                                              dodge.width = 0.5),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.6),
               width=0.5, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Total Amplitude of Saccades for Realistic image Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Total amplitude of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0,250)) #+
  #coord_flip()

viz_total_amp_saccade_ri
#ggsave("total_amp_saccade_realistic_plot.png", viz_total_amp_saccade_ri, width = 10, height = 8, dpi = 300)


```
```{r}
total_amp_saccade_pp <- metrics_demographics %>%
  filter(Metric == "Total_amplitude_of_saccades" & Condition == "Portrait Painting")
print(total_amp_saccade_pp)

viz_total_amp_saccade_pp <- ggplot(data=total_amp_saccade_pp, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.6),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.6),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Total Amplitude of Saccades for Portrait Painting Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Total amplitude of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0,250)) #+
  #coord_flip()

viz_total_amp_saccade_pp
#ggsave("total_amp_saccade_portrait_plot.png", viz_total_amp_saccade_pp, width = 10, height = 8, dpi = 300)

```
```{r}
total_amp_saccade_sa <- metrics_demographics %>%
  filter(Metric == "Total_amplitude_of_saccades" & Condition == "Semi-abstract")
print(total_amp_saccade_sa)

viz_total_amp_saccade_sa <- ggplot(data=total_amp_saccade_sa, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.6),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Total Amplitude of Saccades for Semi-abstract Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Total amplitude of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0,250)) #+
  #coord_flip()

viz_total_amp_saccade_sa
#ggsave("total_amp_saccade_semiabstract_plot.png", viz_total_amp_saccade_sa, width = 10, height = 8, dpi = 300)


```
```{r}
total_amp_saccade_ab <- metrics_demographics %>%
  filter(Metric == "Total_amplitude_of_saccades" & Condition == "Abstract")
print(total_amp_saccade_ab)

viz_total_amp_saccade_ab <- ggplot(data=total_amp_saccade_ab, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.6),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.6),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Total Amplitude of Saccades for Abstract Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Total amplitude of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0,250)) #+
  #coord_flip()

viz_total_amp_saccade_ab
#ggsave("total_amp_saccade_abstract_plot.png", viz_total_amp_saccade_ab, width = 10, height = 8, dpi = 300)

```

```{r}
total_amp_saccade_va <- metrics_demographics %>%
  filter(Metric == "Total_amplitude_of_saccades" & Condition == "Very Abstract")
print(total_amp_saccade_va)

viz_total_amp_saccade_va <- ggplot(data=total_amp_saccade_va, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.6),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.6),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Total Amplitude of Saccades for Very Abstract Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Total amplitude of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0,250)) #+
  #coord_flip()

viz_total_amp_saccade_va
#ggsave("total_amp_saccade_veryabstract_plot.png", viz_total_amp_saccade_va, width = 10, height = 8, dpi = 300)


```
```{r}
viz_total_amp_saccade_jitter_boxplot_va <- ggplot(data = total_amp_saccade_va, aes(x = Media, y = Value, color=Neurodiverse)) +
  geom_boxplot(fill= "grey", outlier.color="darkgrey", show.legend = FALSE)+ #, outlier.shape = NA) +
  geom_jitter(aes(color = Neurodiverse), size=3, alpha=0.3, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.7)) +
  scale_color_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Boxplots of Total Amplitude of Saccades for Very Abstract Condition",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Media",
       y = "Total Amplitude of Saccades") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0, 250))#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_total_amp_saccade_jitter_boxplot_va
#ggsave("total_amp_saccade_veryabstract_boxplot.png", viz_total_amp_saccade_jitter_boxplot_va, width = 10, height = 8, dpi = 300)


```
### max amp of saccades visualisation

conditions:
```{r}
max_amp_saccade <- metrics_demographics %>%
  filter(Metric == "Maximum_amplitude_of_saccades" & Condition != "Entire Recording") %>%
  mutate(Condition = factor(Condition, levels= order_of_conditions))
print(max_amp_saccade)


viz_max_amp_saccades_jitter <- ggplot(data = max_amp_saccade, aes(x = Condition, y = Value, fill=Neurodiverse)) +
  geom_jitter(aes(color = Neurodiverse), size=3, alpha=0.5, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.8),
              pch=21, stroke=0) +
  stat_summary(fun = median, geom = "crossbar", size = 0.3, position = position_dodge(width = 0.8), width=0.5, show.legend = FALSE)+
  scale_fill_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Maximum Amplitude of Saccades per Condition",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Condition",
       y = "Maximum Amplitude of Saccades") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0,50))#+
  #coord_flip() #FLIPS X AND Y AXIS 


viz_max_amp_saccades_jitter
#ggsave("max_amp_saccade_condition_plot.png", viz_max_amp_saccades_jitter, width = 10, height = 8, dpi = 300)



```

boxplot conditions:
```{r}
viz_max_amp_saccade_jitter_boxplot <- ggplot(data = max_amp_saccade, aes(x = Condition, y = Value, color=Neurodiverse)) +
  geom_boxplot(fill= "grey", outliers = FALSE, show.legend = FALSE)+ #, outlier.shape = NA) +
  geom_jitter(aes(color = Neurodiverse), size=3, alpha=0.3, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.8)) +
  scale_color_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Boxplots of Maximum Amplitude of Saccades across Conditions",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Condition",
       y = "Total Amplitude of Saccades") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0, 50))#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_max_amp_saccade_jitter_boxplot
#ggsave("max_amp_saccade_condition_boxplot.png", viz_max_amp_saccade_jitter_boxplot, width = 10, height = 8, dpi = 300)

```
across all media:
```{r}
max_amplitude_saccade_media <- metrics_demographics %>%
  filter(Metric== "Maximum_amplitude_of_saccades" & Media!= "Entire Recording") %>%
  mutate(Media = factor(Media, levels = order_of_media))

viz_max_amp_saccades_media_jitter <- ggplot(data = max_amplitude_saccade_media, aes(x = Media, y = Value, fill=Neurodiverse)) +
  geom_jitter(aes(color = Neurodiverse), size=2, alpha=0.5, position = position_jitterdodge(jitter.width = 0.1, dodge.width = 0.75),
              pch=21, stroke=0) +
  stat_summary(fun = median, geom = "crossbar", size = 0.3, position = position_dodge(width = 0.7), width=0.5, show.legend = FALSE)+
  scale_fill_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Maximum Amplitude of Saccades per Media",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Media",
       y = "Maximum Amplitude of Saccades") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0,50))#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_max_amp_saccades_media_jitter
#ggsave("max_amp_saccade_all_media_plot.png", viz_max_amp_saccades_media_jitter, width = 12, height = 8, dpi = 300)


```

across conditions:
```{r}
max_amp_saccade_ri <- metrics_demographics %>%
  filter(Metric == "Maximum_amplitude_of_saccades" & Condition == "Realistic image")
print(max_amp_saccade_ri)

viz_max_amp_saccade_ri <- ggplot(data=max_amp_saccade_ri, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.6),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Maximum Amplitude of Saccades for Realistic image Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Maximum amplitude of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0,50)) #+
  #coord_flip()

viz_max_amp_saccade_ri
#ggsave("max_amp_saccade_realistic_plot.png", viz_max_amp_saccade_ri, width = 10, height = 8, dpi = 300)

```
```{r}
max_amp_saccade_pp <- metrics_demographics %>%
  filter(Metric == "Maximum_amplitude_of_saccades" & Condition == "Portrait Painting")
print(max_amp_saccade_pp)

viz_max_amp_saccade_pp <- ggplot(data=max_amp_saccade_pp, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.6),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.6),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Maximum Amplitude of Saccades for Portrait Painting Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Maximum amplitude of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0,50)) #+
  #coord_flip()

viz_max_amp_saccade_pp
#ggsave("max_amp_saccade_portrait_plot.png", viz_max_amp_saccade_pp, width = 10, height = 8, dpi = 300)


```
```{r}
max_amp_saccade_sa <- metrics_demographics %>%
  filter(Metric == "Maximum_amplitude_of_saccades" & Condition == "Semi-abstract")
print(max_amp_saccade_sa)

viz_max_amp_saccade_sa <- ggplot(data=max_amp_saccade_sa, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.6),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Maximum Amplitude of Saccades for Semi-abstract Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Maximum amplitude of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0,50)) #+
  #coord_flip()

viz_max_amp_saccade_sa
#ggsave("max_amp_saccade_semiabstract_plot.png", viz_max_amp_saccade_sa, width = 10, height = 8, dpi = 300)

```
boxplot
```{r}
viz_max_amp_saccade_jitter_boxplot_sa <- ggplot(data = max_amp_saccade_sa, aes(x =Media, y = Value, color=Neurodiverse)) +
  geom_boxplot(fill= "grey", outliers = FALSE, show.legend = FALSE)+ #, outlier.shape = NA) +
  geom_jitter(aes(color = Neurodiverse), size=3, alpha=0.3, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.8)) +
  scale_color_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Boxplots of Maximum Amplitude of Saccades across Semi abstract Condition",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Condition",
       y = "Maximum Amplitude of Saccades") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0, 50))#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_max_amp_saccade_jitter_boxplot_sa
#ggsave("max_amp_saccade_semiabstract_boxplot.png", viz_max_amp_saccade_jitter_boxplot_sa, width = 10, height = 8, dpi = 300)

```

```{r}
max_amp_saccade_ab <- metrics_demographics %>%
  filter(Metric == "Maximum_amplitude_of_saccades" & Condition == "Abstract")
print(max_amp_saccade_ab)

viz_max_amp_saccade_ab <- ggplot(data=max_amp_saccade_ab, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.6),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.6),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Maximum Amplitude of Saccades for Abstract Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Maximum amplitude of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0,50)) #+
  #coord_flip()

viz_max_amp_saccade_ab
#ggsave("max_amp_saccade_abstract_plot.png", viz_max_amp_saccade_ab, width = 10, height = 8, dpi = 300)

```

```{r}
max_amp_saccade_va <- metrics_demographics %>%
  filter(Metric == "Maximum_amplitude_of_saccades" & Condition == "Very Abstract")
print(max_amp_saccade_va)

viz_max_amp_saccade_va <- ggplot(data=max_amp_saccade_va, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.6),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Maximum Amplitude of Saccades for Very Abstract Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Maximum amplitude of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0,50)) #+
  #coord_flip()

viz_max_amp_saccade_va
#ggsave("max_amp_saccade_veryabstract_plot.png", viz_max_amp_saccade_va, width = 10, height = 8, dpi = 300)


```
### max peak velocity of saccades visualisations

```{r}
max_peak_velocity_saccades <- metrics_demographics %>%
  filter(Metric == "Maximum_peak_velocity_of_saccades" & Condition != "Entire Recording") %>%
  mutate(Condition = factor(Condition, levels= order_of_conditions))
print(max_peak_velocity_saccades)


viz_max_peak_velocity_saccades_jitter <- ggplot(data = max_peak_velocity_saccades, aes(x = Condition, y = Value, fill=Neurodiverse)) +
  geom_jitter(aes(color = Neurodiverse), size=3, alpha=0.5, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.8),
              pch=21, stroke=0) +
  stat_summary(fun = median, geom = "crossbar", size = 0.3, position = position_dodge(width = 0.8), width=0.5, show.legend = FALSE)+
  scale_fill_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Maximum Peak Velocity of Saccades per Condition",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Condition",
       y = "Maximum Peak Velocity of Saccades") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(100,900))#+
  #coord_flip() #FLIPS X AND Y AXIS 


viz_max_peak_velocity_saccades_jitter
#ggsave("max_peak_velocity_saccade_condition_plot.png", viz_max_peak_velocity_saccades_jitter, width = 10, height = 8, dpi = 300)


```
very clear extreme outlier for semi abstract

```{R}
viz_max_peak_velocity_saccade_jitter_boxplot <- ggplot(data = max_peak_velocity_saccades, aes(x =Condition, y = Value, color=Neurodiverse)) +
  geom_boxplot(fill= "grey", outlier.color= "darkgrey", show.legend = FALSE, outlier.shape = NA) +
  geom_jitter(aes(color = Neurodiverse), size=3, alpha=0.3, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.8)) +
  scale_color_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Boxplots of Maximum Peak Velocity of Saccades across Conditions",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Condition",
       y = "Maximum Peak Velocity of Saccades") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(100, 900))#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_max_peak_velocity_saccade_jitter_boxplot
#ggsave("max_peak_velocity_saccade_condition_boxplot.png", viz_max_peak_velocity_saccade_jitter_boxplot, width = 10, height = 8, dpi = 300)

```
across conditions 
```{R}
max_peak_velocity_saccade_ri <- metrics_demographics %>%
  filter(Metric == "Maximum_peak_velocity_of_saccades" & Condition == "Realistic image")
print(max_peak_velocity_saccade_ri)

viz_max_peak_velocity_saccade_ri <- ggplot(data=max_peak_velocity_saccade_ri, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.8),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.5, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Maximum Peak Velocity of Saccades for Realistic Image Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Maximum Peak Velocity of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(100,900)) #+
  #coord_flip()

viz_max_peak_velocity_saccade_ri
#ggsave("max_peak_velocity_saccade_realistic_plot.png", viz_max_peak_velocity_saccade_ri, width = 10, height = 8, dpi = 300)



```
```{R}
max_peak_velocity_saccade_pp <- metrics_demographics %>%
  filter(Metric == "Maximum_peak_velocity_of_saccades" & Condition == "Portrait Painting")
print(max_peak_velocity_saccade_pp)

viz_max_peak_velocity_saccade_pp <- ggplot(data=max_peak_velocity_saccade_pp, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.8),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.8),
               width=0.5, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Maximum Peak Velocity of Saccades for Portrait Painting Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Maximum Peak Velocity of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(100,900)) #+
  #coord_flip()

viz_max_peak_velocity_saccade_pp
#ggsave("max_peak_velocity_saccade_portrait_plot.png", viz_max_peak_velocity_saccade_pp, width = 10, height = 8, dpi = 300)


```

```{r}
max_peak_velocity_saccade_sa <- metrics_demographics %>%
  filter(Metric == "Maximum_peak_velocity_of_saccades" & Condition == "Semi-abstract")
print(max_peak_velocity_saccade_sa)

viz_max_peak_velocity_saccade_sa <- ggplot(data=max_peak_velocity_saccade_sa, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.8),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.8),
               width=0.5, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Maximum Peak Velocity of Saccades for Semi-abstract Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Maximum Peak Velocity of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(100,900)) #+
  #coord_flip()

viz_max_peak_velocity_saccade_sa
#ggsave("max_peak_velocity_saccade_semiabstract_plot.png", viz_max_peak_velocity_saccade_sa, width = 10, height = 8, dpi = 300)



```
boxplot:
```{r}
viz_max_peak_velocity_saccade_jitter_boxplot_sa <- ggplot(data = max_peak_velocity_saccade_sa, aes(x =Media, y = Value, color=Neurodiverse)) +
  geom_boxplot(fill= "grey", outlier.color ="darkgrey", show.legend = FALSE, outlier.shape = NA) +
  geom_jitter(aes(color = Neurodiverse), size=3, alpha=0.3, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.8)) +
  scale_color_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Boxplots of Maximum Peak Velocity of Saccades for Semi-abstract Condition",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Condition",
       y = "Maximum Peak Velocity of Saccades") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(100, 900))#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_max_peak_velocity_saccade_jitter_boxplot_sa
#ggsave("max_peak_velocity_saccade_semiabstract_boxplot.png", viz_max_peak_velocity_saccade_jitter_boxplot_sa, width = 10, height = 8, dpi = 300)


```
```{r}
max_peak_velocity_saccade_ab <- metrics_demographics %>%
  filter(Metric == "Maximum_peak_velocity_of_saccades" & Condition == "Abstract")
print(max_peak_velocity_saccade_ab)

viz_max_peak_velocity_saccade_ab <- ggplot(data=max_peak_velocity_saccade_ab, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.8),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.8),
               width=0.5, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Maximum Peak Velocity of Saccades for Abstract Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Maximum Peak Velocity of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(100,900)) #+
  #coord_flip()

viz_max_peak_velocity_saccade_ab
#ggsave("max_peak_velocity_saccade_abstract_plot.png", viz_max_peak_velocity_saccade_ab, width = 10, height = 8, dpi = 300)



```
```{r}
viz_max_peak_velocity_saccade_jitter_boxplot_ab <- ggplot(data = max_peak_velocity_saccade_ab, aes(x =Media, y = Value, color=Neurodiverse)) +
  geom_boxplot(fill= "grey", show.legend = FALSE, outlier.shape = NA) +
  geom_jitter(aes(color = Neurodiverse), size=3, alpha=0.3, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.8)) +
  scale_color_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Boxplots of Maximum Peak Velocity of Saccades for Abstract Condition",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Condition",
       y = "Maximum Peak Velocity of Saccades") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(100, 900))#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_max_peak_velocity_saccade_jitter_boxplot_ab
#ggsave("max_peak_velocity_saccade_abstract_boxplot.png", viz_max_peak_velocity_saccade_jitter_boxplot_ab, width = 10, height = 8, dpi = 300)


```

```{R}

max_peak_velocity_saccade_va <- metrics_demographics %>%
  filter(Metric == "Maximum_peak_velocity_of_saccades" & Condition == "Very Abstract")
print(max_peak_velocity_saccade_va)

viz_max_peak_velocity_saccade_va <- ggplot(data=max_peak_velocity_saccade_va, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.8),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.8),
               width=0.5, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Maximum Peak Velocity of Saccades for Very Abstract Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Maximum Peak Velocity of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(100,900)) #+
  #coord_flip()

viz_max_peak_velocity_saccade_va
#ggsave("max_peak_velocity_saccade_veryabstract_plot.png", viz_max_peak_velocity_saccade_va, width = 10, height = 8, dpi = 300)


```

##FIXATION METRICS 
fixation: number of fixations, avg duration of fixations; total duration of fixations; proportion of total fixation duration (condition) +HEATMAPS FROM TOBII, time to first fixation 


### Metric 1: number of fixations visualisations
```{r}
no_fixations_all <- metrics_demographics %>%
  filter(Metric %in% c("Number_of_fixations.Background",
                       "Number_of_fixations.Eyes",
                       "Number_of_fixations.Eye_1",
                       "Number_of_fixations.Eye_2",
                       "Number_of_fixations.Face",
                       "Number_of_fixations.Mouth",
                       "Number_of_fixations.Nose",
                       "Number_of_fixations.Nose_2") & Condition != "Entire Recording") %>%
  mutate(Condition = factor(Condition, levels= order_of_conditions))
print(no_fixations_all)

no_fixations <- no_fixations_all %>%
  distinct(Participant, Media, Condition, Neurodiverse, Metric, .keep_all = TRUE) %>%
  group_by(Participant, Media, Condition, Neurodiverse) %>%
  summarize(Value = sum(Value, na.rm = TRUE)) %>%
  ungroup()

print(no_fixations)
```
```{r}

viz_no_fixations_jitter <- ggplot(data = no_fixations, aes(x = Condition, y = Value, fill=Neurodiverse)) +
  geom_jitter(aes(color = Neurodiverse), size=3, alpha=0.5, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun = median, geom = "crossbar", size = 0.3, position = position_dodge(width = 0.7), width=0.5, show.legend = FALSE)+
  scale_fill_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Number of Fixations per Condition",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Condition",
       y = "Number of fixations") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0,70))#+
  #coord_flip() #FLIPS X AND Y AXIS 


viz_no_fixations_jitter
#ggsave("no_fixations_condition_plot.png", viz_no_fixations_jitter, width = 10, height = 8, dpi = 300)


```
BOXPLOT 
```{R}
viz_no_fixations_jitter_boxplot <- ggplot(data = no_fixations, aes(x =Condition, y = Value, color=Neurodiverse)) +
  geom_boxplot(fill= "grey", show.legend = FALSE, outlier.shape = NA) +
  geom_jitter(aes(color = Neurodiverse), size=3, alpha=0.3, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.8)) +
  scale_color_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Boxplots of Number of Fixations across Conditions",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Condition",
       y = "Number of Fixations") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0, 70))#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_no_fixations_jitter_boxplot
#ggsave("no_fixations_boxplot.png", viz_no_fixations_jitter_boxplot, width = 12, height = 8, dpi = 300)



```
all media 
```{r}

viz_no_fixations_media_jitter <- ggplot(data = no_fixations, aes(x = Media, y = Value, fill=Neurodiverse)) +
  geom_jitter(aes(color = Neurodiverse), size=2, alpha=0.5, position = position_jitterdodge(jitter.width = 0.1, dodge.width = 0.75),
              pch=21, stroke=0) +
  stat_summary(fun = median, geom = "crossbar", size = 0.3, position = position_dodge(width = 0.7), width=0.5, show.legend = FALSE)+
  scale_fill_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Number of Fixations per Media",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Media",
       y = "Number of Fixations") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0,70))#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_no_fixations_media_jitter
#ggsave("no_fixations_all_media_plot.png", viz_no_fixations_media_jitter, width = 12, height = 8, dpi = 300)



```

now across conditions
```{r}
no_fixations_pp <- no_fixations %>%
  filter(Condition == "Portrait Painting")
print(no_fixations_pp)

viz_no_fixations_pp <- ggplot(data=no_fixations_pp, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.6),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.6),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Number of Fixations for Portrait Painting Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Number of Fixations") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0,70)) #+
  #coord_flip()

viz_no_fixations_pp
#ggsave("no_fixations_portrait_plot.png", viz_no_fixations_pp, width = 10, height = 8, dpi = 300)


```
```{r}
no_fixations_ri <- no_fixations %>%
  filter(Condition == "Realistic image")
print(no_fixations_ri)

viz_no_fixations_ri <- ggplot(data=no_fixations_ri, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.5),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.5),
               width=0.3, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Number of Fixations for Realistic image Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Number of Fixations") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0,50)) #+
  #coord_flip()

viz_no_fixations_ri
#ggsave("no_fixations_realistic_plot.png", viz_no_fixations_ri, width = 10, height = 8, dpi = 300)


```
```{r}
no_fixations_sa <- no_fixations %>%
  filter(Condition == "Semi-abstract")
print(no_fixations_sa)

viz_no_fixations_sa <- ggplot(data=no_fixations_sa, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.6),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Number of Fixations for Semi-abstract Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Number of Fixations") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0,70)) #+
  #coord_flip()

viz_no_fixations_sa
#ggsave("no_fixations_semiabstract_plot.png", viz_no_fixations_sa, width = 10, height = 8, dpi = 300)


```
boxplot of semi abstrct
```{r}
viz_no_fixations_jitter_boxplot_sa <- ggplot(data = no_fixations_sa, aes(x =Media, y = Value, color=Neurodiverse)) +
  geom_boxplot(fill= "grey", show.legend = FALSE, outlier.shape = NA) +
  geom_jitter(aes(color = Neurodiverse), size=3, alpha=0.3, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.8)) +
  scale_color_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Boxplots of Number of Fixations across Semi-abstract Media",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Condition",
       y = "Number of Fixations") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0, 70))#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_no_fixations_jitter_boxplot_sa
#SAVE WHEN FIXED 
#ggsave("no_fixations_boxplot_Semiabstract.png", viz_no_fixations_jitter_boxplot_sa, width = 12, height = 8, dpi = 300)



```


```{r}
no_fixations_ab <- no_fixations %>%
  filter(Condition == "Abstract")
print(no_fixations_ab)

viz_no_fixations_ab <- ggplot(data=no_fixations_ab, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.6),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Number of Fixations for Abstract Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Number of Fixations") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0,70)) #+
  #coord_flip()

viz_no_fixations_ab
#ggsave("no_fixations_abstract_plot.png", viz_no_fixations_ab, width = 10, height = 8, dpi = 300)



```
```{r}
no_fixations_va <- no_fixations %>%
  filter(Condition == "Very Abstract")
print(no_fixations_va)

viz_no_fixations_va <- ggplot(data=no_fixations_va, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Number of Fixations for Very Abstract Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Number of Fixations") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0,70)) #+
  #coord_flip()

viz_no_fixations_va
#ggsave("no_fixations_veryabstract_plot.png", viz_no_fixations_va, width = 10, height = 8, dpi = 300)


```
```{r}
viz_no_fixations_jitter_boxplot_va <- ggplot(data = no_fixations_va, aes(x =Media, y = Value, color=Neurodiverse)) +
  geom_boxplot(fill= "grey", show.legend = FALSE, outlier.shape = NA) +
  geom_jitter(aes(color = Neurodiverse), size=3, alpha=0.3, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.8)) +
  scale_color_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Boxplots of Number of Fixations across Very Abstract Media",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Condition",
       y = "Number of Fixations") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0, 70))#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_no_fixations_jitter_boxplot_va
#SAVE WHEN FIXED 
#ggsave("no_fixations_boxplot_veryabstract.png", viz_no_fixations_jitter_boxplot_va, width = 12, height = 8, dpi = 300)



```

###Metric 2: avg duration of fixations visualisaitons

```{r}
avg_duration_fixations_all <- metrics_demographics %>%
  filter(Metric %in% c("Average_duration_of_fixations.Background",
                       "Average_duration_of_fixations.Eye_1",
                       "Average_duration_of_fixations.Eye_2",
                       "Average_duration_of_fixations.Eyes",
                       "Average_duration_of_fixations.Face",
                       "Average_duration_of_fixations.Mouth",
                       "Average_duration_of_fixations.Nose",
                       "Average_duration_of_fixations.Nose_2") & Condition != "Entire Recording") %>%
  distinct() %>%
  mutate(Condition = factor(Condition, levels= order_of_conditions))
print(avg_duration_fixations_all)

avg_duration_fixations <- avg_duration_fixations_all %>%
  distinct(Participant, Media, Condition, Neurodiverse, Metric, .keep_all = TRUE) %>%
  group_by(Participant, Media, Condition, Neurodiverse) %>%
  summarize(Value = mean(Value, na.rm = TRUE)) %>%
  ungroup()

print(avg_duration_fixations)
View(avg_duration_fixations)
```

```{r}
viz_avg_duration_fixations_jitter <- ggplot(data = avg_duration_fixations, aes(x = Condition, y = Value, fill=Neurodiverse)) +
  geom_jitter(aes(color = Neurodiverse), size=3, alpha=0.5, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.8),
              pch=21, stroke=0) +
  stat_summary(fun = median, geom = "crossbar", size = 0.3, position = position_dodge(width = 0.7), width=0.6, show.legend = FALSE)+
  scale_fill_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Average Duration of Fixations per Condition",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Condition",
       y = "Average Duration of fixations") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0,1500))#+
  #coord_flip() #FLIPS X AND Y AXIS 


viz_avg_duration_fixations_jitter
#ggsave("avg_duration_fixations_condition_plot.png", viz_avg_duration_fixations_jitter, width = 10, height = 8, dpi = 300)


```
```{R}
viz_avg_duration_fixations_jitter_boxplot <- ggplot(data = avg_duration_fixations, aes(x =Condition, y = Value, color=Neurodiverse)) +
  geom_boxplot(fill= "grey", show.legend = FALSE, outlier.shape = NA) +
  geom_jitter(aes(color = Neurodiverse), size=3, alpha=0.2, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.8)) +
  scale_color_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Boxplots of Average Duration of Fixations across Conditions",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Condition",
       y = "Average Duration of Fixations") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0, 1500))#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_avg_duration_fixations_jitter_boxplot
#ggsave("avg_duration_fixations_boxplot.png", viz_avg_duration_fixations_jitter_boxplot, width = 12, height = 8, dpi = 300)



```
```{r}
avg_duration_fixations_media <- avg_duration_fixations %>%
  mutate(Media = factor(Media, order_of_media))

viz_avg_duration_fixations_media_jitter <- ggplot(data = avg_duration_fixations_media, aes(x = Media, y = Value, fill=Neurodiverse)) +
  geom_jitter(aes(color = Neurodiverse), size=2, alpha=0.5, position = position_jitterdodge(jitter.width = 0.1, dodge.width = 0.75),
              pch=21, stroke=0) +
  stat_summary(fun = median, geom = "crossbar", size = 0.3, position = position_dodge(width = 0.7), width=0.5, show.legend = FALSE)+
  scale_fill_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Average Duration of Fixations per Media",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Media",
       y = "Average Duration of Fixations") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0,1500))#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_avg_duration_fixations_media_jitter
#ggsave("avg_duration_fixations_all_media_plot.png", viz_avg_duration_fixations_media_jitter, width = 12, height = 8, dpi = 300)




```

```{R}
avg_duration_fixations_ri <- avg_duration_fixations %>%
  filter(Condition == "Realistic image")
print(avg_duration_fixations_ri)

viz_avg_duration_fixations_ri <- ggplot(data=avg_duration_fixations_ri, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.1,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Average Duration of Fixations for Realistic image Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Average Duration of Fixations") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0,1500)) #+
  #coord_flip()

viz_avg_duration_fixations_ri
#ggsave("avg_duration_fixations_realsitic_plot.png", viz_avg_duration_fixations_ri, width = 10, height = 8, dpi = 300)


```
```{r}
avg_duration_fixations_pp <- avg_duration_fixations %>%
  filter(Condition == "Portrait Painting")
print(avg_duration_fixations_pp)

viz_avg_duration_fixations_pp <- ggplot(data=avg_duration_fixations_pp, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Average Duration of Fixations for Portrait Painting Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Average Duration of Fixations") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0,1500)) #+
  #coord_flip()

viz_avg_duration_fixations_pp
#ggsave("avg_duration_fixations_portrait_plot.png", viz_avg_duration_fixations_pp, width = 10, height = 8, dpi = 300)


```

```{r}
avg_duration_fixations_sa <- avg_duration_fixations %>%
  filter(Condition == "Semi-abstract")
print(avg_duration_fixations_sa)

viz_avg_duration_fixations_sa <- ggplot(data=avg_duration_fixations_sa, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.5, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Average Duration of Fixations for Semi-abstract Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Average Duration of Fixations") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0,1500)) #+
  #coord_flip()

viz_avg_duration_fixations_sa
#ggsave("avg_duration_fixations_semiabstract_plot.png", viz_avg_duration_fixations_sa, width = 10, height = 8, dpi = 300)



```

```{r}
viz_avg_duration_fixations_jitter_boxplot_sa <- ggplot(data = avg_duration_fixations_sa, aes(x =Media, y = Value, color=Neurodiverse)) +
  geom_boxplot(fill= "grey", show.legend = FALSE, outliers=FALSE) +
  geom_jitter(aes(color = Neurodiverse), size=3, alpha=0.3, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.8)) +
  scale_color_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Boxplots of Average Duration of Fixations across Semi-abstract Media",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Condition",
       y = "Average Duration of Fixations") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0, 1500))#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_avg_duration_fixations_jitter_boxplot_sa
#ggsave("AVG_DURATION_fixations_boxplot_Semiabstract.png", viz_avg_duration_fixations_jitter_boxplot_sa, width = 12, height = 8, dpi = 300)



```
```{r}
avg_duration_fixations_ab <- avg_duration_fixations %>%
  filter(Condition == "Abstract")
print(avg_duration_fixations_ab)

viz_avg_duration_fixations_ab <- ggplot(data=avg_duration_fixations_ab, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.5, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Average Duration of Fixations for Abstract Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Average Duration of Fixations") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0,1500)) #+
  #coord_flip()

viz_avg_duration_fixations_ab
#ggsave("avg_duration_fixations_abstract_plot.png", viz_avg_duration_fixations_ab, width = 10, height = 8, dpi = 300)


```
```{R}
avg_duration_fixations_va <- avg_duration_fixations %>%
  filter(Condition == "Very Abstract")
print(avg_duration_fixations_va)

viz_avg_duration_fixations_va <- ggplot(data=avg_duration_fixations_va, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Average Duration of Fixations for Very Abstract Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Average Duration of Fixations") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0,1500)) #+
  #coord_flip()

viz_avg_duration_fixations_va
#ggsave("avg_duration_fixations_veryabstract_plot.png", viz_avg_duration_fixations_va, width = 10, height = 8, dpi = 300)



```

###Metric 3: total duration of fixations visualisations

```{r}

total_duration_fixations_all <- metrics_demographics %>%
  filter(Metric %in% c("Total_duration_of_fixations.Background",
                       "Total_duration_of_fixations.Eye_1",
                       "Total_duration_of_fixations.Eye_2",
                       "Total_duration_of_fixations.Eyes",
                       "Total_duration_of_fixations.Face",
                       "Total_duration_of_fixations.Mouth",
                       "Total_duration_of_fixations.Nose",
                       "Total_duration_of_fixations.Nose_2") & Condition != "Entire Recording") %>%
  mutate(Condition = factor(Condition, levels= order_of_conditions))
print(total_duration_fixations_all)

total_duration_fixations <- total_duration_fixations_all %>%
  distinct(Participant, Media, Condition, Neurodiverse, Metric, .keep_all = TRUE) %>%
  group_by(Participant, Media, Condition, Neurodiverse) %>%
  summarize(Value = sum(Value, na.rm = TRUE)) %>%
  ungroup()
print(total_duration_fixations)

```

```{r}

viz_total_duration_fixations_jitter <- ggplot(data = total_duration_fixations, aes(x = Condition, y = Value, fill=Neurodiverse)) +
  geom_jitter(aes(color = Neurodiverse), size=3, alpha=0.5, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun = median, geom = "crossbar", size = 0.3, position = position_dodge(width = 0.7), width=0.5, show.legend = FALSE)+
  scale_fill_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Total Duration of Fixations per Condition",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Condition",
       y = "Total Duration of fixations") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(2000,18000))#+
  #coord_flip() #FLIPS X AND Y AXIS 


viz_total_duration_fixations_jitter
#ggsave("total_duration_fixations_condition_plot.png", viz_total_duration_fixations_jitter, width = 10, height = 8, dpi = 300)


```
```{r}
viz_total_duration_fixations_jitter_boxplot<- ggplot(data = total_duration_fixations, aes(x =Condition, y = Value, color=Neurodiverse)) +
  geom_boxplot(fill= "grey", show.legend = FALSE, outliers=FALSE) +
  geom_jitter(aes(color = Neurodiverse), size=3, alpha=0.3, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.8)) +
  scale_color_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Boxplots of Total Duration of Fixations across Conditions",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Condition",
       y = "Total Duration of Fixations") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(2000, 18000))#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_total_duration_fixations_jitter_boxplot
#ggsave("total_duration_fixations_boxplot_condition.png", viz_total_duration_fixations_jitter_boxplot, width = 12, height = 8, dpi = 300)



```
```{r}

total_duration_fixations_media <- total_duration_fixations %>%
  mutate(Media= factor(Media, order_of_media))

viz_total_duration_fixations_media_jitter <- ggplot(data = total_duration_fixations_media, aes(x = Media, y = Value, fill=Neurodiverse)) +
  geom_jitter(aes(color = Neurodiverse), size=2, alpha=0.5, position = position_jitterdodge(jitter.width = 0.1, dodge.width = 0.75),
              pch=21, stroke=0) +
  stat_summary(fun = median, geom = "crossbar", size = 0.3, position = position_dodge(width = 0.7), width=0.5, show.legend = FALSE)+
  scale_fill_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Total Duration of Fixations per Media",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Media",
       y = "Total Duration of Fixations") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(2000,18000))#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_total_duration_fixations_media_jitter
#ggsave("total_duration_fixations_all_media_plot.png", viz_total_duration_fixations_media_jitter, width = 12, height = 8, dpi = 300)




```


```{R}
total_duration_fixations_ri <- total_duration_fixations %>%
  filter(Condition == "Realistic image")
print(total_duration_fixations_ri)

viz_total_duration_fixations_ri <- ggplot(data=total_duration_fixations_ri, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Total Duration of Fixations for Realistic image Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Total Duration of Fixations") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(2000, 18000)) #+
  #coord_flip()

viz_total_duration_fixations_ri
#ggsave("total_duration_fixations_realistic_plot.png", viz_total_duration_fixations_ri, width = 10, height = 8, dpi = 300)



```
```{r}
total_duration_fixations_pp <- total_duration_fixations %>%
  filter(Condition== "Portrait Painting")
print(total_duration_fixations_pp)

viz_total_duration_fixations_pp <- ggplot(data=total_duration_fixations_pp, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.1,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Total Duration of Fixations for Portrait Painting Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Total Duration of Fixations") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(2000, 18000)) #+
  #coord_flip()

viz_total_duration_fixations_pp
#ggsave("total_duration_fixations_portrait_plot.png", viz_total_duration_fixations_pp, width = 10, height = 8, dpi = 300)


```
```{r}
total_duration_fixations_sa <- total_duration_fixations %>%
  filter(Condition == "Semi-abstract")
print(total_duration_fixations_sa)

viz_total_duration_fixations_sa <- ggplot(data=total_duration_fixations_sa, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Total Duration of Fixations for Semi-abstract Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Total Duration of Fixations") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(2000, 18000)) #+
  #coord_flip()

viz_total_duration_fixations_sa
#ggsave("total_duration_fixations_semiabstract_plot.png", viz_total_duration_fixations_sa, width = 10, height = 8, dpi = 300)



```
```{r}
viz_total_duration_fixations_jitter_boxplot_sa<- ggplot(data = total_duration_fixations_sa, aes(x =Media, y = Value, color=Neurodiverse)) +
  geom_boxplot(fill= "grey", show.legend = FALSE, outlier.shape = NA) +
  geom_jitter(aes(color = Neurodiverse), size=3, alpha=0.3, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.8)) +
  scale_color_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Boxplots of Total Duration of Fixations across Semi-abstract Condition",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Condition",
       y = "Total Duration of Fixations") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(2000, 18000))#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_total_duration_fixations_jitter_boxplot_sa
#ggsave("total_duration_fixations_boxplot_sa.png", viz_total_duration_fixations_jitter_boxplot_sa, width = 12, height = 8, dpi = 300)



```


```{r}
total_duration_fixations_ab <- total_duration_fixations %>%
  filter(Condition == "Abstract")
print(total_duration_fixations_ab)

viz_total_duration_fixations_ab <- ggplot(data=total_duration_fixations_ab, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.1,
                                                                              dodge.width = 0.6),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Total Duration of Fixations for Abstract Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Total Duration of Fixations") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(2000, 18000)) #+
  #coord_flip()

viz_total_duration_fixations_ab
#ggsave("total_duration_fixations_abstract_plot.png", viz_total_duration_fixations_ab, width = 10, height = 8, dpi = 300)

```
```{r}
total_duration_fixations_va <- total_duration_fixations %>%
  filter(Condition == "Very Abstract")
print(total_duration_fixations_va)

viz_total_duration_fixations_va <- ggplot(data=total_duration_fixations_va, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.1,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Total Duration of Fixations for Very Abstract Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Total Duration of Fixations") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(2000, 18000)) #+
  #coord_flip()

viz_total_duration_fixations_va
#ggsave("total_duration_fixations_veryabstract_plot.png", viz_total_duration_fixations_va, width = 10, height = 8, dpi = 300)



```
```{r}
viz_total_duration_fixations_jitter_boxplot_va<- ggplot(data = total_duration_fixations_va, aes(x =Media, y = Value, color=Neurodiverse)) +
  geom_boxplot(fill= "grey", show.legend = FALSE, outlier.shape = NA) +
  geom_jitter(aes(color = Neurodiverse), size=3, alpha=0.3, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.8)) +
  scale_color_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Boxplots of Total Duration of Fixations across Very abstract Condition",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Condition",
       y = "Total Duration of Fixations") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(2000, 18000))#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_total_duration_fixations_jitter_boxplot_va
#ggsave("total_duration_fixations_boxplot_va.png", viz_total_duration_fixations_jitter_boxplot_va, width = 12, height = 8, dpi = 300)




```

###Metric 4: time to first fixation visualisation 

```{r}
time_first_fixations_all <- metrics_demographics %>%
  filter(Metric %in% c("Time_to_first_fixation.Background",
                       "Time_to_first_fixation.Eye_1",
                       "Time_to_first_fixation.Eye_2",
                       "Time_to_first_fixation.Eyes",
                       "Time_to_first_fixation.Face",
                       "Time_to_first_fixation.Mouth",
                       "Time_to_first_fixation.Nose",
                       "Time_to_first_fixation.Nose_2") & Condition != "Entire Recording") %>%
  mutate(Condition = factor(Condition, levels= order_of_conditions))
print(time_first_fixations_all)

time_first_fixations <- time_first_fixations_all %>%
  distinct(Participant, Media, Condition, Neurodiverse, Metric, .keep_all = TRUE) %>%
  group_by(Participant, Media, Condition, Neurodiverse) %>%
  summarize(Value = min(Value, na.rm = TRUE)) %>%
  ungroup()
print(time_first_fixations)

```

```{r}
viz_time_first_fixations_jitter <- ggplot(data = time_first_fixations, aes(x = Condition, y = Value, fill=Neurodiverse)) +
  geom_jitter(aes(color = Neurodiverse), size=3, alpha=0.5, position = position_jitterdodge(jitter.width = 0.3, dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun = median, geom = "crossbar", size = 0.3, position = position_dodge(width = 0.7), width=0.5, show.legend = FALSE)+
  scale_fill_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Time to First Fixation per Condition",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Condition",
       y = "Time to First Fixation (ms)") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0,2700))#+
  #coord_flip() #FLIPS X AND Y AXIS 


viz_time_first_fixations_jitter
#ggsave("time_first_fixations_condition_plot.png", viz_time_first_fixations_jitter, width = 10, height = 8, dpi = 300)

```
```{r} 
#BOXPLOT NOT SHOWING OUTLIERS
viz_time_first_fixations_jitter_boxplot<- ggplot(data = time_first_fixations, aes(x =Condition, y = Value, color=Neurodiverse)) +
  geom_boxplot(fill= "grey", show.legend = FALSE, outliers = FALSE) +
  geom_jitter(aes(color = Neurodiverse), size=3, alpha=0.3, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.8)) +
  scale_color_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Boxplots of Time to First Fixation across Conditions",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Condition",
       y = "Time to First Fixation (ms)") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0, 2700))#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_time_first_fixations_jitter_boxplot
#ggsave("time_first_fixations_boxplot_condition.png", viz_time_first_fixations_jitter_boxplot, width = 12, height = 8, dpi = 300)



```
```{R}
time_first_fixations_media <- time_first_fixations %>%
  mutate(Media = factor(Media, levels = order_of_media))

viz_time_first_fixations_media_jitter <- ggplot(data = time_first_fixations_media, aes(x = Media, y = Value, fill=Neurodiverse)) +
  geom_jitter(aes(color = Neurodiverse), size=2, alpha=0.5, position = position_jitterdodge(jitter.width = 0.1, dodge.width = 0.75),
              pch=21, stroke=0) +
  stat_summary(fun = median, geom = "crossbar", size = 0.3, position = position_dodge(width = 0.7), width=0.5, show.legend = FALSE)+
  scale_fill_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Time to First Fixation per Media",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Media",
       y = "Time to First Fixations (ms)") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0,2700))#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_time_first_fixations_media_jitter
#ggsave("time_first_fixations_all_media_plot.png", viz_time_first_fixations_media_jitter, width = 12, height = 8, dpi = 300)


```
```{r}
time_first_fixations_ri <- time_first_fixations %>%
  filter(Condition == "Realistic image")
print(time_first_fixations_ri)

viz_time_first_fixations_ri <- ggplot(data=time_first_fixations_ri, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Time to First Fixation for Realistic image Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Time to First Fixation (ms)") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0, 2700)) #+
  #coord_flip()

viz_time_first_fixations_ri
#ggsave("time_first_fixations_realistic_plot.png", viz_time_first_fixations_ri, width = 10, height = 8, dpi = 300)


```
```{r}
time_first_fixations_pp <- time_first_fixations %>%
  filter(Condition == "Portrait Painting")
print(time_first_fixations_pp)

viz_time_first_fixations_pp <- ggplot(data=time_first_fixations_pp, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Time to First Fixation for Portrait Painting Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Time to First Fixation (ms)") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0, 2700)) #+
  #coord_flip()

viz_time_first_fixations_pp
#ggsave("time_first_fixations_portrait_plot.png", viz_time_first_fixations_pp, width = 10, height = 8, dpi = 300)



```
```{r}
time_first_fixations_sa <- time_first_fixations %>%
  filter(Condition == "Semi-abstract")
print(time_first_fixations_sa)

viz_time_first_fixations_sa <- ggplot(data=time_first_fixations_sa, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Time to First Fixation for Semi-abstract Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Time to First Fixation (ms)") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0, 2700)) #+
  #coord_flip()

viz_time_first_fixations_sa
#ggsave("time_first_fixations_semiabstract_plot.png", viz_time_first_fixations_sa, width = 10, height = 8, dpi = 300)

```
```{r}
time_first_fixations_ab <-time_first_fixations %>%
  filter(Condition == "Abstract")
print(time_first_fixations_ab)

viz_time_first_fixations_ab <- ggplot(data=time_first_fixations_ab, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Time to First Fixation for Abstract Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Time to First Fixation (ms)") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0, 2700)) #+
  #coord_flip()

viz_time_first_fixations_ab
#ggsave("time_first_fixations_abstract_plot.png", viz_time_first_fixations_ab, width = 10, height = 8, dpi = 300)

```
```{r}
time_first_fixations_va <- time_first_fixations %>%
  filter(Condition == "Very Abstract")
print(time_first_fixations_va)

viz_time_first_fixations_va <- ggplot(data=time_first_fixations_va, aes(x=Media, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Time to First Fixation for Very Abstract Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Time to First Fixation (ms)") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0, 2700)) #+
  #coord_flip()

viz_time_first_fixations_va
#ggsave("time_first_fixations_veryabstract_plot.png", viz_time_first_fixations_va, width = 10, height = 8, dpi = 300)

```

###Metric 5: proportion of total fixation duration visualisation

cant use entire recording as total value as that includes everything including fixation, instructions, thank you etc so do what katja said which is to sum total fixation duration across conditions for each participant ie for condition Realistic image would add tfd for RI1, RI2, RI3, RI4, RI5 for each participant and then calculate proportion by then dividing each media by condition sum so (participant 1 RI1/ RI1 SUM for media) and then (RI1 PARTICIPANT 1/ RI SUM FOR CONDITION) SUMMING MEDIA ACROSS CONDITIONS AND USE THAT AS ENTIRE RECORDING FOR EACH TRIAL --> SUM ALL MEDIA ACROSS ALL CONDITIONS AND THAT BECOMES NEW ENTIRE RECORDING FOR EACH PARTICIPANT AND CAN THEN DIVIDE BY CONDITION SO I HAVE TOTAL FIXATION DURATION PROPORTION ACROSS CONDITIONS FOR EACH PARTICIPANT  

condition:
```{r}
total_duration_fixations #already made

total_fixation_entire_recording <- total_duration_fixations %>%
  group_by(Participant) %>%
  summarize(Total_Fixation_Entire = sum(Value, na.rm = TRUE))
total_fixation_entire_recording

fixation_duration_proportion <- total_duration_fixations %>%
  left_join(total_fixation_entire_recording, by = "Participant") %>%
  mutate(Proportion_Fixation_Duration = (Value / Total_Fixation_Entire) * 100) %>%
  select(Participant, Media, Condition, Proportion_Fixation_Duration, Neurodiverse) %>%
  distinct() 
fixation_duration_proportion #adds up to 100% for each participant 

fixation_duration_proportion <- fixation_duration_proportion %>%
  mutate(Condition = factor(Condition, levels=order_of_conditions))

```
now visualise 

```{r}

viz_proportion_total_duration_fixations <- ggplot(data=fixation_duration_proportion, aes(x=Condition, y=Proportion_Fixation_Duration, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Proportion of Total Duration of Fixations across Conditions",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Condition",
       y= "% of Total Fixation Duration") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0, 10)) #+
  #coord_flip()

viz_proportion_total_duration_fixations
#ggsave("proportion_total_duration_fixations_plot.png", viz_proportion_total_duration_fixations, width = 10, height = 8, dpi = 300)

#prints each participants % fixation for each media for each condition which is why theres so many dots

```

```{R}
viz_proportion_fixation_duration_jitter_boxplot<- ggplot(data = fixation_duration_proportion, aes(x =Condition, y = Proportion_Fixation_Duration, color=Neurodiverse)) +
  geom_boxplot(fill= "grey", show.legend = FALSE, outliers = FALSE) +
  geom_jitter(aes(color = Neurodiverse), size=3, alpha=0.3, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.8)) +
  scale_color_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Boxplots of % of Total Fixation Duration across Conditions",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Condition",
       y = "Proportion of Total Fixation Duration (%)") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0, 10))#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_proportion_fixation_duration_jitter_boxplot
#ggsave("viz_proportion_fixation_duration_boxplot_condition.png", viz_proportion_fixation_duration_jitter_boxplot, width = 12, height = 8, dpi = 300)

```
```{r}

fixation_duration_proportion_ri <- fixation_duration_proportion %>%
  filter(Condition == "Realistic image")

viz_proportion_duration_fixations_ri <- ggplot(data= fixation_duration_proportion_ri, aes(x=Media, y=Proportion_Fixation_Duration, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Proportion of Total Duration Fixation for Realistic image Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Proportion of Total Duration Fixation (%)") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0, 10)) #+
  #coord_flip()

viz_proportion_duration_fixations_ri
#ggsave("proportion_duration_fixations_realistic_plot.png", viz_proportion_duration_fixations_ri, width = 10, height = 8, dpi = 300)


```
```{R}

fixation_duration_proportion_pp <- fixation_duration_proportion %>%
  filter(Condition == "Portrait Painting")

viz_proportion_duration_fixations_pp <- ggplot(data= fixation_duration_proportion_pp, aes(x=Media, y=Proportion_Fixation_Duration, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Proportion of Total Duration Fixation for Portrait Painting Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Proportion of Total Duration Fixation (%)") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0, 10)) #+
  #coord_flip()

viz_proportion_duration_fixations_pp
#ggsave("proportion_duration_fixations_portrait_plot.png", viz_proportion_duration_fixations_pp, width = 10, height = 8, dpi = 300)



```
```{r}

fixation_duration_proportion_sa <- fixation_duration_proportion %>%
  filter(Condition == "Semi-abstract")

viz_proportion_duration_fixations_sa <- ggplot(data= fixation_duration_proportion_sa, aes(x=Media, y=Proportion_Fixation_Duration, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Proportion of Total Duration Fixation for Semi-Abstract Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Proportion of Total Duration Fixation (%)") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0, 10)) #+
  #coord_flip()

viz_proportion_duration_fixations_sa
#ggsave("proportion_duration_fixations_semiabstract_plot.png", viz_proportion_duration_fixations_sa, width = 10, height = 8, dpi = 300)

```

```{r}

fixation_duration_proportion_ab <- fixation_duration_proportion %>%
  filter(Condition == "Abstract")

viz_proportion_duration_fixations_ab <- ggplot(data= fixation_duration_proportion_ab, aes(x=Media, y=Proportion_Fixation_Duration, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.3, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Proportion of Total Duration Fixation for Abstract Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Proportion of Total Duration Fixation (%)") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0, 10)) #+
  #coord_flip()

viz_proportion_duration_fixations_ab
#ggsave("proportion_duration_fixations_abstract_plot.png", viz_proportion_duration_fixations_ab, width = 10, height = 8, dpi = 300)



```
```{r}

fixation_duration_proportion_va <- fixation_duration_proportion %>%
  filter(Condition == "Very Abstract")

viz_proportion_duration_fixations_va <- ggplot(data= fixation_duration_proportion_va, aes(x=Media, y=Proportion_Fixation_Duration, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.3, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Proportion of Total Duration Fixation for Very Abstract Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Media",
       y= "Proportion of Total Duration Fixation (%)") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  scale_y_continuous(limits=c(0, 10)) #+
  #coord_flip()

viz_proportion_duration_fixations_va
#ggsave("proportion_duration_fixations_veryabstract_plot.png", viz_proportion_duration_fixations_va, width = 10, height = 8, dpi = 300)


```
```{r}
viz_proportion_fixation_duration_jitter_boxplot_va<- ggplot(data = fixation_duration_proportion_va, aes(x =Media, y = Proportion_Fixation_Duration, color=Neurodiverse)) +
  geom_boxplot(fill= "grey", show.legend = FALSE, outliers = FALSE) +
  geom_jitter(aes(color = Neurodiverse), size=3, alpha=0.3, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.8)) +
  scale_color_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Boxplots of % of Total Fixation Duration across Very Abstract Condition",
       subtitle = "Comparison between Neurodiverse and Neurotypical Groups",
       x = "Condition",
       y = "Proportion of Total Fixation Duration (%)") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0, 10))#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_proportion_fixation_duration_jitter_boxplot_va
#ggsave("viz_proportion_fixation_duration_boxplot_va.png", viz_proportion_fixation_duration_jitter_boxplot_va, width = 12, height = 8, dpi = 300)

```

##AOI visualisations

so weve had alittle look at saccade data and fixation data so lets look at AOI metrics across groups 

AOI metrics: no of saccades; peak velocity of entry saccades; time to 1st fixation; avg duration of fixation to aoi; total duration fixation aoi ; no of fixations 


saccade AOIs are very important, lets have a look across participants and across conditions before exploring within conditions 

###Metric 1: Number of Saccades
```{r}
no_saccades_AOI <- metrics_demographics %>%
  filter(Media != "Entire Recording") %>%
  filter(Metric %in% c("Number_of_saccades_in_AOI.Background", 
                       "Number_of_saccades_in_AOI.Mouth", 
                       "Number_of_saccades_in_AOI.Nose", 
                       "Number_of_saccades_in_AOI.Eyes", 
                       "Number_of_saccades_in_AOI.Face",
                       "Number_of_saccades_in_AOI.Eye_1",
                       "Number_of_saccades_in_AOI.Eye_2")) %>%
    mutate(Metric = sub("Number_of_saccades_in_AOI.", "", Metric)) %>%
  mutate(Condition = factor(Condition, levels = order_of_conditions)) %>%
  distinct(Participant, Condition, Media, Neurodiverse, Metric, Value, .keep_all=TRUE)
no_saccades_AOI

#some media have eye_1 and eye_2 instead of eyes so need to sum them into one eyes aoi
eye_sum <- no_saccades_AOI %>%
  filter(Metric %in% c("Eye_1",
                       "Eye_2")) %>%
  group_by(Participant, Media, Condition, Neurodiverse) %>%
  summarize(Value = sum(Value, na.rm=TRUE)) %>%
  mutate(Metric = "Eyes") %>%
  ungroup()
eye_sum

#combine new eye calc back in
no_saccades_aoi_final <- bind_rows(no_saccades_AOI %>%
                                     filter(!Metric %in% c("Eye_1", "Eye_2")),
                                   eye_sum)
View(no_saccades_aoi_final)

#calcualte total numbe rof saccades
total_no_saccades_AOI <- no_saccades_aoi_final %>%
  group_by(Condition, Metric, Neurodiverse) %>%
  summarize(total_no_saccades = sum(Value, na.rm = TRUE),
            sd_no_saccades = sd(Value, na.rm = TRUE)) %>%
  ungroup()
total_no_saccades_AOI

#plot barchart
viz_no_saccades_AOI<- ggplot(data = total_no_saccades_AOI, aes(x = Condition, y = total_no_saccades, fill=Neurodiverse)) +
  geom_bar(stat="identity", position = position_dodge(width = 0.9), size = 0.3) +
  geom_errorbar(aes(ymin = total_no_saccades - sd_no_saccades, ymax = total_no_saccades + sd_no_saccades),
                width = 0.2, position = position_dodge(width = 0.9)) +
  labs(title = "Total Number of Saccades across AOIs",
       x = "AOI",
       y = "Total Number of Saccades") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1), 
        axis.title.y = element_text(margin = margin(r=20))) + #adds a space between the y title and the graphs no overlap
  facet_wrap(~ Metric, scales = "free_x")


print(viz_no_saccades_AOI)
#ggsave("avg_no_saccades_aoi_bar_facet_aoi.png", viz_no_saccades_AOI, width = 12, height = 10, dpi = 300)


```



```{r}

viz_no_saccades_aoi <- ggplot(data= no_saccades_aoi_final, aes(x=Metric, y=Value, fill=Neurodiverse)) +
  geom_boxplot(fill= "grey", show.legend = FALSE, outliers = FALSE) +
  geom_jitter(aes(color=Neurodiverse), size=1, alpha=0.2, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.3, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Number of Saccades for AOI across Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "AOI",
       y= "Number of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  facet_wrap(~Condition, scales ="free_x")#+
  #coord_flip()

viz_no_saccades_aoi
#ggsave("proportion_duration_fixations_veryabstract_plot.png", viz_proportion_duration_fixations_va, width = 10, height = 8, dpi = 300)


```
very abstract is farily consistent across features,  and realistic image and pp have the largest disparities which makes sense according to literature 
```{r}
viz_no_saccades_aoi_jitter_condition <- ggplot(data = no_saccades_aoi_final, aes(x = Condition, y = Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=2, alpha=0.5, position = position_jitterdodge(jitter.width = 0.3, dodge.width = 0.8),
              pch=21, stroke=0) +
  stat_summary(fun = median, geom = "crossbar", size = 0.4, position = position_dodge(width = 0.8), width=0.5, show.legend = FALSE)+
  scale_fill_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Number of saccades per AOI",
       subtitle = "Comparison between Conditions",
       x = "Condition",
       y = "Number of Saccades") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0,35)) +
  facet_wrap(~Metric, scales="free_x")#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_no_saccades_aoi_jitter_condition
#ggsave("no_saccades_aoi_condition_jitter_facet_aoi.png", viz_no_saccades_aoi_jitter_condition, width = 12, height = 8, dpi = 300)


```

lets have a direct look at specific features across conditions ie eyes and face 
BACKGROUND
```{R}
no_saccades_AOI_background <- no_saccades_AOI %>%
  filter(Metric == "Background" & Condition !="Entire Recording")
no_saccades_AOI_background

viz_no_saccade_AOI_background_Condition <- ggplot(data= no_saccades_AOI_background, aes(x=Condition, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.6),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Number of Saccades for Background per Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Condition",
       y= "Number of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  scale_y_continuous(limits=c(0, 35)) #+
  #coord_flip()

viz_no_saccade_AOI_background_Condition
#ggsave("no_saccades_AOI_background_conditions.png", viz_no_saccade_AOI_background_Condition, width = 10, height = 8, dpi = 300)


```

EYES
```{r}
no_saccades_AOI_eyes <- no_saccades_AOI %>%
  filter(Metric %in% c("Eyes", "Eye_1", "Eye_2"), Condition != "Entire Recording") #needs to be fixed need to sum together 
no_saccades_AOI_eyes

viz_no_saccade_AOI_eyes_Condition <- ggplot(data= no_saccades_AOI_eyes, aes(x=Value, y=Condition, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.4, position= position_jitterdodge(jitter.width = 0.3,
                                                                              dodge.width = 0.9),
              pch=21, stroke=0) +
  
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.8),
               width=0.5, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Number of Saccades for Eyes per Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       y= "Condition",
       x= "Number of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  scale_x_continuous(limits=c(0, 35)) +
  coord_flip()

viz_no_saccade_AOI_eyes_Condition
#ggsave("no_saccades_AOI_eyes_conditions.png", viz_no_saccade_AOI_eyes_Condition, width = 10, height = 8, dpi = 300)


```

face? 

```{r}
no_saccades_AOI_face <- no_saccades_AOI %>%
  filter(Metric == "Face", Condition != "Entire Recording")
no_saccades_AOI_face

viz_no_saccade_AOI_face_Condition <- ggplot(data= no_saccades_AOI_face, aes(y=Value, x=Condition, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.4, position= position_jitterdodge(jitter.width = 0.3,
                                                                              dodge.width = 0.9),
              pch=21, stroke=0) +
  
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.8),
               width=0.6, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Number of Saccades for Face per Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Condition",
       y= "Number of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  scale_y_continuous(limits=c(0, 35)) 
  #coord_flip()

viz_no_saccade_AOI_face_Condition
#ggsave("no_saccades_AOI_face_conditions.png", viz_no_saccade_AOI_face_Condition, width = 10, height = 8, dpi = 300)


```

mouth has least afcross all conditiosn ; nd looks at face more than NT across all conditions but Real = similar, ND also look at backgrounds more than NT, except for VA where they both look increasingly at backgrounds, VERY INTERESTING STUFF !! 
```{r}
no_saccades_AOI_mouth <- no_saccades_AOI %>%
  filter(Metric == "Mouth", Condition != "Entire Recording")
no_saccades_AOI_mouth

viz_no_saccade_AOI_mouth_Condition <- ggplot(data= no_saccades_AOI_mouth, aes(y=Value, x=Condition, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.4, position= position_jitterdodge(jitter.width = 0.3,
                                                                              dodge.width = 0.9),
              pch=21, stroke=0) +
  
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.8),
               width=0.6, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Number of Saccades for Mouth per Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Condition",
       y= "Number of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  scale_y_continuous(limits=c(0, 35)) 
  #coord_flip()

viz_no_saccade_AOI_mouth_Condition
#ggsave("no_saccades_AOI_mouth_conditions.png", viz_no_saccade_AOI_mouth_Condition, width = 10, height = 8, dpi = 300)


```
NOSE: 
```{r}
no_saccades_AOI_nose <- no_saccades_AOI %>%
  filter(Metric == "Nose", Condition != "Entire Recording")
no_saccades_AOI_nose

viz_no_saccade_AOI_nose_Condition <- ggplot(data= no_saccades_AOI_nose, aes(y=Value, x=Condition, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.4, position= position_jitterdodge(jitter.width = 0.3,
                                                                              dodge.width = 0.9),
              pch=21, stroke=0) +
  
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.8),
               width=0.6, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Number of Saccades for Nose per Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Condition",
       y= "Number of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  scale_y_continuous(limits=c(0, 20)) 
  #coord_flip()

viz_no_saccade_AOI_nose_Condition
#ggsave("no_saccades_AOI_nose_conditions.png", viz_no_saccade_AOI_nose_Condition, width = 10, height = 8, dpi = 300)

```
done alot of the main saccade AOI info, lets go back to fixations, lets look for patterns and trends
 
peak velocity of entry saccades; time to 1st fixation; avg duration of fixation to aoi; total duration fixation aoi ; no of fixations 
 
###metric 2: peak velocity of entry saccades visualisations

```{r}
#Metric 2: Peak Velocity of entry saccades

peak_velocity_entry_saccades_aoi <- metrics_demographics %>%
  filter(Media != "Entire Recording") %>%
  filter(Metric %in% c("Peak_velocity_of_entry_saccade.Background", 
                       "Peak_velocity_of_entry_saccade.Mouth", 
                       "Peak_velocity_of_entry_saccade.Nose", 
                       "Peak_velocity_of_entry_saccade.Eyes", 
                       "Peak_velocity_of_entry_saccade.Face",
                       "Peak_velocity_of_entry_saccade.Eye_1",
                       "Peak_velocity_of_entry_saccade.Eye_2")) %>%
    mutate(Metric = sub("Peak_velocity_of_entry_saccade.", "", Metric)) %>%
  mutate(Condition = factor(Condition, levels = order_of_conditions)) %>%
  distinct(Participant, Condition, Media, Neurodiverse, Metric, Value, .keep_all=TRUE)
peak_velocity_entry_saccades_aoi

#caluclate eye value using eye_1 and eye_2 
eye_sum_velocity_entry_aoi <- peak_velocity_entry_saccades_aoi %>%
  filter(Metric %in% c("Eye_1",
                       "Eye_2")) %>%
  group_by(Participant, Media, Condition, Neurodiverse) %>%
  summarize(Value = max(Value, na.rm=TRUE)) %>% #uses max as highest velocity
  mutate(Metric = "Eyes") %>%
  ungroup()
eye_sum_velocity_entry_aoi

peak_velocity_entry_saccade_aoi_final <- bind_rows(
  peak_velocity_entry_saccades_aoi %>%
    filter(!Metric %in% c("Eye_1", "Eye_2")),
  eye_sum_velocity_entry_aoi
) %>%
  mutate(Media = factor(Media, levels = order_of_media))

View(peak_velocity_entry_saccade_aoi_final)


```
```{R}
avg_peak_velocity_saccades_AOI <- peak_velocity_entry_saccade_aoi_final %>%
  group_by(Condition, Metric, Neurodiverse) %>%
  summarize(avg_peak_velocity_saccades = mean(Value, na.rm = TRUE),
            sd_peak_velocity_saccades = sd(Value, na.rm = TRUE)) %>%
  ungroup()
avg_peak_velocity_saccades_AOI

viz_peak_velocity_saccades_AOI_bar<- ggplot(data = avg_peak_velocity_saccades_AOI, aes(x = Condition, y = avg_peak_velocity_saccades, fill=Neurodiverse)) +
  geom_bar(stat="identity", position = position_dodge(width = 0.9), size = 0.3) +
  geom_errorbar(aes(ymin = avg_peak_velocity_saccades - sd_peak_velocity_saccades, ymax = avg_peak_velocity_saccades + sd_peak_velocity_saccades),
                width = 0.2, position = position_dodge(width = 0.9)) +
  labs(title = "Average Peak Velocity of Saccades across AOIs",
       x = "AOI",
       y = "Average Peak Velocity of Saccades") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1), 
        axis.title.y = element_text(margin = margin(r=20))) + #adds a space between the y title and the graphs no overlap
  facet_wrap(~ Metric, scales = "free_x")


print(viz_peak_velocity_saccades_AOI_bar)
#ggsave("Average_peak_velocity_saccades_across_aois_bar.png", viz_peak_velocity_saccades_AOI_bar, width = 12, height = 8, dpi = 300)
```


```{r}
viz_peak_velocity_saccades_aoi_jitter_condition <- ggplot(data = peak_velocity_entry_saccade_aoi_final, aes(x = Condition, y = Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=2, alpha=0.5, position = position_jitterdodge(jitter.width = 0.3, dodge.width = 0.8),
              pch=21, stroke=0) +
  stat_summary(fun = median, geom = "crossbar", size = 0.3, position = position_dodge(width = 0.8), width=0.5, show.legend = FALSE)+
  scale_fill_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Peak Velocity of entry saccades per AOI",
       subtitle = "Comparison between Conditions",
       x = "AOI",
       y = "Peak Velocity of entry saccades") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  #scale_y_continuous(limits = c(0,35)) +
  facet_wrap(~Metric, scales="free_x")#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_peak_velocity_saccades_aoi_jitter_condition
#ggsave("peak_Velocity_aoi_condition_jitter.png", viz_peak_velocity_saccades_aoi_jitter_condition, width = 12, height = 8, dpi = 300)


```

across aois 
background
```{r}
peak_velocity_entry_saccades_AOI_background <- peak_velocity_entry_saccade_aoi_final %>%
  filter(Metric == "Background")
peak_velocity_entry_saccades_AOI_background

viz_peak_velocity_entry_saccade_AOI_background_Condition <- ggplot(data= peak_velocity_entry_saccades_AOI_background, aes(x=Condition, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.8),
              pch=21, stroke=0) +
  
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Peak Velocity of Entry Saccades for Background per Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Condition",
       y= "Peak Velocity of Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  scale_y_continuous(limits=c(0, 600)) #+
  #coord_flip()

viz_peak_velocity_entry_saccade_AOI_background_Condition
#ggsave("peak_velocity_saccades_AOI_background_conditions.png", viz_peak_velocity_entry_saccade_AOI_background_Condition, width = 10, height = 8, dpi = 300)



```
```{r}
peak_velocity_entry_saccades_AOI_eyes <- peak_velocity_entry_saccade_aoi_final %>%
  filter(Metric == "Eyes")
peak_velocity_entry_saccades_AOI_eyes

viz_peak_velocity_entry_saccade_AOI_eyes_Condition <- ggplot(data= peak_velocity_entry_saccades_AOI_eyes, aes(x=Condition, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.8),
              pch=21, stroke=0) +
  
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Peak Velocity of Entry Saccades for Eyes per Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Condition",
       y= "Peak Velocity of EntrySaccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  scale_y_continuous(limits=c(0, 600)) #+
  #coord_flip()

viz_peak_velocity_entry_saccade_AOI_eyes_Condition
#ggsave("peak_velocity_entry_saccades_AOI_eyes_conditions.png", viz_peak_velocity_entry_saccade_AOI_eyes_Condition, width = 10, height = 8, dpi = 300)



```
face
```{R}
peak_velocity_entry_saccades_AOI_face <- peak_velocity_entry_saccade_aoi_final %>%
  filter(Metric == "Face")
peak_velocity_entry_saccades_AOI_face

viz_peak_velocity_entry_saccade_AOI_face_Condition <- ggplot(data= peak_velocity_entry_saccades_AOI_face, aes(x=Condition, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.8),
              pch=21, stroke=0) +
  
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.8),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Peak Velocity of Entry Saccades for Face per Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Condition",
       y= "Peak Velocity of Entry Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  scale_y_continuous(limits=c(0, 600)) #+
  #coord_flip()

viz_peak_velocity_entry_saccade_AOI_face_Condition
#ggsave("peak_velocity_entry_saccades_AOI_face_conditions.png", viz_peak_velocity_entry_saccade_AOI_face_Condition, width = 10, height = 8, dpi = 300)


```
mouth
```{r}
peak_velocity_entry_saccades_AOI_mouth <- peak_velocity_entry_saccade_aoi_final %>%
  filter(Metric == "Mouth")
peak_velocity_entry_saccades_AOI_mouth

viz_peak_velocity_entry_saccade_AOI_mouth_Condition <- ggplot(data= peak_velocity_entry_saccades_AOI_mouth, aes(x=Condition, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.8),
              pch=21, stroke=0) +
  
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.8),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Peak Velocity of Entry Saccades for Mouth per Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Condition",
       y= "Peak Velocity of Entry Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  scale_y_continuous(limits=c(0, 600)) #+
  #coord_flip()

viz_peak_velocity_entry_saccade_AOI_mouth_Condition
#ggsave("peak_velocity_entry_saccades_AOI_mouth_conditions.png", viz_peak_velocity_entry_saccade_AOI_mouth_Condition, width = 10, height = 8, dpi = 300)

```
 nose
 
```{r}
peak_velocity_entry_saccades_AOI_nose <- peak_velocity_entry_saccade_aoi_final %>%
  filter(Metric == "Nose")
peak_velocity_entry_saccades_AOI_nose

viz_peak_velocity_entry_saccade_AOI_nose_Condition <- ggplot(data= peak_velocity_entry_saccades_AOI_nose, aes(x=Condition, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.8),
              pch=21, stroke=0) +
  
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.8),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Peak Velocity of Entry Saccades for Nose per Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Condition",
       y= "Peak Velocity of Entry Saccades") +
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  scale_y_continuous(limits=c(0, 600)) #+
  #coord_flip()

viz_peak_velocity_entry_saccade_AOI_nose_Condition
#ggsave("peak_velocity_entry_saccades_AOI_nose_conditions.png", viz_peak_velocity_entry_saccade_AOI_nose_Condition, width = 10, height = 8, dpi = 300)

 
 
``` 
###Metric 3: time to first fixation visualisations

time to 1st fixation; avg duration of fixation to aoi; total duration fixation aoi ; no of fixations 
time to first AOI fixation 

```{r}
#Metric3:time to first fixation

time_to_first_fixation_aoi <- metrics_demographics %>%
  filter(Media != "Entire Recording") %>%
  filter(Metric %in% c("Time_to_first_fixation.Background", 
                       "Time_to_first_fixation.Mouth", 
                       "Time_to_first_fixation.Nose", 
                       "Time_to_first_fixation.Eyes", 
                       "Time_to_first_fixation.Face",
                       "Time_to_first_fixation.Eye_1",
                       "Time_to_first_fixation.Eye_2")) %>%
    mutate(Metric = sub("Time_to_first_fixation.", "", Metric)) %>%
  mutate(Condition = factor(Condition, levels = order_of_conditions)) %>%
  distinct(Participant, Condition, Media, Neurodiverse, Metric, Value, .keep_all=TRUE)
time_to_first_fixation_aoi

#calculate min from eye_1 and eye_2 values
eye_sum_time_first_fixation_aoi <- time_to_first_fixation_aoi %>%
  filter(Metric %in% c("Eye_1",
                       "Eye_2")) %>%
  group_by(Participant, Media, Condition, Neurodiverse) %>%
  summarize(Value = min(Value, na.rm=TRUE)) %>%
  mutate(Metric = "Eyes") %>%
  ungroup()
time_to_first_fixation_aoi

#add back
time_to_first_fixation_aoi_final <- bind_rows(
  time_to_first_fixation_aoi %>%
    filter(!Metric %in% c("Eye_1", "Eye_2")),
  eye_sum_time_first_fixation_aoi
) %>%
  mutate(Media = factor(Media, levels = order_of_media))

View(time_to_first_fixation_aoi_final)

```

```{r}
time_first_fixation_AOI_avg <- time_to_first_fixation_aoi_final %>%
  group_by(Condition, Metric, Neurodiverse) %>%
  summarize(avg_first_fixation_saccades = mean(Value, na.rm = TRUE),
            sd_first_fixation_saccades = sd(Value, na.rm = TRUE)) %>%
  ungroup()
time_first_fixation_AOI_avg 

viz_time_first_fixation_AOI_bar<- ggplot(data = time_first_fixation_AOI_avg, aes(x = Condition, y = avg_first_fixation_saccades, fill=Neurodiverse)) +
  geom_bar(stat="identity", position = position_dodge(width = 0.9), size = 0.3) +
  geom_errorbar(aes(ymin = avg_first_fixation_saccades - sd_first_fixation_saccades, ymax = avg_first_fixation_saccades + sd_first_fixation_saccades),
                width = 0.2, position = position_dodge(width = 0.9)) +
  labs(title = "Average Time to First Fixation across AOIs",
       x = "AOI",
       y = "Average Time to First Fixation (ms) ") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1), 
        axis.title.y = element_text(margin = margin(r=20))) + #adds a space between the y title and the graphs no overlap
  facet_wrap(~ Metric, scales = "free_x")


print(viz_time_first_fixation_AOI_bar)
#ggsave("Average_time_first_fixation_across_aois_bar_metric.png", viz_time_first_fixation_AOI_bar, width = 12, height = 8, dpi = 300)

```



```{r}
viz_time_first_fixation_aoi_jitter_condition <- ggplot(data = time_to_first_fixation_aoi_final, aes(x = Condition, y = Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=2, alpha=0.5, position = position_jitterdodge(jitter.width = 0.3, dodge.width = 0.8),
              pch=21, stroke=0) +
  stat_summary(fun = median, geom = "crossbar", size = 0.3, position = position_dodge(width = 0.8), width=0.5, show.legend = FALSE)+
  scale_fill_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Time to first fixation per AOI",
       subtitle = "Comparison between Conditions",
       x = "AOI",
       y = "Time to First Fixation (ms)") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  #scale_y_continuous(limits = c(0,35)) +
  facet_wrap(~Metric, scales="free_x")#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_time_first_fixation_aoi_jitter_condition
#ggsave("time_to_first_fixation_aoi_condition_jitter.png", viz_time_first_fixation_aoi_jitter_condition, width = 12, height = 8, dpi = 300)


```
background
```{r}
time_to_first_fixation_aoi_background <- time_to_first_fixation_aoi_final %>%
  filter(Metric == "Background")
time_to_first_fixation_aoi_background

viz_time_to_first_fixation_aoi_background_Condition <- ggplot(data= time_to_first_fixation_aoi_background, aes(x=Condition, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.8),
              pch=21, stroke=0) +
  
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Time to First Fixation for Background per Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Condition",
       y= "Time to First Fixation (ms)") +
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  scale_y_continuous(limits=c(0, 12500)) #+
  #coord_flip()

viz_time_to_first_fixation_aoi_background_Condition
#ggsave("time_to_first_fixation_aoi_background_Condition.png", viz_time_to_first_fixation_aoi_background_Condition, width = 10, height = 8, dpi = 300)


```
eyes

```{r}
time_to_first_fixation_aoi_eyes <- time_to_first_fixation_aoi_final %>%
  filter(Metric == "Eyes")
time_to_first_fixation_aoi_eyes

viz_time_to_first_fixation_aoi_eyes_Condition <- ggplot(data= time_to_first_fixation_aoi_eyes, aes(x=Condition, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.8),
              pch=21, stroke=0) +
  
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Time to First Fixation for Eyes per Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Condition",
       y= "Time to First Fixation (ms)") +
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  scale_y_continuous(limits=c(0, 12500)) #+
  #coord_flip()

viz_time_to_first_fixation_aoi_eyes_Condition
#ggsave("time_to_first_fixation_aoi_eyes_Condition.png", viz_time_to_first_fixation_aoi_eyes_Condition, width = 10, height = 8, dpi = 300)



```
face

```{r}
time_to_first_fixation_aoi_face <- time_to_first_fixation_aoi_final %>%
  filter(Metric == "Face")
time_to_first_fixation_aoi_face

viz_time_to_first_fixation_aoi_face_Condition <- ggplot(data= time_to_first_fixation_aoi_face, aes(x=Condition, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.8),
              pch=21, stroke=0) +
  
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Time to First Fixation for Face per Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Condition",
       y= "Time to First Fixation (ms)") +
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  scale_y_continuous(limits=c(0, 12500)) #+
  #coord_flip()

viz_time_to_first_fixation_aoi_face_Condition
#ggsave("time_to_first_fixation_aoi_face_Condition.png", viz_time_to_first_fixation_aoi_face_Condition, width = 10, height = 8, dpi = 300)



```
mouth

```{r}
time_to_first_fixation_aoi_mouth <- time_to_first_fixation_aoi_final %>%
  filter(Metric == "Mouth")
time_to_first_fixation_aoi_mouth

viz_time_to_first_fixation_aoi_mouth_Condition <- ggplot(data= time_to_first_fixation_aoi_mouth, aes(x=Condition, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.7),
              pch=21, stroke=0) +
  
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Time to First Fixation for Mouth per Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Condition",
       y= "Time to First Fixation (ms)") +
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  scale_y_continuous(limits=c(0, 12500)) #+
  #coord_flip()

viz_time_to_first_fixation_aoi_mouth_Condition
#ggsave("time_to_first_fixation_aoi_mouth_Condition.png", viz_time_to_first_fixation_aoi_mouth_Condition, width = 10, height = 8, dpi = 300)



```
nose
```{r}
time_to_first_fixation_aoi_nose <- time_to_first_fixation_aoi_final %>%
  filter(Metric == "Nose")
time_to_first_fixation_aoi_nose

viz_time_to_first_fixation_aoi_nose_Condition <- ggplot(data= time_to_first_fixation_aoi_nose, aes(x=Condition, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.8),
              pch=21, stroke=0) +
  
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Time to First Fixation for Nose per Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Condition",
       y= "Time to First Fixation (ms)") +
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  scale_y_continuous(limits=c(0, 12500)) #+
  #coord_flip()

viz_time_to_first_fixation_aoi_nose_Condition
#ggsave("time_to_first_fixation_aoi_nose_Condition.png", viz_time_to_first_fixation_aoi_nose_Condition, width = 10, height = 8, dpi = 300)



```
###Metric 4: avg duration of fixations visualsiations 
metric 4
avg duration of fixation to aoi; total duration fixation aoi ; no of fixations

```{r}
#Metric 4: avg duration of fixations

avg_duration_fixation_aoi <- metrics_demographics %>%
  filter(Media != "Entire Recording") %>%
  filter(Metric %in% c("Average_duration_of_fixations.Background", 
                       "Average_duration_of_fixations.Mouth", 
                       "Average_duration_of_fixations.Nose", 
                       "Average_duration_of_fixations.Eyes", 
                       "Average_duration_of_fixations.Face",
                       "Average_duration_of_fixations.Eye_1",
                       "Average_duration_of_fixations.Eye_2")) %>%
    mutate(Metric = sub("Average_duration_of_fixations.", "", Metric)) %>%
  mutate(Condition = factor(Condition, levels = order_of_conditions)) %>%
  distinct(Participant, Condition, Media, Neurodiverse, Metric, Value, .keep_all=TRUE)
avg_duration_fixation_aoi

#calucalte eye mean using eye_1 and eye_2
eye_avg_duration_fixation_aoi <- avg_duration_fixation_aoi %>%
  filter(Metric %in% c("Eye_1",
                       "Eye_2")) %>%
  group_by(Participant, Media, Condition, Neurodiverse) %>%
  summarize(Value = mean(Value, na.rm=TRUE)) %>%
  mutate(Metric = "Eyes") %>%
  ungroup()
eye_avg_duration_fixation_aoi

#add back with other aois 
avg_duration_fixation_aoi_final <- bind_rows(
  avg_duration_fixation_aoi %>%
    filter(!Metric %in% c("Eye_1", "Eye_2")),
  eye_avg_duration_fixation_aoi
) %>%
  mutate(Media = factor(Media, levels = order_of_media))

View(avg_duration_fixation_aoi_final)


```

```{r}
viz_avg_duration_fixation_aoi_jitter_condition <- ggplot(data = avg_duration_fixation_aoi_final, aes(x = Condition, y = Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=2, alpha=0.5, position = position_jitterdodge(jitter.width = 0.3, dodge.width = 0.8),
              pch=21, stroke=0) +
  stat_summary(fun = median, geom = "crossbar", size = 0.3, position = position_dodge(width = 0.8), width=0.5, show.legend = FALSE)+
  scale_fill_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Average duration of fixations per AOI",
       subtitle = "Comparison between Conditions",
       x = "AOI",
       y = "Average duration of Fixations (ms)") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  #scale_y_continuous(limits = c(0,35)) +
  facet_wrap(~Metric, scales="free_x")#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_avg_duration_fixation_aoi_jitter_condition
#ggsave("avg_duration_fixation_aoi_condition_jitter.png", viz_avg_duration_fixation_aoi_jitter_condition, width = 12, height = 8, dpi = 300)


```
background
```{r}
avg_duration_fixation_aoi_background <- avg_duration_fixation_aoi_final %>%
  filter(Metric == "Background")
avg_duration_fixation_aoi_background

viz_avg_duration_fixation_aoi_background_Condition <- ggplot(data= avg_duration_fixation_aoi_background, aes(x=Condition, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.8),
              pch=21, stroke=0) +
  
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Average duration of Fixations for Background per Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Condition",
       y= "Average duration of fixations (ms)") +
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  scale_y_continuous(limits=c(0, 2500)) #+
  #coord_flip()

viz_avg_duration_fixation_aoi_background_Condition
#ggsave("avg_duration_fixation_aoi_background_Condition.png", viz_avg_duration_fixation_aoi_background_Condition, width = 10, height = 8, dpi = 300)


```
eyes
```{r}
avg_duration_fixation_aoi_eyes <- avg_duration_fixation_aoi_final %>%
  filter(Metric == "Eyes")
avg_duration_fixation_aoi_eyes

viz_avg_duration_fixation_aoi_eyes_Condition <- ggplot(data= avg_duration_fixation_aoi_eyes, aes(x=Condition, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.8),
              pch=21, stroke=0) +
  
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Average duration of Fixations for Eyes per Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Condition",
       y= "Average duration of fixations (ms)") +
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  scale_y_continuous(limits=c(0, 2500)) #+
  #coord_flip()

viz_avg_duration_fixation_aoi_eyes_Condition
#ggsave("avg_duration_fixation_aoi_eyes_Condition.png", viz_avg_duration_fixation_aoi_eyes_Condition, width = 10, height = 8, dpi = 300)

```
face
```{r}
avg_duration_fixation_aoi_face <- avg_duration_fixation_aoi_final %>%
  filter(Metric == "Face")
avg_duration_fixation_aoi_face

viz_avg_duration_fixation_aoi_face_Condition <- ggplot(data= avg_duration_fixation_aoi_face, aes(x=Condition, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.8),
              pch=21, stroke=0) +
  
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Average duration of Fixations for Face per Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Condition",
       y= "Average duration of fixations (ms)") +
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  scale_y_continuous(limits=c(0, 2500)) #+
  #coord_flip()

viz_avg_duration_fixation_aoi_face_Condition
#ggsave("avg_duration_fixation_aoi_face_Condition.png", viz_avg_duration_fixation_aoi_face_Condition, width = 10, height = 8, dpi = 300)


```
mouth
```{r}
avg_duration_fixation_aoi_mouth <- avg_duration_fixation_aoi_final %>%
  filter(Metric == "Mouth")
avg_duration_fixation_aoi_mouth

viz_avg_duration_fixation_aoi_mouth_Condition <- ggplot(data= avg_duration_fixation_aoi_mouth, aes(x=Condition, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.8),
              pch=21, stroke=0) +
  
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Average duration of Fixations for Mouth per Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Condition",
       y= "Average duration of fixations (ms)") +
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  scale_y_continuous(limits=c(0, 2500)) #+
  #coord_flip()

viz_avg_duration_fixation_aoi_mouth_Condition
#ggsave("avg_duration_fixation_aoi_mouth_Condition.png", viz_avg_duration_fixation_aoi_mouth_Condition, width = 10, height = 8, dpi = 300)


```
nose
```{r}
avg_duration_fixation_aoi_nose <- avg_duration_fixation_aoi_final %>%
  filter(Metric == "Nose")
avg_duration_fixation_aoi_nose

viz_avg_duration_fixation_aoi_nose_Condition <- ggplot(data= avg_duration_fixation_aoi_nose, aes(x=Condition, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.8),
              pch=21, stroke=0) +
  
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Average duration of Fixations for Nose per Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Condition",
       y= "Average duration of fixations (ms)") +
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  scale_y_continuous(limits=c(0, 2500)) #+
  #coord_flip()

viz_avg_duration_fixation_aoi_nose_Condition
#ggsave("avg_duration_fixation_aoi_nose_Condition.png", viz_avg_duration_fixation_aoi_nose_Condition, width = 10, height = 8, dpi = 300)


```
```{R}
avg_duration_fixation_AOI_bar <- avg_duration_fixation_aoi_final %>%
  group_by(Condition, Metric, Neurodiverse) %>%
  summarize(avg_duration_fixation=  mean(Value, na.rm = TRUE),
            sd_avg_duration_fixation = sd(Value, na.rm = TRUE)) %>%
  ungroup()
avg_duration_fixation_AOI_bar

viz_avg_duration_fixation_AOI_bar<- ggplot(data = avg_duration_fixation_AOI_bar, aes(x = Metric, y = avg_duration_fixation, fill=Neurodiverse)) +
  geom_bar(stat="identity", position = position_dodge(width = 0.9), size = 0.3) +
  geom_errorbar(aes(ymin = avg_duration_fixation - sd_avg_duration_fixation, ymax = avg_duration_fixation + sd_avg_duration_fixation),
                width = 0.2, position = position_dodge(width = 0.9)) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Average duration of Fixations across AOIs and conditions ",
       x = "AOI",
       y = "Average duration of Fixations (ms) ") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1), 
        axis.title.y = element_text(margin = margin(r=20))) + #adds a space between the y title and the graphs no overlap
  facet_wrap(~ Condition, scales = "free_x")


print(viz_avg_duration_fixation_AOI_bar)
#ggsave("Average_duration_fixation_across_aois_bar.png", viz_avg_duration_fixation_AOI_bar, width = 12, height = 8, dpi = 300)


```



###Metric 5: total duration fixation aoi visusliations 
Metric 5: total duration fixation aoi ; no of fixations
total duration fixation aoi 

```{r}
#Metric 5: total duration of fixations

total_duration_fixation_aoi <- metrics_demographics %>%
  filter(Media != "Entire Recording") %>%
  filter(Metric %in% c("Total_duration_of_fixations.Background", 
                       "Total_duration_of_fixations.Mouth", 
                       "Total_duration_of_fixations.Nose", 
                       "Total_duration_of_fixations.Eyes", 
                       "Total_duration_of_fixations.Face",
                       "Total_duration_of_fixations.Eye_1",
                       "Total_duration_of_fixations.Eye_2")) %>%
    mutate(Metric = sub("Total_duration_of_fixations.", "", Metric)) %>%
  mutate(Condition = factor(Condition, levels = order_of_conditions)) %>%
  distinct(Participant, Condition, Media, Neurodiverse, Metric, Value, .keep_all=TRUE)
total_duration_fixation_aoi

#calucalte sum of eye_1 and eye_2 per media per particioant 
eye_total_duration_fixation_aoi <- total_duration_fixation_aoi %>%
  filter(Metric %in% c("Eye_1",
                       "Eye_2")) %>%
  group_by(Participant, Media, Condition, Neurodiverse) %>%
  summarize(Value = sum(Value, na.rm=TRUE)) %>%
  mutate(Metric = "Eyes") %>%
  ungroup()
eye_total_duration_fixation_aoi

total_duration_fixation_aoi_final <- bind_rows(
  total_duration_fixation_aoi %>%
    filter(!Metric %in% c("Eye_1", "Eye_2")),
  eye_total_duration_fixation_aoi
) %>%
  mutate(Media = factor(Media, levels = order_of_media))

View(total_duration_fixation_aoi_final)



```

```{R}
viz_total_duration_fixation_aoi_jitter_condition <- ggplot(data = total_duration_fixation_aoi_final, aes(x = Condition, y = Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=2, alpha=0.5, position = position_jitterdodge(jitter.width = 0.3, dodge.width = 0.8),
              pch=21, stroke=0) +
  stat_summary(fun = median, geom = "crossbar", size = 0.3, position = position_dodge(width = 0.8), width=0.5, show.legend = FALSE)+
  scale_fill_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Total duration of fixations per AOI",
       subtitle = "Comparison between Conditions",
       x = "AOI",
       y = "Total duration of Fixations (ms)") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  #scale_y_continuous(limits = c(0,35)) +
  facet_wrap(~Metric, scales="free_x")#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_total_duration_fixation_aoi_jitter_condition
#ggsave("total_duration_fixation_aoi_condition_jitter.png", viz_total_duration_fixation_aoi_jitter_condition, width = 12, height = 8, dpi = 300)


```
background
```{r}
total_duration_fixation_aoi_background <- total_duration_fixation_aoi_final %>%
  filter(Metric == "Background")
total_duration_fixation_aoi_background

viz_total_duration_fixation_aoi_background_Condition <- ggplot(data= total_duration_fixation_aoi_background, aes(x=Condition, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.8),
              pch=21, stroke=0) +
  
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Total duration of Fixations for Background per Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Condition",
       y= "Total duration of fixations (ms)") +
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  scale_y_continuous(limits=c(0, 12000)) #+
  #coord_flip()

viz_total_duration_fixation_aoi_background_Condition
#ggsave("total_duration_fixation_aoi_background_Condition.png", viz_total_duration_fixation_aoi_background_Condition, width = 10, height = 8, dpi = 300)
```
eyes
```{r}
total_duration_fixation_aoi_eyes <- total_duration_fixation_aoi_final %>%
  filter(Metric == "Eyes")
total_duration_fixation_aoi_eyes

viz_total_duration_fixation_aoi_eyes_Condition <- ggplot(data= total_duration_fixation_aoi_eyes, aes(x=Condition, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.8),
              pch=21, stroke=0) +
  
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Total duration of Fixations for Eyes per Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Condition",
       y= "Total duration of fixations (ms)") +
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  scale_y_continuous(limits=c(0, 12000)) #+
  #coord_flip()

viz_total_duration_fixation_aoi_eyes_Condition
#ggsave("total_duration_fixation_aoi_eyes_Condition.png", viz_total_duration_fixation_aoi_eyes_Condition, width = 10, height = 8, dpi = 300)

```
face
```{r}
total_duration_fixation_aoi_face <- total_duration_fixation_aoi_final %>%
  filter(Metric == "Face")
total_duration_fixation_aoi_face

viz_total_duration_fixation_aoi_face_Condition <- ggplot(data= total_duration_fixation_aoi_face, aes(x=Condition, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.8),
              pch=21, stroke=0) +
  
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Total duration of Fixations for Face per Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Condition",
       y= "Total duration of fixations (ms)") +
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  scale_y_continuous(limits=c(0, 12000)) #+
  #coord_flip()

viz_total_duration_fixation_aoi_face_Condition
#ggsave("total_duration_fixation_aoi_face_Condition.png", viz_total_duration_fixation_aoi_face_Condition, width = 10, height = 8, dpi = 300)
```
mouth
```{r}
total_duration_fixation_aoi_mouth <- total_duration_fixation_aoi_final %>%
  filter(Metric == "Mouth")
total_duration_fixation_aoi_mouth

viz_total_duration_fixation_aoi_mouth_Condition <- ggplot(data= total_duration_fixation_aoi_mouth, aes(x=Condition, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.8),
              pch=21, stroke=0) +
  
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Total duration of Fixations for Mouth per Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Condition",
       y= "Total duration of fixations (ms)") +
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  scale_y_continuous(limits=c(0, 12000)) #+
  #coord_flip()

viz_total_duration_fixation_aoi_mouth_Condition
#ggsave("total_duration_fixation_aoi_mouth_Condition.png", viz_total_duration_fixation_aoi_mouth_Condition, width = 10, height = 8, dpi = 300)
```
nose
```{r}
total_duration_fixation_aoi_nose <- total_duration_fixation_aoi_final %>%
  filter(Metric == "Nose")
total_duration_fixation_aoi_nose

viz_total_duration_fixation_aoi_nose_Condition <- ggplot(data= total_duration_fixation_aoi_nose, aes(x=Condition, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.8),
              pch=21, stroke=0) +
  
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Total duration of Fixations for Nose per Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Condition",
       y= "Total duration of fixations (ms)") +
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  scale_y_continuous(limits=c(0, 12000)) #+
  #coord_flip()

viz_total_duration_fixation_aoi_nose_Condition
#ggsave("total_duration_fixation_aoi_nose_Condition.png", viz_total_duration_fixation_aoi_nose_Condition, width = 10, height = 8, dpi = 300)


```

```{r}
avg_total_duration_fixation_AOI_bar <- total_duration_fixation_aoi_final %>%
  group_by(Condition, Metric, Neurodiverse) %>%
  summarize(avg_total_duration_fixation=  mean(Value, na.rm = TRUE),
            sd_total_duration_fixation = sd(Value, na.rm = TRUE)) %>%
  ungroup()
avg_total_duration_fixation_AOI_bar

viz_avg_total_duration_fixation_AOI_bar<- ggplot(data = avg_total_duration_fixation_AOI_bar, aes(x = Metric, y = avg_total_duration_fixation, fill=Neurodiverse)) +
  geom_bar(stat="identity", position = position_dodge(width = 0.9), size = 0.3) +
  geom_errorbar(aes(ymin = avg_total_duration_fixation - sd_total_duration_fixation, ymax = avg_total_duration_fixation + sd_total_duration_fixation),
                width = 0.2, position = position_dodge(width = 0.9)) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Average Total duration of Fixations across Conditions",
       x = "AOI",
       y = "Average Total duration of Fixations (ms) ") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1), 
        axis.title.y = element_text(margin = margin(r=20))) + #adds a space between the y title and the graphs no overlap
  facet_wrap(~ Condition, scales = "free_x")


print(viz_avg_total_duration_fixation_AOI_bar)
#ggsave("total_duration_fixation_across_aois_bar.png", viz_avg_total_duration_fixation_AOI_bar, width = 12, height = 8, dpi = 300)

```

#Metric 6: number of fixations visualisations
Metric 6: no of fixations

```{r}
#Metric 6: Number of fixations 


no_fixation_aoi <- metrics_demographics %>%
  filter(Media != "Entire Recording") %>%
  filter(Metric %in% c("Number_of_fixations.Background", 
                       "Number_of_fixations.Mouth", 
                       "Number_of_fixations.Nose", 
                       "Number_of_fixations.Eyes", 
                       "Number_of_fixations.Face",
                       "Number_of_fixations.Eye_1",
                       "Number_of_fixations.Eye_2")) %>%
    mutate(Metric = sub("Number_of_fixations.", "", Metric)) %>%
  mutate(Condition = factor(Condition, levels = order_of_conditions)) %>%
  distinct(Participant, Condition, Media, Neurodiverse, Metric, Value, .keep_all=TRUE)
no_fixation_aoi

#eye sum of eye_1 and eye_2
eye_no_fixation_aoi <- no_fixation_aoi %>%
  filter(Metric %in% c("Eye_1",
                       "Eye_2")) %>%
  group_by(Participant, Media, Condition, Neurodiverse) %>%
  summarize(Value = sum(Value, na.rm=TRUE)) %>%
  mutate(Metric = "Eyes") %>%
  ungroup()
eye_no_fixation_aoi

#combine
no_fixation_aoi_final <- bind_rows(
  no_fixation_aoi %>%
    filter(!Metric %in% c("Eye_1", "Eye_2")),
  eye_no_fixation_aoi
) %>%
  mutate(Media = factor(Media, levels = order_of_media))

View(no_fixation_aoi_final)



```
```{r}
viz_no_fixation_aoi_jitter_condition <- ggplot(data = no_fixation_aoi_final, aes(x = Condition, y = Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=2, alpha=0.5, position = position_jitterdodge(jitter.width = 0.3, dodge.width = 0.8),
              pch=21, stroke=0) +
  stat_summary(fun = median, geom = "crossbar", size = 0.3, position = position_dodge(width = 0.8), width=0.5, show.legend = FALSE)+
  scale_fill_manual(values = c("Yes"= "blue", "No"= "red")) +
  labs(title = "Number of fixations per AOI",
       subtitle = "Comparison between Conditions",
       x = "AOI",
       y = "Number of Fixations") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  #scale_y_continuous(limits = c(0,35)) +
  facet_wrap(~Metric, scales="free_x")#+
  #coord_flip() #FLIPS X AND Y AXIS 

viz_no_fixation_aoi_jitter_condition
#ggsave("no_fixation_aoi_condition_jitter.png", viz_no_fixation_aoi_jitter_condition, width = 12, height = 8, dpi = 300)


```
background
```{r}
no_fixation_aoi_background <- no_fixation_aoi_final %>%
  filter(Metric == "Background")
no_fixation_aoi_background

viz_no_fixation_aoi_background_Condition <- ggplot(data= no_fixation_aoi_background, aes(x=Condition, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.8),
              pch=21, stroke=0) +
  
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Number of Fixations for Background per Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Condition",
       y= "Number of fixations") +
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  scale_y_continuous(limits=c(0, 40)) #+
  #coord_flip()

viz_no_fixation_aoi_background_Condition
#ggsave("no_fixation_aoi_background_Condition.png", viz_no_fixation_aoi_background_Condition, width = 10, height = 8, dpi = 300)
```
eyes
```{r}
no_fixation_aoi_eyes <- no_fixation_aoi_final %>%
  filter(Metric == "Eyes")
no_fixation_aoi_eyes

viz_no_fixation_aoi_eyes_Condition <- ggplot(data= no_fixation_aoi_eyes, aes(x=Condition, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.8),
              pch=21, stroke=0) +
  
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Number of Fixations for Eyes per Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Condition",
       y= "Number duration of fixations") +
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  scale_y_continuous(limits=c(0, 40)) #+
  #coord_flip()

viz_no_fixation_aoi_eyes_Condition
#ggsave("no_fixation_aoi_eyes_Condition.png", viz_no_fixation_aoi_eyes_Condition, width = 10, height = 8, dpi = 300)

```
face
```{r}
no_fixation_aoi_face <- no_fixation_aoi_final %>%
  filter(Metric == "Face")
no_fixation_aoi_face

viz_no_fixation_aoi_face_Condition <- ggplot(data= no_fixation_aoi_face, aes(x=Condition, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.8),
              pch=21, stroke=0) +
  
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Number of Fixations for Face per Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Condition",
       y= "Number of fixations") +
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  scale_y_continuous(limits=c(0, 40)) #+
  #coord_flip()

viz_no_fixation_aoi_face_Condition
#ggsave("no_fixation_aoi_face_Condition.png", viz_no_fixation_aoi_face_Condition, width = 10, height = 8, dpi = 300)
```
mouth
```{r}
no_fixation_aoi_mouth <- no_fixation_aoi_final %>%
  filter(Metric == "Mouth")
no_fixation_aoi_mouth

viz_no_fixation_aoi_mouth_Condition <- ggplot(data= no_fixation_aoi_mouth, aes(x=Condition, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.8),
              pch=21, stroke=0) +
  
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Number of Fixations for Mouth per Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Condition",
       y= "Number duration of fixations") +
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  scale_y_continuous(limits=c(0, 40)) #+
  #coord_flip()

viz_no_fixation_aoi_mouth_Condition
#ggsave("no_fixation_aoi_mouth_Condition.png", viz_no_fixation_aoi_mouth_Condition, width = 10, height = 8, dpi = 300)
```
nose
```{r}
no_fixation_aoi_nose <- no_fixation_aoi_final %>%
  filter(Metric == "Nose")
no_fixation_aoi_nose

viz_no_fixation_aoi_nose_Condition <- ggplot(data= no_fixation_aoi_nose, aes(x=Condition, y=Value, fill=Neurodiverse)) +
  geom_jitter(aes(color=Neurodiverse), size=3, alpha=0.5, position= position_jitterdodge(jitter.width = 0.2,
                                                                              dodge.width = 0.8),
              pch=21, stroke=0) +
  
  stat_summary(fun=median, geom="crossbar",
               position=position_dodge(width = 0.7),
               width=0.4, size=0.3,
               show.legend = FALSE) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Number of Fixations for Nose per Condition",
       subtitle = "Comparison of Neurodiverse and Neurotypical groups",
       x= "Condition",
       y= "Number of fixations") +
  theme(axis.text.x = element_text(angle=45, hjust=1))+
  scale_y_continuous(limits=c(0, 40)) #+
  #coord_flip()

viz_no_fixation_aoi_nose_Condition
#ggsave("no_fixation_aoi_nose_Condition.png", viz_no_fixation_aoi_nose_Condition, width = 10, height = 8, dpi = 300)



```
```{r}
avg_no_fixation_AOI_bar <- no_fixation_aoi_final %>%
  group_by(Condition, Metric, Neurodiverse) %>%
  summarize(avg_no_fixation=  mean(Value, na.rm = TRUE),
            sd_avg_no_fixation = sd(Value, na.rm = TRUE)) %>%
  ungroup()
avg_no_fixation_AOI_bar

viz_avg_no_fixation_AOI_bar<- ggplot(data = avg_no_fixation_AOI_bar, aes(x = Metric, y = avg_no_fixation, fill=Neurodiverse)) +
  geom_bar(stat="identity", position = position_dodge(width = 0.9), size = 0.3) +
  geom_errorbar(aes(ymin = avg_no_fixation - sd_avg_no_fixation, ymax = avg_no_fixation + sd_avg_no_fixation),
                width = 0.2, position = position_dodge(width = 0.9)) +
  scale_fill_manual(values = c("Yes" = "blue", "No" = "red")) + 
  labs(title = "Average Number of Fixations across AOIs",
       x = "AOI",
       y = "Average Number of Fixations (ms) ") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1), 
        axis.title.y = element_text(margin = margin(r=20))) + #adds a space between the y title and the graphs no overlap
  facet_wrap(~ Condition, scales = "free_x")


print(viz_avg_no_fixation_AOI_bar)
#ggsave("Average_no_fixation_across_aois_bar.png", viz_avg_no_fixation_AOI_bar, width = 12, height = 8, dpi = 300)


```


#ANOVA 

okay so basically the features are based on the list i have from previous literature and based on visualizations SO create features and add to df 

so have been reading about anovas and need to make sure the independent and dependent variables are organised correctly which they are in long format !

TESTING THE MAIN INTERACTION BETWEEN CONDITION AND GROUP AS WELL AS INTERACTIONS BETWEEN GROUPS IE interaction between levels of abstractness and neurodiversity or not and then WITHIN will say how they interact in each group so how does ND affect Very abstract etc

i need to build the features 
independent:
feature 1: level of abstractness (Condition) --> 5 LEVELS
feature 2: Neurodiverse or Neurotypical (Neurodiverse) --> 2 LEVELS

dependent: (10)
saccades (5) : no of saccades; avg amplitude of saccades; total amplitude of saccades; max amplitude of saccades; maximum peak velocity of saccades
 
fixation (5) : number of fixations, avg duration of fixations; total duration of fixations; proportion of total fixation duration (condition); time to first fixation 
 
(add later can do as three way anova) AOI: no of saccades; peak velocity of entry saccades; time to 1st fixation; no of fixations; avg duration of fixation to aoi; total duration fixation,  proportion of time looking at AOI and proportional fixation time based on AOIs 

okay so seems i can just filter and prepare like i did for the visualisations and then run the anova? so let me check how i do normality checks and varaiance etc for anovas

```{r}
#so first lets seperate all metrics into one new df 

anova_data_metrics <- metrics_demographics %>%
  filter(Condition != "Entire Recording") %>%
  filter(Metric %in% c("Number_of_saccades", "Average_amplitude_of_saccades", "Total_amplitude_of_saccades", "Maximum_amplitude_of_saccades",
                       "Maximum_peak_velocity_of_saccades", 
                       "Number_of_fixations.Background",
                       "Number_of_fixations.Eyes",
                       "Number_of_fixations.Eye_1",
                       "Number_of_fixations.Eye_2",
                       "Number_of_fixations.Face",
                       "Number_of_fixations.Mouth",
                       "Number_of_fixations.Nose",
                       "Number_of_fixations.Nose_2",
                       "Average_duration_of_fixations.Background",
                       "Average_duration_of_fixations.Eye_1",
                       "Average_duration_of_fixations.Eye_2",
                       "Average_duration_of_fixations.Eyes",
                       "Average_duration_of_fixations.Face",
                       "Average_duration_of_fixations.Mouth",
                       "Average_duration_of_fixations.Nose",
                       "Average_duration_of_fixations.Nose_2",
                       "Total_duration_of_fixations.Background",
                       "Total_duration_of_fixations.Eye_1",
                       "Total_duration_of_fixations.Eye_2",
                       "Total_duration_of_fixations.Eyes",
                       "Total_duration_of_fixations.Face",
                       "Total_duration_of_fixations.Mouth",
                       "Total_duration_of_fixations.Nose",
                       "Total_duration_of_fixations.Nose_2",
                       "Time_to_first_fixation.Background",
                       "Time_to_first_fixation.Eye_1",
                       "Time_to_first_fixation.Eye_2",
                       "Time_to_first_fixation.Eyes",
                       "Time_to_first_fixation.Face",
                       "Time_to_first_fixation.Mouth",
                       "Time_to_first_fixation.Nose",
                       "Time_to_first_fixation.Nose_2")) %>%
mutate(Condition = factor(Condition, levels = order_of_conditions),
          Neurodiverse = factor(Neurodiverse, levels = c("No", "Yes")))

View(anova_data_metrics)
unique(anova_data_metrics$Metric)
```
okay so now calculate the fixation metrics and add into df 
```{r}
#built before so just copied and pasted and adjusted 

# Number of Fixations
no_fixations <- no_fixations_all %>%
  distinct(Participant, Media, Condition, Neurodiverse, Metric, .keep_all = TRUE) %>%
  group_by(Participant, Media, Condition, Neurodiverse) %>%
  summarize(Value = sum(Value, na.rm = TRUE)) %>%
  mutate(Metric = "Total Number of Fixations") %>%
  ungroup()

```

```{r}
# Average Duration of Fixations
avg_duration_fixations <- avg_duration_fixations_all %>%
  distinct(Participant, Media, Condition, Neurodiverse, Metric, .keep_all = TRUE) %>%
  group_by(Participant, Media, Condition, Neurodiverse) %>%
  summarize(Value = mean(Value, na.rm = TRUE)) %>%
  mutate(Metric = "Average Duration of Fixations") %>%
  ungroup()

```
```{r}

# Total Duration of Fixations
total_duration_fixations <- total_duration_fixations_all %>%
  distinct(Participant, Media, Condition, Neurodiverse, Metric, .keep_all = TRUE) %>%
  group_by(Participant, Media, Condition, Neurodiverse) %>%
  summarize(Value = sum(Value, na.rm = TRUE)) %>%
  mutate(Metric = "Total Duration of Fixations") %>%
  ungroup()

```
```{r}

# Time to First Fixation
time_first_fixations <- time_first_fixations_all %>%
  distinct(Participant, Media, Condition, Neurodiverse, Metric, .keep_all = TRUE) %>%
  group_by(Participant, Media, Condition, Neurodiverse) %>%
  summarize(Value = min(Value, na.rm = TRUE)) %>%
  mutate(Metric = "Time to First Fixation") %>%
  ungroup()
```

```{r}

# Proportion of Total Fixation Duration
total_fixation_entire_recording <- total_duration_fixations %>%
  group_by(Participant) %>%
  summarize(Total_Fixation_Entire = sum(Value, na.rm = TRUE))

fixation_duration_proportion <- total_duration_fixations %>%
  left_join(total_fixation_entire_recording, by = "Participant") %>%
  mutate(Value = (Value / Total_Fixation_Entire) * 100) %>%
  select(Participant, Media, Condition, Value, Neurodiverse) %>%
  mutate(Metric = "Proportion of Total Fixation Duration") %>%
  distinct()

```

```{r}

all_fixation_metrics <- bind_rows(no_fixations, avg_duration_fixations, total_duration_fixations, time_first_fixations, fixation_duration_proportion)
all_fixation_metrics

#combine with anova_data_metrics
anova_data_metrics_all <- bind_rows(anova_data_metrics, all_fixation_metrics)
print(anova_data_metrics_all)
View(anova_data_metrics_all)

```

```{r}
unique(anova_data_metrics_all$Metric)
```
```{r}
anova_data_metrics_all <- anova_data_metrics_all %>%
  mutate(participant_id_num = as.numeric(sub("Participant ", "", Participant))) %>%
  arrange(participant_id_num) %>%
  select(-participant_id_num)
unique(anova_data_metrics_all$Participant)
View(anova_data_metrics_all)
```

```{r}
#reorder neseccary columns 
anova_data_metrics_all <- anova_data_metrics_all %>%
  select(Participant, Neurodiverse, Media, Condition, Metric, Value, everything())

View(anova_data_metrics_all)
anova_data_metrics_all
```

```{r}
anova_data_metrics_all <- anova_data_metrics_all %>%
  mutate(Media = factor(Media, levels = c("Realistic image 1", "Realistic image 2", "Realistic image 3", "Realistic image 4", "Realistic image 5","Portrait Painting 1", "Portrait Painting 2", "Portrait Painting 3", "Portrait Painting 4", "Portrait Painting 5","Semi-abstract 1", "Semi-abstract 2", "Semi-abstract 3", "Semi-abstract 4", "Semi-abstract 5", "Abstract 1", "Abstract 3", "Abstract 4", "Abstract 5", "Abstract 6", "Very Abstract 1", "Very Abstract 2", "Very Abstract 3", "Very Abstract 4", "Very Abstract 5")),
         Condition = factor(Condition, levels = c("Realistic image", "Portrait Painting", "Semi-abstract", "Abstract", "Very Abstract")))
anova_data_metrics_all <- anova_data_metrics_all %>%
  arrange(Participant, Media, Condition) #now arranged in order of abstractness for media and condition

anova_data_metrics_all
View(anova_data_metrics_all)
```
make them into factors for anova 
```{r}
anova_data_metrics_all$Condition <- as.factor(anova_data_metrics_all$Condition)
anova_data_metrics_all$Neurodiverse <- as.factor(anova_data_metrics_all$Neurodiverse)
anova_data_metrics_all$Participant <- as.factor(anova_data_metrics_all$Participant)

```

```{r}
install.packages("tidyverse")
install.packages("ggpubr")
install.packages("rstatix")
install.packages("car")
install.packages("afex")
```

```{r}
library(tidyverse)
library(ggpubr)
library(rstatix)
library(car)
library(afex)

```
okay so first need to group 
is a mixed anova with 1 repeated factor (condition) and 1 independent (neurodiverse)

```{r}
#Normality p>0.05 => OK
anova_data_metrics_all  %>%
  group_by(Condition, Neurodiverse)
```
dependent: 
saccades (*main focus) : no of saccades; avg amplitude of saccades; total amplitude of saccades; max amplitude of saccades; maximum peak velocity of saccades
 
fixation: number of fixations, avg duration of fixations; total duration of fixations; proportion of total fixation duration (condition); time to first fixation 

###metric 1 anova 
only metric that is with a pararmetric anova 

```{r}
#number of saccades 
no_saccades_anova <- anova_data_metrics_all %>%
  filter(Metric== "Number_of_saccades") %>%
  select(c(Participant, Neurodiverse, Media, Condition, Metric, Value)) %>%
  distinct(Participant, Neurodiverse, Media, Condition, Metric, Value)

no_saccades_anova %>%
  group_by(Condition, Neurodiverse)

no_saccades_anova
```

```{R}
str(no_saccades_anova)
```
```{r}
no_saccades_anova %>%
  group_by(Condition, Neurodiverse) %>%
  get_summary_stats(Value, type = "mean_sd")

```
check normality assumptions
```{r}
options(scipen=(999)) #makes sure no decimals appear with e-10 etc
no_saccades_anova %>%
  group_by(Condition, Neurodiverse) %>%
  shapiro_test(Value)

```
so of the 10 groups need to be p > 0.05
so all but semi-abstract / No ;  so 9/10 groups meet normality check of shapiro wilks test 

```{r}
ggqqplot(no_saccades_anova, "Value", ggtheme = theme_bw()) +
  facet_grid(Neurodiverse ~ Condition, labeller = "label_both")
```
```{r}
bxp_m1 <- ggboxplot(
  no_saccades_anova, x = "Condition", y = "Value",
  color = "Neurodiverse", palette = "jco"
  )
bxp_m1

```
```{r}
library(rstatix)
no_saccades_anova%>%
  group_by(Condition, Neurodiverse) %>%
  identify_outliers(Value)

```
5/24 participants --> 1 ND across 3 conditions are considered outliers 
is outliers but not extreme 

```{r}
 #check homoscedascity 
leveneTest(Value ~ Neurodiverse*Condition, data = no_saccades_anova)

```
not signifcant 
```{r}
install.packages("car")
```

```{r}
library(car)
```

```{r}
install.packages("ez")
library(ez)
```

so using a paramertic anova 
```{r}
# Running the mixed ANOVA 
aov_results <- aov_ez("Participant", 
                      "Value", 
                      data = no_saccades_anova,
                      between = "Neurodiverse",
                      within = "Condition",
                      detailed = TRUE)
# Summary of the ANOVA
summary(aov_results)

```
NOT SIGNIFCANT MAIN EFFECTS OR INTERACTIONS 
does not meet assumption of sphericity but all others met, automatically applies greenhouse geisser corrections

```{r}
#ANOTHER PARAMETRIC ANOVA USING AOV - SHOWS THE SAME RESULTS
m1 <- aov(Value ~ Condition * Neurodiverse + Error(Participant/Condition),
  data = no_saccades_anova) 
summary(m1)

```
dont need to do pairwise comparisons as nothing is signficant but just want to test it !
```{r}
# comparisons for MAIN effect variables THIS IS UNNESSECARY AS NOT SIGNIFICANT
no_saccades_anova %>%
  pairwise_t_test(
    Value ~ Condition, paired = TRUE, 
    p.adjust.method = "holm"
    )

```

THIS MEASURE IS NOT SIGNIFICANT --> CONDITION, NEURODIVERSE AND INTERACTION DO NOT HAVE SIG IMPACT ON THIS METRIC


##METRIC 2 ANOVA 
Metric 2: Average amplitude of saccades 

SO BASICALLY DO THE SAME AS FOR THE OTHERS BUT CHECK ASSUMPTIONS ALSO --> IF DOESTN MEET VERY STRONGLY THEN CONSIDER NON PARAMETRIC 
```{r}
#aVERAGE AMP OF SACCADES 
avg_amp_saccades_anova <- anova_data_metrics_all %>%
  filter(Metric== "Average_amplitude_of_saccades") %>%
 # select(c(Participant, Neurodiverse, Media, Condition, Metric, Value)) %>%
  distinct(Participant, Neurodiverse, Media, Condition, Metric, Value)

avg_amp_saccades_anova %>%
  group_by(Condition, Neurodiverse)
str(avg_amp_saccades_anova)

```

ASSUMPTIONS 
```{R}
avg_amp_saccades_anova %>%
  group_by(Condition, Neurodiverse) %>%
  get_summary_stats(Value, type = "mean_sd")


```
```{r}
avg_amp_saccades_anova %>%
  group_by(Condition, Neurodiverse) %>%
  shapiro_test(Value)

```
3 GROUPS SIGNIFICANT AND 5 ARE NOT SO MAJORITY MEETS NORMALITY 

```{R}
ggqqplot(avg_amp_saccades_anova, "Value", ggtheme = theme_bw()) +
  facet_grid(Neurodiverse ~ Condition, labeller = "label_both")

```
abstract/no is quite bad, 

```{R}
bxp_m2 <- ggboxplot(
  avg_amp_saccades_anova, x = "Condition", y = "Value",
  color = "Neurodiverse", palette = "jco"
  )
bxp_m2

```
```{r}
avg_amp_saccades_anova%>%
  group_by(Condition, Neurodiverse) %>%
  identify_outliers(Value)

```
does have extreme outlier mainly abstract/no is the issue


```{r}
leveneTest(Value ~ Neurodiverse*Condition, data = avg_amp_saccades_anova)

```
DOES NOT MEET LEVENES, SOME NORMALITY MET AND HAS OUTLIERS 

SO NON PARAMETRIC TESTING 

```{R}
install.packages("ARTool")
library(ARTool)
```

```{R}
#art anova (np) type 3 mixed effects 
model_m2 = art(Value ~ Condition*Neurodiverse + (1|Participant),
               data = avg_amp_saccades_anova)
model_m2
result_1<-anova(model_m2)
result_1$part.eta.sq = with(result_1, `F` * `Df` / (`F` * `Df` + `Df.res`)) #ADDS PARTIAL ETA SQUARED FOR EFFECT SIZE
result_1

#Check the normality of residuals CAN IGNORE THATS THE REASON WHY WE DID ART ANOVA ANYWAY 
shapiro.test(residuals(model_m2))
qqnorm(residuals(model_m2)); qqline(residuals(model_m2), col = "red")


```
CONDITION AND INTERACTION SIGNIFICANT 

### POSTHOCS USING EMMEANS m2

```{r}
install.packages("emmeans")
library(emmeans)
posthoc<-contrast(emmeans(artlm.con(model_m2, "Condition"), ~ Condition), method = "pairwise", adjust = "holm")
posthoc
```
ri va sig 0.0006 ; pp va <.0001 sa va 0.0141 and ab va <.0001

```{r}
#interaction USE ARTLM FOR INTERACTIONS 
mean_lf3<-emmeans(artlm(model_m2, "Condition:Neurodiverse"), pairwise ~Neurodiverse:Condition)
mean_lf3
con <-contrast(mean_lf3, interaction=TRUE, adjust="holm")
con


```
 realsitic no and yes are less than 0.5 but no pairwise are significant 

Signif. codes:   0 * * *  0.001 * *  0.01 * 0.05 . 0.1   1

CAN PLOT THE SIGNIFCANT CONDITIONS DETERMINED BY POSTHOCS (THIS IS NOT INTERACTION THIS IS THE MAIN EFFECT OF CONDITION) AS ND NOT SIG COMBINE INTO ONE BOXPLOT PER CONDITION
```{r}
#visualisations
# df with sig and p-values ADDING MANUALLY AS NP TEST
m2_pvalues <- data.frame(
  group1 = c("Realistic image", "Portrait Painting", "Abstract"),
  group2 = c("Very Abstract", "Very Abstract", "Very Abstract"),
  p.adj = c("**", "***", "***"),
  y.position = c(10, 9.5, 9)
)

anova_m2_bp <- ggplot(avg_amp_saccades_anova, aes(x = Condition, y = Value)) +
  geom_boxplot(fill="grey", outlier.shape = NA) +
  geom_jitter(size=3, alpha=0.4, color="blue", width = 0.25) +
  labs(x = "Condition", y = "Average Amplitude of Saccades") +
  scale_y_continuous(limits = c(0, 10)) +
  stat_pvalue_manual(
    m2_pvalues, 
    label = "p.adj", 
    xmin = "group1", 
    xmax = "group2",
    y.position = "y.position", 
    tip.length = 0.01,
    bracket.size = 0.5  # little hooks at the end of the lines
  )
anova_m2_bp
  
#ggsave("avg_amp_saccades_anova_condition_sig.png", anova_m2_bp, width = 12, height = 8, dpi = 300)
```

#metric 3 anova
metric 3: total amplitude of saccades

```{r}
#total AMP OF SACCADES 
total_amp_saccades_anova <- anova_data_metrics_all %>%
  filter(Metric== "Total_amplitude_of_saccades") %>%
  #select(c(Participant, Neurodiverse, Media, Condition, Metric, Value)) %>%
  distinct(Participant, Neurodiverse, Media, Condition, Metric, Value)

total_amp_saccades_anova %>%
  group_by(Condition, Neurodiverse)

```

```{r}
total_amp_saccades_anova %>%
  group_by(Condition, Neurodiverse) %>%
  get_summary_stats(Value, type = "mean_sd")

```
```{r}
#NORMALITY ASSUMPTION
total_amp_saccades_anova %>%
  group_by(Condition, Neurodiverse) %>%
  shapiro_test(Value)

```
bit of a mix --> 4 are sig BASICALLY HALF 
```{r}
ggqqplot(total_amp_saccades_anova, "Value", ggtheme = theme_bw()) +
  facet_grid(Neurodiverse ~ Condition, labeller = "label_both")

```

```{r}

bxp_m3 <- ggboxplot(
  total_amp_saccades_anova, x = "Condition", y = "Value",
  color = "Neurodiverse", palette = "jco"
  )
bxp_m3
```
```{r}
total_amp_saccades_anova %>%
  group_by(Condition, Neurodiverse) %>%
  identify_outliers(Value)

```
not extreme but some outliers primarily for no condition and participant 11

```{r}
leveneTest(Value ~ Neurodiverse*Condition, data = total_amp_saccades_anova)
#is significant
```
so only partially meets noramlity, not levenes + outliers 
np testing !!
```{R}
#mixed effects art anova NP type 3
model3.1 = art(Value ~ Condition*Neurodiverse + (1|Participant), #error(participant) gave same results here 
               data = total_amp_saccades_anova)
m3.1<- anova(model3.1)
m3.1$part.eta.sq = with(m3.1, `F` * `Df` / (`F` * `Df` + `Df.res`)) #ADDS PARTIAL ETA SQUARED FOR EFFECT SIZE
m3.1

#Check the normality of residuals
shapiro.test(residuals(model3.1))
qqnorm(residuals(model3.1)); qqline(residuals(model3.1), col = "red")
```

###posthoc m3
```{r}
#Post-Hoc: Main effects can be tested with emmeans and contrasts
#Main effect con
post_hoc_3.1<-emmeans(artlm(model3.1, "Condition"), ~Condition)
post_hoc_3.1
contrast(post_hoc_3.1, method="pairwise", adjust="holm")

```
ri and va very sig; pp va sa va and ab va ALL VERY ABSTRACT VS OTHER CONDITIONS

INTERACTION 
```{R}
# Interaction effect of Condition and Neurodiverse
post_hoc3.3 <- emmeans(artlm(model3.1, "Condition:Neurodiverse"), pairwise~Condition*Neurodiverse)
post_hoc3.3
contrast(post_hoc3.3, interaction = TRUE, adjust = "holm")

```
RI/NO; RI/YES only ones sig 
not actually signifcant when investigating deeper 

visualisations now for main effect of condition as signficant 

 Realistic image - Very Abstract       -49.89 14.5 568  -3.430  0.0052 *
 Portrait Painting - Very Abstract     -68.78 14.5 568  -4.728  <.0001 ***
 (Semi-abstract) - Very Abstract       -47.90 14.5 568  -3.293  0.0074 *
 Abstract - Very Abstract              -60.98 14.5 568  -4.192  0.0003 ***
Signif. codes:   0 ** *  0.001 * *  0.01 * 0.05 . 0.1   1 

```{R}
#visualisation of sig conditions 
# df with sig and p-values ADDING MANUALLY AS NP TEST
m3_pvalues <- data.frame(
  group1 = c("Realistic image", "Portrait Painting", "Semi-abstract", "Abstract"),
  group2 = c("Very Abstract", "Very Abstract", "Very Abstract", "Very Abstract"),
  p.adj = c("*", "***", "*", "***"),
  y.position = c(270, 260, 250, 240)
)

anova_m3_bp <- ggplot(total_amp_saccades_anova, aes(x = Condition, y = Value)) +
  geom_boxplot(fill="grey", outlier.shape = NA) +
  geom_jitter(size=3, alpha=0.4, color="blue", width = 0.25) +
  labs(x = "Condition", y = "Total Amplitude of Saccades") +
  scale_y_continuous(limits = c(0, 270)) +
  stat_pvalue_manual(
    m3_pvalues, 
    label = "p.adj", 
    xmin = "group1", 
    xmax = "group2",
    y.position = "y.position", 
    tip.length = 0.02
  )
anova_m3_bp
  
#ggsave("total_amp_saccades_anova_condition_sig.png", anova_m3_bp, width = 12, height = 8, dpi = 300)
```


#METRIC 4 ANOVA 
metric 4 anova: max amplitude of saccades

```{r}
#max amp of saccades 
max_amp_saccades_anova <- anova_data_metrics_all %>%
  filter(Metric== "Maximum_amplitude_of_saccades") %>%
  #select(c(Participant, Neurodiverse, Media, Condition, Metric, Value)) %>%
  distinct(Participant, Neurodiverse, Media, Condition, Metric, Value)

max_amp_saccades_anova %>%
  group_by(Condition, Neurodiverse)
```

assumptions 
```{R}
max_amp_saccades_anova %>%
  group_by(Condition, Neurodiverse) %>%
  get_summary_stats(Value, type = "mean_sd")

```

```{r}
#normality checks 
max_amp_saccades_anova %>%
  group_by(Condition, Neurodiverse) %>%
  shapiro_test(Value)

```
all significant so does not meet normality

```{R}
ggqqplot(max_amp_saccades_anova, "Value", ggtheme = theme_bw()) +
  facet_grid(Neurodiverse ~ Condition, labeller = "label_both")

```
very clearly has some extreme outliers lets check 

```{r}
bxp_m4 <- ggboxplot(
  max_amp_saccades_anova, x = "Condition", y = "Value",
  color = "Neurodiverse", palette = "jco"
  )
bxp_m4
```

```{r}
#outliers
max_amp_saccades_anova %>%
  group_by(Condition, Neurodiverse) %>%
  identify_outliers(Value)

```
lots of outliers
 with 4 extreme outliers 
 
```{r}
#levenes
leveneTest(Value ~ Neurodiverse*Condition, data = max_amp_saccades_anova)
#is not significant
```
not significant levenes 

run NP anova as no other assumptions met other than levenes

```{r}
#mixed effects anova NP type 3
model4.1 = art(Value ~ Condition*Neurodiverse + (1|Participant),
               data = max_amp_saccades_anova)
m4.1<- anova(model4.1)
m4.1$part.eta.sq = with(m4.1, `F` * `Df` / (`F` * `Df` + `Df.res`)) #ADDS PARTIAL ETA SQUARED FOR EFFECT SIZE
m4.1

#Check the normality of residuals
shapiro.test(residuals(model4.1))
qqnorm(residuals(model4.1)); qqline(residuals(model4.1), col = "red")
```

condition sig and c*nd sig ; nd not signifcant 

###posthoc metric 4
```{r}
# Main effect of Condition
posthoc_4.1 <- emmeans(artlm.con(model4.1, "Condition"), pairwise~Condition)
contrast(posthoc_4.1, method = "pairwise", adjust = "holm")
```
only signifcant ones are RI and VA ; and

```{r}
# Interaction
posthoc_4.3 <- emmeans(artlm(model4.1, "Condition:Neurodiverse"), pairwise~ Neurodiverse*Condition)
posthoc_4.3
contrast(posthoc_4.3, interaction = TRUE, adjust = "holm")


```
ri/n/y only near sig, none sig 

 contrast                            estimate   SE  df t.ratio p.value
 
 Realistic image - Very Abstract       -56.74 16.2 568  -3.507  0.0049 *
Signif. codes:   0 ***  0.001 **  0.01 * 0.05 . 0.1   1 

visualsiation of condition as main effect 
```{r}
#visualisation of sig conditions 
# df with sig and p-values ADDING MANUALLY AS NP TEST
m4_pvalues <- data.frame(
  group1 = c("Realistic image"),
  group2 = c("Very Abstract"),
  p.adj = c("*"),
  y.position = c(50)
)

anova_m4_bp <- ggplot(max_amp_saccades_anova, aes(x = Condition, y = Value)) +
  geom_boxplot(fill="grey", outlier.shape = NA) +
  geom_jitter(size=3, alpha=0.4, color="blue", width = 0.25) +
  labs(x = "Condition", y = "Maximum Amplitude of Saccades") +
  scale_y_continuous(limits = c(0, 50)) +
  stat_pvalue_manual(
    m4_pvalues, 
    label = "p.adj", 
    xmin = "group1", 
    xmax = "group2",
    y.position = "y.position", 
    tip.length = 0.02
  )
anova_m4_bp
  
#ggsave("max_amp_saccades_anova_condition_sig.png", anova_m4_bp, width = 12, height = 8, dpi = 300)

```

###METRIC 5 anova

METRIC 5: max peak velocity of saccades

```{r}
#max peak velocity of saccades 
max_peak_velocity_saccades_anova <- anova_data_metrics_all %>%
  filter(Metric== "Maximum_peak_velocity_of_saccades") %>%
  #select(c(Participant, Neurodiverse, Media, Condition, Metric, Value)) %>%
  distinct(Participant, Neurodiverse, Media, Condition, Metric, Value)

max_peak_velocity_saccades_anova %>%
  group_by(Condition, Neurodiverse)

```

assumptions 
```{R}
max_peak_velocity_saccades_anova %>%
  group_by(Condition, Neurodiverse) %>%
  get_summary_stats(Value, type = "mean_sd")

```

```{r}
#normality
max_peak_velocity_saccades_anova %>%
  group_by(Condition, Neurodiverse) %>%
  shapiro_test(Value)

```
p>0.05
semi/no ; ab/no; are significant rest arent 

```{R}
ggqqplot(max_peak_velocity_saccades_anova, "Value", ggtheme = theme_bw()) +
  facet_grid(Neurodiverse ~ Condition, labeller = "label_both")

```


```{r}
bxp_m5 <- ggboxplot(
  max_peak_velocity_saccades_anova, x = "Condition", y = "Value",
  color = "Neurodiverse", palette = "jco"
  )
bxp_m5
```

```{r}
#outliers
max_peak_velocity_saccades_anova %>%
  group_by(Condition, Neurodiverse) %>%
  identify_outliers(Value)

```
7 outliers with 1 extreme outlier (semi abstract/no)
 
```{r}
leveneTest(Value ~ Neurodiverse*Condition, data = max_peak_velocity_saccades_anova)
#is significant
```
so levenes sign, shapiro 2/10 sig, 1 extreme outlier and 6 outliers so NP

```{r}
#mixed effects anova NP type 3 ARTnova
model5.1 = art(Value ~ Condition*Neurodiverse + (1|Participant),
               data = max_peak_velocity_saccades_anova)
m5.1<- anova(model5.1)
m5.1$part.eta.sq = with(m5.1, `F` * `Df` / (`F` * `Df` + `Df.res`)) #ADDS PARTIAL ETA SQUARED FOR EFFECT SIZE
m5.1

#Check the normality of residuals
shapiro.test(residuals(model5.1))
qqnorm(residuals(model5.1)); qqline(residuals(model5.1), col = "red")
```

condition sig and c*nd sig , nd still not significant 

###posthoc metric 5
```{r}
# Main effect of Condition
posthoc_5.1 <- emmeans(artlm.con(model5.1, "Condition"), ~Condition)
contrast(posthoc_5.1, method = "pairwise", adjust = "holm")
```
ab va sig

```{r}
# Interaction
posthoc_5.3 <- emmeans(artlm(model5.1, "Condition:Neurodiverse"), pairwise~Neurodiverse*Condition)
posthoc_5.3 #fix
contrast(posthoc_5.3, interaction = TRUE, adjust = "holm")

```
pairwise interactions show no interactions are signficant 

contrast                            estimate   SE  df t.ratio p.value
 Abstract - Very Abstract              -58.75 16.2 568  -3.620  0.0032 *
 Signif. codes:   0 ***  0.001  **  0.01 * 0.05 . 0.1   1 

visaulisation of condition main effect posthocs 
```{r}
# df with sig and p-values ADDING MANUALLY AS NP TEST
m5_pvalues <- data.frame(
  group1 = c("Abstract"),
  group2 = c("Very Abstract"),
  p.adj = c("*"),
  y.position = c(940)
)

anova_m5_bp <- ggplot(max_peak_velocity_saccades_anova, aes(x = Condition, y = Value)) +
  geom_boxplot(fill="grey", outlier.shape = NA) +
  geom_jitter(size=3, alpha=0.4, color="blue", width = 0.25) +
  labs(x = "Condition", y = "Max Peak Velocity of Saccades") +
  scale_y_continuous(limits = c(100, 950)) +
  stat_pvalue_manual(
    m5_pvalues, 
    label = "p.adj", 
    xmin = "group1", 
    xmax = "group2",
    y.position = "y.position", 
    tip.length = 0.02
  )
anova_m5_bp
  
#ggsave("max_peak_velocity_saccades_anova_condition_sig.png", anova_m5_bp, width = 12, height = 8, dpi = 300)
```


###METRIC 6: FIXATION : NO OF FIXATIONS 

```{r}
#NO of fixations
no_fixations_anova <- anova_data_metrics_all %>%
  filter(Metric== "Total Number of Fixations") %>%
  #select(c(Participant, Neurodiverse, Media, Condition, Metric, Value)) %>%
  distinct(Participant, Neurodiverse, Media, Condition, Metric, Value)

no_fixations_anova %>%
  group_by(Condition, Neurodiverse)

```

assumptions 
```{R}
no_fixations_anova %>%
  group_by(Condition, Neurodiverse) %>%
  get_summary_stats(Value, type = "mean_sd")

```

```{r}
#normality checks
no_fixations_anova %>%
  group_by(Condition, Neurodiverse) %>%
  shapiro_test(Value)

```
p>0.05 6/10 significant !

```{R}
ggqqplot(no_fixations_anova, "Value", ggtheme = theme_bw()) +
  facet_grid(Neurodiverse ~ Condition, labeller = "label_both")

```
has some very clear extreme outliers 

```{r}
bxp_m6 <- ggboxplot(
  no_fixations_anova, x = "Condition", y = "Value",
  color = "Neurodiverse", palette = "jco"
  )
bxp_m6
```

```{r}
#outliers
no_fixations_anova %>%
  group_by(Condition, Neurodiverse) %>%
  identify_outliers(Value)

```
20 outliers with 9 extreme outlier (very abstract and semi abstract primarily )
 
```{r}
leveneTest(Value ~ Neurodiverse*Condition, data = no_fixations_anova)
#is significant
```
so doesnt meet normality, has outliers 2/5 and doesnt meet homgeneity 
so NP testing !

```{r}
#mixed effects anova NP type 3 ARTnova
model6.1 = art(Value ~ Condition*Neurodiverse + (1|Participant),
               data = no_fixations_anova)
m6.1<- anova(model6.1)
m6.1$part.eta.sq = with(m6.1, `F` * `Df` / (`F` * `Df` + `Df.res`)) #ADDS PARTIAL ETA SQUARED FOR EFFECT SIZE
m6.1

#Check the normality of residuals
shapiro.test(residuals(model6.1))
qqnorm(residuals(model6.1)); qqline(residuals(model6.1), col = "red")
```
condition as main effect very sig 

###posthoc for metric 6  
```{r}
# Main effect of Condition
posthoc_6.1 <- emmeans(artlm(model6.1, "Condition"), ~Condition)
posthoc_6.1
contrast(posthoc_6.1, method = "pairwise", adjust = "holm")
```
ri and va sig ; sa va and ab and va sig 
SIGNIFICANT PAIRWISE CONDITIONS:

Realistic image - Very Abstract      -115.17 16.2 568  -7.092  <.0001 ***
Portrait Painting - Very Abstract    -107.10 16.2 568  -6.594  <.0001 ***
(Semi-abstract) - Very Abstract      -123.33 16.2 568  -7.594  <.0001 ***
Abstract - Very Abstract             -128.06 16.2 568  -7.885  <.0001 ***

Signif. codes:   0 ***  0.001 **  0.01 * 0.05 . 0.1   1 

visualization OF MAIN EFFECT OF CONDITION
```{r}
# df with sig and p-values ADDING MANUALLY AS NP TEST
m6_pvalues <- data.frame(
  group1 = c( "Realistic image", "Portrait Painting", "Semi-abstract", "Abstract"),
  group2 = c("Very Abstract", "Very Abstract", "Very Abstract", "Very Abstract"),
  p.adj = c("***", "***", "***", "***"),
  y.position = c(80, 77, 73.5, 70)
)

anova_m6_bp <- ggplot(no_fixations_anova, aes(x = Condition, y = Value)) +
  geom_boxplot(fill="grey", outlier.shape = NA) +
  geom_jitter(size=3, alpha=0.4, color="blue", width = 0.25) +
  labs(x = "Condition", y = "Number of fixations") +
  scale_y_continuous(limits = c(0, 80)) +
  stat_pvalue_manual(
    m6_pvalues, 
    label = "p.adj", 
    xmin = "group1", 
    xmax = "group2",
    y.position = "y.position", 
    tip.length = 0.02
  )
anova_m6_bp
  
#ggsave("no_fixations_anova_condition_sig.png", anova_m6_bp, width = 12, height = 8, dpi = 300)
```

running posthoc on interaction also but not really necessary here as not really sig (.)
```{r}
# Interaction
posthoc_6.3 <- emmeans(artlm(model6.1, "Condition:Neurodiverse"), pairwise ~Neurodiverse*Condition)
posthoc_6.3
contrast(posthoc_6.3, interaction = TRUE, adjust = "holm")

```
none are signifcant (which was seen in anova)

#METRIC 7 ANOVA
metric 7: avg duratiin of fixations 

```{r}
#avg duration of fixations
avg_duration_fixations_anova <- anova_data_metrics_all %>%
  filter(Metric== "Average Duration of Fixations") %>%
  #select(c(Participant, Neurodiverse, Media, Condition, Metric, Value)) %>%
  distinct(Participant, Neurodiverse, Media, Condition, Metric, Value)

avg_duration_fixations_anova %>%
  group_by(Condition, Neurodiverse)

```

assumptions 
```{R}
avg_duration_fixations_anova %>%
  group_by(Condition, Neurodiverse) %>%
  get_summary_stats(Value, type = "mean_sd")

```

```{r}
#normality
avg_duration_fixations_anova %>%
  group_by(Condition, Neurodiverse) %>%
  shapiro_test(Value)

```
p>0.05 all significant !

```{R}
ggqqplot(avg_duration_fixations_anova, "Value", ggtheme = theme_bw()) +
  facet_grid(Neurodiverse ~ Condition, labeller = "label_both")

```
not normal AT ALL VERY DIFFERENT ESP NO/PP AND NO/SA

```{r}
bxp_m7 <- ggboxplot(
  avg_duration_fixations_anova, x = "Condition", y = "Value",
  color = "Neurodiverse", palette = "jco"
  )
bxp_m7
```

```{r}
#outliers
avg_duration_fixations_anova %>%
  group_by(Condition, Neurodiverse) %>%
  identify_outliers(Value)

```
60 outliers with lots of extreme outlier (across all conditions )
 
```{r}
leveneTest(Value ~ Neurodiverse*Condition, data = avg_duration_fixations_anova)
#is not significant
```
not significant 

lots of outliers and not normal at all, but homogenous,
so NP
```{r}
#mixed effects anova NP type 3 ARTnova
model7.1 = art(Value ~ Condition*Neurodiverse + (1|Participant),
               data = avg_duration_fixations_anova)
m7.1<-anova(model7.1)
m7.1$part.eta.sq = with(m7.1, `F` * `Df` / (`F` * `Df` + `Df.res`)) #ADDS PARTIAL ETA SQUARED FOR EFFECT SIZE
m7.1

#Check the normality of residuals
shapiro.test(residuals(model7.1))
qqnorm(residuals(model7.1)); qqline(residuals(model7.1), col = "red")
```

no main effects or interaction significant 

posthoc (unnecessary here) but running for fun
```{r}
# Main effect of Condition
posthoc_7.1 <- emmeans(artlm.con(model7.1, "Condition"), ~Condition)
contrast(posthoc_7.1, method = "pairwise", adjust = "holm")
```

```{r}
# Interaction
posthoc_7.3 <- emmeans(artlm(model7.1, "Condition:Neurodiverse"), pairwise~ Neurodiverse:Condition)
posthoc_7.3
contrast(posthoc_7.3, interaction = TRUE, adjust = "holm")

```
not significant at all (we knew this)

###METRIC 8 ANOVA

METRIC 8: total duration of fixations 

```{r}
#total duration of fixations
total_duration_fixations_anova <- anova_data_metrics_all %>%
  filter(Metric== "Total Duration of Fixations") %>%
  #select(c(Participant, Neurodiverse, Media, Condition, Metric, Value)) %>%
  distinct(Participant, Neurodiverse, Media, Condition, Metric, Value)

total_duration_fixations_anova %>%
  group_by(Condition, Neurodiverse)

```

assumptions 
```{R}
total_duration_fixations_anova %>%
  group_by(Condition, Neurodiverse) %>%
  get_summary_stats(Value, type = "mean_sd")

```

```{r}
#normality
total_duration_fixations_anova %>%
  group_by(Condition, Neurodiverse) %>%
  shapiro_test(Value)

```
p>0.05 2/10 are significant 

```{R}
ggqqplot(total_duration_fixations_anova, "Value", ggtheme = theme_bw()) +
  facet_grid(Neurodiverse ~ Condition, labeller = "label_both")

```
only VA issues 

```{r}
bxp_m8 <- ggboxplot(
  total_duration_fixations_anova, x = "Condition", y = "Value",
  color = "Neurodiverse", palette = "jco"
  )
bxp_m8
```

```{r}
#outliers
total_duration_fixations_anova %>%
  group_by(Condition, Neurodiverse) %>%
  identify_outliers(Value)

```
14 outliers with 2 extreme outliers ( va) most outliers are va 
 
```{r}
leveneTest(Value ~ Neurodiverse*Condition, data = total_duration_fixations_anova)
#is significant
```
very sig levenes 

so this one does not meet levenes, partially meets normality (8/10) and has 14 outliers with only 2 extreme 

try running a non parametric anova  
```{r}
#mixed effects anova NP type 3 ARTnova
model8.2 = art(Value ~ Condition*Neurodiverse + (1|Participant),
               data = total_duration_fixations_anova)
m8.2<- anova(model8.2)
m8.2$part.eta.sq = with(m8.2, `F` * `Df` / (`F` * `Df` + `Df.res`)) #ADDS PARTIAL ETA SQUARED FOR EFFECT SIZE
m8.2

#Check the normality of residuals
shapiro.test(residuals(model8.2))
qqnorm(residuals(model8.2)); qqline(residuals(model8.2), col = "red")
```
condition very  significant  but no other main/interaction effects 

### posthoc metric 8
```{r}
# Main effect of Condition
posthoc_8.2 <- emmeans(artlm.con(model8.2, "Condition"), ~Condition)
contrast(posthoc_8.2, method = "pairwise", adjust = "holm")
```
so signifcant differences between RI VA; PP VA;PP AB;SA VA; AB VA

Signif. codes:   0 ***  0.001 **  0.01 * 0.05 . 0.1   1 


 Realistic image - Very Abstract       -101.7 17.5 568  -5.817  <.0001 ***
 Portrait Painting - Abstract            57.8 17.5 568   3.308  0.0060 *
 Portrait Painting - Very Abstract      -79.1 17.5 568  -4.523  0.0001 ***
 (Semi-abstract) - Very Abstract       -132.8 17.5 568  -7.596  <.0001 ***
 Abstract - Very Abstract              -136.9 17.5 568  -7.830  <.0001 ***
 
 visualisations

```{R}
# df with sig and p-values ADDING MANUALLY AS NP TEST
m8_pvalues <- data.frame(
  group1 = c( "Realistic image", "Portrait Painting", "Portrait Painting", "Semi-abstract", "Abstract"),
  group2 = c("Very Abstract", "Abstract", "Very Abstract", "Very Abstract", "Very Abstract"),
  p.adj = c("***", "*", "***", "***", "***"),
  y.position = c(19500, 12500, 18750, 18150, 17500)
)


anova_m8_bp <- ggplot(total_duration_fixations_anova, aes(x = Condition, y = Value)) +
  geom_boxplot(fill="grey", outlier.shape = NA) +
  geom_jitter(size=3, alpha=0.4, color="blue", width = 0.25) +
  labs(x = "Condition", y = "Total duration of Fixations (ms)") +
  #scale_y_continuous(limits = c(0, 80)) +
  stat_pvalue_manual(
    m8_pvalues, 
    label = "p.adj", 
    xmin = "group1", 
    xmax = "group2",
    y.position = "y.position", 
    tip.length = 0.02
  )
anova_m8_bp
  
#ggsave("total_duration_fixations_anova_condition_sig.png", anova_m8_bp, width = 12, height = 8, dpi = 300)
```

###metric 9 anova

metric 9: time to first fixation 

```{r}
#time to first fixation
time_to_first_fixation_anova <- anova_data_metrics_all %>%
  filter(Metric== "Time to First Fixation") %>%
  #select(c(Participant, Neurodiverse, Media, Condition, Metric, Value)) %>%
  distinct(Participant, Neurodiverse, Media, Condition, Metric, Value)

time_to_first_fixation_anova %>%
  group_by(Condition, Neurodiverse)

```

assumptions 
```{R}
time_to_first_fixation_anova %>%
  group_by(Condition, Neurodiverse) %>%
  get_summary_stats(Value, type = "mean_sd")

```

```{r}
#NORMALITY
time_to_first_fixation_anova %>%
  group_by(Condition, Neurodiverse) %>%
  shapiro_test(Value)

```
p>0.05 all are very very significant 

```{R}
ggqqplot(time_to_first_fixation_anova, "Value", ggtheme = theme_bw()) +
  facet_grid(Neurodiverse ~ Condition, labeller = "label_both")

```
definitely do not adhere to qqplot normality very obvious from shapiro 

```{r}
bxp_m9 <- ggboxplot(
  time_to_first_fixation_anova, x = "Condition", y = "Value",
  color = "Neurodiverse", palette = "jco"
  )
bxp_m9
```

```{r}
#OUTLIERS
time_to_first_fixation_anova %>%
  group_by(Condition, Neurodiverse) %>%
  identify_outliers(Value)

```
63 outliers with majority extreme --> all conditions
 
```{r}
leveneTest(Value ~ Neurodiverse*Condition, data = time_to_first_fixation_anova)
#is significant
```
so doesnt meet any assumptions so non parametric anova !

```{r}
#mixed effects anova NP type 3 ARTnova
model9.1 = art(Value ~ Condition*Neurodiverse + (1|Participant),
               data = time_to_first_fixation_anova)
m9.1<- anova(model9.1)
m9.1$part.eta.sq = with(m9.1, `F` * `Df` / (`F` * `Df` + `Df.res`)) #ADDS PARTIAL ETA SQUARED FOR EFFECT SIZE
m9.1

#Check the normality of residuals
shapiro.test(residuals(model9.1))
qqnorm(residuals(model9.1)); qqline(residuals(model9.1), col = "red")
```
not signficant metric condition is close to being significant to .01 

posthoc (unnecessary here) but running anyway
```{r}
# Main effect of Condition
posthoc_9.1 <- emmeans(artlm.con(model9.1, "Condition"), ~Condition)
contrast(posthoc_9.1, method = "pairwise", adjust = "holm")
```
RA SA close to being significant


###Metric 10 anova 

metric 10: proportion of total fixation duration

```{r}
#proprotuon of total fixation duration 
proportion_total_fixation_anova <- anova_data_metrics_all %>%
  filter(Metric== "Proportion of Total Fixation Duration") %>%
  #select(c(Participant, Neurodiverse, Media, Condition, Metric, Value)) %>%
  distinct(Participant, Neurodiverse, Media, Condition, Metric, Value)

proportion_total_fixation_anova %>%
  group_by(Condition, Neurodiverse)

```

assumptions 
```{R}
proportion_total_fixation_anova %>%
  group_by(Condition, Neurodiverse) %>%
  get_summary_stats(Value, type = "mean_sd")

```

```{r}
#normality
proportion_total_fixation_anova %>%
  group_by(Condition, Neurodiverse) %>%
  shapiro_test(Value)

```
p>0.05 4/10 are significant --> sa/no; ab/y; va/n; va/y

```{R}
ggqqplot(proportion_total_fixation_anova, "Value", ggtheme = theme_bw()) +
  facet_grid(Neurodiverse ~ Condition, labeller = "label_both")

```
very abstract definitely do not adhere to qqplot normality very obvious from shapiro also
need to look at distibution and outliers 

```{r}
bxp_m10 <- ggboxplot(
  proportion_total_fixation_anova, x = "Condition", y = "Value",
  color = "Neurodiverse", palette = "jco"
  )
bxp_m10
```

```{r}
#outlierse
proportion_total_fixation_anova %>%
  group_by(Condition, Neurodiverse) %>%
  identify_outliers(Value)

```
29 outliers with 8 extreme --> all conditions majority very abstract (expected)
 
```{r}
leveneTest(Value ~ Neurodiverse*Condition, data = proportion_total_fixation_anova)
#is very significant
```
so doesnt meet levenes (homogeneity), but has most groups meting normailty assumptions, with 29 outliers and 8 extreme could do robust anova but non paramteric art anova probabyl work better

```{R}
#mixed effects anova NP type 3 ARTnova
model10.1 = art(Value ~ Condition*Neurodiverse + (1|Participant),
               data = proportion_total_fixation_anova)
m10.1<- anova(model10.1)
m10.1$part.eta.sq = with(m10.1, `F` * `Df` / (`F` * `Df` + `Df.res`)) #ADDS PARTIAL ETA SQUARED FOR EFFECT SIZE
m10.1

#Check the normality of residuals
shapiro.test(residuals(model10.1))
qqnorm(residuals(model10.1)); qqline(residuals(model10.1), col = "red")
```

CONDITION significant 

###posthoc metric 10
(only condition necessary here)
```{r}
# Main effect of Condition
posthoc_10.1 <- emmeans(artlm.con(model10.1, "Condition"), ~Condition)
contrast(posthoc_10.1, method = "pairwise", adjust = "holm")
```
all significant except ri vs pp; ri vs sa; ri vs ab; sa vs ab (6/10 possibilities are sig) 


 Realistic image - Very Abstract      -122.86 21.1 568  -5.828  <.0001 ***
 Portrait Painting - (Semi-abstract)    68.90 21.1 568   3.268  0.0057 *
 Portrait Painting - Abstract           75.75 21.1 568   3.593  0.0021 *
 Portrait Painting - Very Abstract     -93.23 21.1 568  -4.422  0.0001 ***
 (Semi-abstract) - Very Abstract      -162.13 21.1 568  -7.690  <.0001 ***
 Abstract - Very Abstract             -168.98 21.1 568  -8.015  <.0001 ***
 
Signif. codes:   0 ***  0.001 **  0.01 * 0.05 . 0.1   1

```{r}
# df with sig and p-values ADDING MANUALLY AS NP TEST
m10_pvalues <- data.frame(
  group1 = c( "Realistic image", "Portrait Painting", "Portrait Painting", "Portrait Painting", "Semi-abstract", "Abstract"),
  group2 = c("Very Abstract", "Semi-abstract", "Abstract", "Very Abstract", "Very Abstract", "Very Abstract"),
  p.adj = c("***", "*", "*", "***", "***", "***"),
  y.position = c(10.5, 6.75, 7.5, 10, 9.5, 9)
)


anova_m10_bp <- ggplot(proportion_total_fixation_anova, aes(x = Condition, y = Value)) +
  geom_boxplot(fill="grey", outlier.shape = NA) +
  geom_jitter(size=3, alpha=0.4, color="blue", width = 0.25) +
  labs(x = "Condition", y = "Proportion of Total duration of Fixations (ms)") +
  #scale_y_continuous(limits = c(0, 80)) +
  stat_pvalue_manual(
    m10_pvalues, 
    label = "p.adj", 
    xmin = "group1", 
    xmax = "group2",
    y.position = "y.position", 
    tip.length = 0.02
  )
anova_m10_bp
  
#ggsave("proportion_total_duration_fixations_anova_condition_sig.png", anova_m10_bp, width = 12, height = 8, dpi = 300)
```

anova done for fixation and saccade metrics !!
now onto AOI three way anovas 

#AOI Anova 
for aoi adjust p values across every condition

AOI (6): no of saccades; peak velocity of entry saccades; time to 1st fixation; no of fixations; avg duration of fixation to aoi; total duration fixation,  proportion of time looking at AOI and proportional fixation time based on AOIs 

```{r}
aoi_anova_data_metrics <- metrics_demographics %>%
  filter(Condition != "Entire Recording") %>%
  filter(Metric %in% c("Number_of_saccades_in_AOI.Background",
                       "Number_of_saccades_in_AOI.Eyes",
                       "Number_of_saccades_in_AOI.Eye_1",
                       "Number_of_saccades_in_AOI.Eye_2",
                       "Number_of_saccades_in_AOI.Face",
                       "Number_of_saccades_in_AOI.Mouth",
                       "Number_of_saccades_in_AOI.Nose",
                       "Peak_velocity_of_entry_saccade.Background",
                       "Peak_velocity_of_entry_saccade.Eyes",
                       "Peak_velocity_of_entry_saccade.Eye_1",
                       "Peak_velocity_of_entry_saccade.Eye_2",
                       "Peak_velocity_of_entry_saccade.Face",
                       "Peak_velocity_of_entry_saccade.Mouth",
                       "Peak_velocity_of_entry_saccade.Nose",
                       "Time_to_first_fixation.Background",
                       "Time_to_first_fixation.Eyes",
                       "Time_to_first_fixation.Eye_1",
                       "Time_to_first_fixation.Eye_2",
                       "Time_to_first_fixation.Face",
                       "Time_to_first_fixation.Mouth",
                       "Time_to_first_fixation.Nose",
                       "Number_of_fixations.Background",
                       "Number_of_fixations.Eyes",
                       "Number_of_fixations.Eye_1",
                       "Number_of_fixations.Eye_2",
                       "Number_of_fixations.Face",
                       "Number_of_fixations.Mouth",
                       "Number_of_fixations.Nose",
                       "Average_duration_of_fixations.Background",
                       "Average_duration_of_fixations.Eyes",
                       "Average_duration_of_fixations.Eye_1",
                       "Average_duration_of_fixations.Eye_2",
                       "Average_duration_of_fixations.Face",
                       "Average_duration_of_fixations.Mouth",
                       "Average_duration_of_fixations.Nose",
                       "Total_duration_of_fixations.Background",
                       "Total_duration_of_fixations.Eyes",
                       "Total_duration_of_fixations.Eye_1",
                       "Total_duration_of_fixations.Eye_2",
                       "Total_duration_of_fixations.Face",
                       "Total_duration_of_fixations.Mouth",
                       "Total_duration_of_fixations.Nose")) %>%
mutate(Condition = factor(Condition, levels = order_of_conditions),
          Neurodiverse = factor(Neurodiverse, levels = c("No", "Yes")))

View(aoi_anova_data_metrics)
unique(aoi_anova_data_metrics$Metric)

```

now can do anovas 

```{r}
#reorder participants as not in order 
aoi_anova_data_metrics <- aoi_anova_data_metrics %>%
  mutate(participant_id_num = as.numeric(sub("Participant ", "", Participant))) %>%
  arrange(participant_id_num) %>%
  select(-participant_id_num)
unique(aoi_anova_data_metrics$Participant)

```

```{r}
#reorder neseccary columns 
aoi_anova_data_metrics <- aoi_anova_data_metrics %>%
  select(Participant, Neurodiverse, Media, Condition, Metric, Value, everything()) 

```

```{r}
#put in order of abstraness
aoi_anova_data_metrics <- aoi_anova_data_metrics %>%
  mutate(Media = factor(Media, levels = c("Realistic image 1", "Realistic image 2", "Realistic image 3", "Realistic image 4", "Realistic image 5","Portrait Painting 1", "Portrait Painting 2", "Portrait Painting 3", "Portrait Painting 4", "Portrait Painting 5","Semi-abstract 1", "Semi-abstract 2", "Semi-abstract 3", "Semi-abstract 4", "Semi-abstract 5", "Abstract 1", "Abstract 3", "Abstract 4", "Abstract 5", "Abstract 6", "Very Abstract 1", "Very Abstract 2", "Very Abstract 3", "Very Abstract 4", "Very Abstract 5")),
         Condition = factor(Condition, levels = c("Realistic image", "Portrait Painting", "Semi-abstract", "Abstract", "Very Abstract")))

aoi_anova_data_metrics_final <- aoi_anova_data_metrics %>%
  arrange(Participant, Media, Condition) #now arranged in order of abstractness for media and condition

aoi_anova_data_metrics_final
unique(aoi_anova_data_metrics_final$Media)
```
make them into factors for anova 
```{r}
#aoi_anova_data_metrics_final$Condition <- as.factor(aoi_anova_data_metrics_final$Condition)
#aoi_anova_data_metrics_final$Neurodiverse <- as.factor(aoi_anova_data_metrics_final$Neurodiverse)
#aoi_anova_data_metrics_final$Participant <- as.factor(aoi_anova_data_metrics_final$Participant)

```

```{R}
View(aoi_anova_data_metrics_final)
```



AOI: no of saccades; peak velocity of entry saccades; time to 1st fixation; no of fixations; avg duration of fixation to aoi; total duration fixation

###creating the eye aois for each of the aoi metrics

so lets do the eyes for each metric
```{r}
#Metric 1: number of saccades
no_saccades_AOI_anova <- aoi_anova_data_metrics_final %>%
  filter(Metric %in% c("Number_of_saccades_in_AOI.Background", 
                       "Number_of_saccades_in_AOI.Mouth", 
                       "Number_of_saccades_in_AOI.Nose", 
                       "Number_of_saccades_in_AOI.Eyes", 
                       "Number_of_saccades_in_AOI.Face",
                       "Number_of_saccades_in_AOI.Eye_1",
                       "Number_of_saccades_in_AOI.Eye_2")) %>%
  distinct(Participant, Condition, Media, Neurodiverse, Metric, Value, .keep_all=TRUE)
View(no_saccades_AOI_anova)

#calculate number of saccades for eye aoi by combining eye_1 and eye_2 values 
eye_sum_no_saccade_aoi_anova <- no_saccades_AOI_anova %>%
  filter(Metric %in% c("Number_of_saccades_in_AOI.Eye_1",
                       "Number_of_saccades_in_AOI.Eye_2")) %>%
  group_by(Participant, Media, Condition, Neurodiverse) %>%
  summarize(Value = sum(Value, na.rm=TRUE)) %>%
  mutate(Metric = "Number_of_saccades_in_AOI.Eyes") %>%
  ungroup()
View(eye_sum_no_saccade_aoi_anova)

no_saccades_AOI_anova_final <- bind_rows(no_saccades_AOI_anova, eye_sum_no_saccade_aoi_anova)
View(no_saccades_AOI_anova_final)
```

```{R}
#Metric 2: Peak Velocity of Entry saccade
peak_velocity_entry_saccades_aoi_anova <- aoi_anova_data_metrics_final %>%
  filter(Metric %in% c("Peak_velocity_of_entry_saccade.Background", 
                       "Peak_velocity_of_entry_saccade.Mouth", 
                       "Peak_velocity_of_entry_saccade.Nose", 
                       "Peak_velocity_of_entry_saccade.Eyes", 
                       "Peak_velocity_of_entry_saccade.Face",
                       "Peak_velocity_of_entry_saccade.Eye_1",
                       "Peak_velocity_of_entry_saccade.Eye_2")) %>%
  distinct(Participant, Condition, Media, Neurodiverse, Metric, Value, .keep_all=TRUE)
peak_velocity_entry_saccades_aoi_anova

#eye_1 and eye_2 combined to make eye per media 
eye_sum_velocity_entry_aoi_anova <- peak_velocity_entry_saccades_aoi_anova %>%
  filter(Metric %in% c("Peak_velocity_of_entry_saccade.Eye_1",
                       "Peak_velocity_of_entry_saccade.Eye_2")) %>%
  group_by(Participant, Media, Condition, Neurodiverse) %>%
  summarize(Value = max(Value, na.rm=TRUE)) %>%
  mutate(Metric = "Peak_velocity_of_entry_saccade.Eyes") %>%
  ungroup()
eye_sum_velocity_entry_aoi_anova

peak_velocity_entry_saccade_aoi_anova <- bind_rows(
  peak_velocity_entry_saccades_aoi, eye_sum_velocity_entry_aoi) %>%
  mutate(Media = factor(Media, levels = order_of_media))

View(peak_velocity_entry_saccade_aoi_anova)
```


```{r}
#Metric 3: Time to first fixation
time_to_first_fixation_aoi_anova <- aoi_anova_data_metrics_final %>%
  filter(Metric %in% c("Time_to_first_fixation.Background", 
                       "Time_to_first_fixation.Mouth", 
                       "Time_to_first_fixation.Nose", 
                       "Time_to_first_fixation.Eyes", 
                       "Time_to_first_fixation.Face",
                       "Time_to_first_fixation.Eye_1",
                       "Time_to_first_fixation.Eye_2")) %>%
  distinct(Participant, Condition, Media, Neurodiverse, Metric, Value, .keep_all=TRUE) %>%
  mutate(Media= factor(Media, levels=order_of_media))
View(time_to_first_fixation_aoi_anova)


#eye_1 and eye_2 minimum to make eye per media 
eye_sum_time_first_fixation_aoi_anova <- time_to_first_fixation_aoi_anova %>%
  filter(Metric %in% c("Time_to_first_fixation.Eye_1",
                       "Time_to_first_fixation.Eye_2")) %>%
  group_by(Participant, Media, Condition, Neurodiverse) %>%
  summarize(Value = min(Value, na.rm=TRUE)) %>%
  mutate(Metric = "Time_to_first_fixation.Eyes") %>%
  ungroup()
eye_sum_time_first_fixation_aoi_anova

time_to_first_fixation_aoi_anova_final <- bind_rows(time_to_first_fixation_aoi_anova, 
                                              eye_sum_time_first_fixation_aoi_anova) %>%
  mutate(Media = factor(Media, levels = order_of_media))

View(time_to_first_fixation_aoi_anova_final)

```

```{r}
#Metric 4: Number of fixations 
no_fixation_aoi_anova <- aoi_anova_data_metrics_final %>%
  filter(Metric %in% c("Number_of_fixations.Background", 
                       "Number_of_fixations.Mouth", 
                       "Number_of_fixations.Nose", 
                       "Number_of_fixations.Eyes", 
                       "Number_of_fixations.Face",
                       "Number_of_fixations.Eye_1",
                       "Number_of_fixations.Eye_2")) %>%
  mutate(Condition = factor(Condition, levels = order_of_conditions)) %>%
  distinct(Participant, Condition, Media, Neurodiverse, Metric, Value, .keep_all=TRUE)
View(no_fixation_aoi_anova)

#eye_1 and eye_2 combined to make eye per media 
eye_no_fixation_aoi_anova <- no_fixation_aoi_anova %>%
  filter(Metric %in% c("Number_of_fixations.Eye_1",
                       "Number_of_fixations.Eye_2")) %>%
  group_by(Participant, Media, Condition, Neurodiverse) %>%
  summarize(Value = sum(Value, na.rm=TRUE)) %>%
  mutate(Metric = "Number_of_fixations.Eyes") %>%
  ungroup()
View(eye_no_fixation_aoi_anova)

no_fixation_aoi_anova_final <- bind_rows(no_fixation_aoi_anova, eye_no_fixation_aoi_anova) %>%
  mutate(Media = factor(Media, levels = order_of_media))

View(no_fixation_aoi_anova_final)

```

```{r}
#metric 5: avg duration of fixation to aoi
avg_duration_fixation_aoi_anova <- aoi_anova_data_metrics_final %>%
  filter(Metric %in% c("Average_duration_of_fixations.Background", 
                       "Average_duration_of_fixations.Mouth", 
                       "Average_duration_of_fixations.Nose", 
                       "Average_duration_of_fixations.Eyes", 
                       "Average_duration_of_fixations.Face",
                       "Average_duration_of_fixations.Eye_1",
                       "Average_duration_of_fixations.Eye_2")) %>%
  mutate(Condition = factor(Condition, levels = order_of_conditions)) %>%
  distinct(Participant, Condition, Media, Neurodiverse, Metric, Value, .keep_all=TRUE)
View(avg_duration_fixation_aoi_anova)


#eye_1 and eye_2averaged to make eye per media 
eye_avg_duration_fixation_aoi_anova <- avg_duration_fixation_aoi_anova %>%
  filter(Metric %in% c("Average_duration_of_fixations.Eye_1",
                       "Average_duration_of_fixations.Eye_2")) %>%
  group_by(Participant, Media, Condition, Neurodiverse) %>%
  summarize(Value = mean(Value, na.rm=TRUE)) %>%
  mutate(Metric = "Average_duration_of_fixations.Eyes") %>%
  ungroup()
View(eye_avg_duration_fixation_aoi_anova)

avg_duration_fixation_aoi_anova_final <- bind_rows(avg_duration_fixation_aoi_anova, eye_avg_duration_fixation_aoi_anova) %>%
  mutate(Media = factor(Media, levels = order_of_media))

View(avg_duration_fixation_aoi_anova_final)


```

```{r}
#Metric 6: total duration of fixation time

total_duration_fixation_aoi_anova <- aoi_anova_data_metrics %>%
  filter(Metric %in% c("Total_duration_of_fixations.Background", 
                       "Total_duration_of_fixations.Mouth", 
                       "Total_duration_of_fixations.Nose", 
                       "Total_duration_of_fixations.Eyes", 
                       "Total_duration_of_fixations.Face",
                       "Total_duration_of_fixations.Eye_1",
                       "Total_duration_of_fixations.Eye_2")) %>%
  mutate(Condition = factor(Condition, levels = order_of_conditions)) %>%
  distinct(Participant, Condition, Media, Neurodiverse, Metric, Value, .keep_all=TRUE)
View(total_duration_fixation_aoi_anova)


#eye_1 and eye_2 combined to make eye per media 
eye_total_duration_fixation_aoi_anova <- total_duration_fixation_aoi_anova %>%
  filter(Metric %in% c("Total_duration_of_fixations.Eye_1",
                       "Total_duration_of_fixations.Eye_2")) %>%
  group_by(Participant, Media, Condition, Neurodiverse) %>%
  summarize(Value = sum(Value, na.rm=TRUE)) %>%
  mutate(Metric = "Total_duration_of_fixations.Eyes") %>%
  ungroup()
View(eye_total_duration_fixation_aoi_anova)

total_duration_fixation_aoi_anova_final <- bind_rows(total_duration_fixation_aoi_anova,
  eye_total_duration_fixation_aoi_anova) %>%
  mutate(Media = factor(Media, levels = order_of_media))


View(total_duration_fixation_aoi_anova_final)


```

#begin aoi anovas
AOI:  no of saccades; peak velocity of entry saccades; time to 1st fixation; avg duration of fixation to aoi; total duration fixation aoi ; no of fixations 

```{r}
str(aoi_anova_data_metrics_final)
```

#anova Metric 1: no saccades
```{r}
#number of saccades
no_saccades_AOI_anova_df <- no_saccades_AOI_anova_final %>%
  filter(Metric %in% c("Number_of_saccades_in_AOI.Background", 
                       "Number_of_saccades_in_AOI.Mouth", 
                       "Number_of_saccades_in_AOI.Nose", 
                       "Number_of_saccades_in_AOI.Eyes", 
                       "Number_of_saccades_in_AOI.Face")) %>%
    mutate(Metric = sub("Number_of_saccades_in_AOI.", "", Metric)) %>% #remove the measure from the metric name and keep it as just aoi names
  select(c(Participant, Neurodiverse, Media, Condition, Metric, Value)) %>%
  distinct(Participant, Neurodiverse, Media, Condition, Metric, Value)
no_saccades_AOI_anova_df

no_saccades_AOI_anova_df %>%
  group_by(Condition, Neurodiverse, Metric) #makes 50 groups as 5 aois per condition and theres 5 conditions and 2 groups of neurpdiverse so 5x5x2 =50

```
```{r}
#make into factors
no_saccades_AOI_anova_df$Condition <- as.factor(no_saccades_AOI_anova_df$Condition)
no_saccades_AOI_anova_df$Neurodiverse <- as.factor(no_saccades_AOI_anova_df$Neurodiverse)
no_saccades_AOI_anova_df$Metric <- as.factor(no_saccades_AOI_anova_df$Metric)
str(no_saccades_AOI_anova_df)
```



```{R}
#50 groups : 10 with C and ND and 5 AOIs makes 50 !
no_saccades_AOI_anova_df$Metric <- as.factor(no_saccades_AOI_anova_df$Metric)
no_saccades_AOI_anova_df %>%
  group_by(Condition, Neurodiverse, Metric) %>%
  get_summary_stats(Value, type = "mean_sd")

```

```{r}
#normality
no_saccades_AOI_anova_df %>%
  group_by(Condition, Neurodiverse, Metric) %>%
  shapiro_test(Value)

```
all sig ! so does not meet normality assumption

```{r}
bxp_aoim1 <- ggboxplot(
  no_saccades_AOI_anova_df, x = "Condition", y = "Value",
  color = "Neurodiverse", palette = "jco",
  facet.by = "Metric", short.panel.labs = FALSE #each aoi is a different graph
  ) + 
  theme(
    axis.text.x = element_text(size = 8, angle=45, hjust=1),  # Adjust x-axis label size
    axis.text.y = element_text(size = 8),  # Adjust y-axis label size
    strip.text = element_text(size = 10)   # Adjust facet label size
  )
bxp_aoim1
```

```{r}
no_saccades_AOI_anova_df %>%
  group_by(Condition, Metric, Neurodiverse) %>%
  identify_outliers(Value)

```
212 outliers, most extreme
 
```{r}
leveneTest(Value ~ Neurodiverse * Condition * Metric, data = no_saccades_AOI_anova_df)
```
very significant SO NON PARAMETRIC

so doesnt meet levenes (homogeneity), but has most groups meting normailty assumptions, with 29 outliers and 8 extreme  

```{R}
#mixed effects anova NP type 3 ARTnova AOI TAKES LONGER TO RUN

modelaoi1 = art(Value ~ Neurodiverse*Condition*Metric + (1|Participant), #so as C and M are both repeat measures and primarily interested in M so goes last 
               data = no_saccades_AOI_anova_df)
maoi1 <-anova(modelaoi1)
maoi1$part.eta.sq = with(maoi1, `F` * `Df` / (`F` * `Df` + `Df.res`)) #ADDS PARTIAL ETA SQUARED FOR EFFECT SIZE
maoi1


#Check the normality of residuals
shapiro.test(residuals(modelaoi1))
qqnorm(residuals(modelaoi1)); qqline(residuals(modelaoi1), col = "red")
```
so all MAINA DN INTERACTION ARE SIG LETS RUN POSTHOCS ESP ON AOI AS THATS WHAT WERE INTERESTED IN

###posthocs aoi anova 1
```{r}
#Main effect of AOI
maoi1ph.1<-emmeans(artlm.con(modelaoi1, "Metric"), ~Metric)
maoi1ph.1
contrast(maoi1ph.1, method="pairwise", adjust="holm")

```
basically everything apart from background and nose and bg and eyes

```{r}
# Main/intraction effect of Neurodiverse and AOI
maoi1ph.2 <- emmeans(artlm(modelaoi1, "Neurodiverse:Metric"), pairwise~ Metric*Neurodiverse)
maoi1ph.2
contrast(maoi1ph.2, interaction = TRUE, adjust = "holm")

```
okay so overall, neurodiverse is significant with all AOIs
a deeper look shows that 
Background No - Eyes No         -442.76 65.4 2904.0  -6.770  <.0001
 Background No - Mouth No        -720.71 66.2 2904.0 -10.885  <.0001
 Background No - Nose No         -444.74 65.4 2904.0  -6.801  <.0001
 Eyes No - Face No                520.19 65.4 2904.0   7.954  <.0001
 Eyes No - Mouth No              -277.94 66.2 2904.0  -4.198  0.0011
 Face No - Mouth No              -798.14 66.2 2904.0 -12.055  <.0001
 Face No - Nose No               -522.17 65.4 2904.0  -7.985  <.0001
 Mouth No - Nose No               275.97 66.2 2904.0   4.168  0.0013
 Eyes Yes - Mouth Yes            -335.18 66.2 2904.0  -5.062  <.0001
 Face Yes - Mouth Yes            -385.57 66.2 2904.0  -5.824  <.0001
 Mouth Yes - Nose Yes             320.75 66.2 2904.0   4.845  0.0001



```{r}
# Main effect of condition and Metric 
maoi1ph.3 <- emmeans(artlm(modelaoi1, "Condition:Metric"), pairwise~Metric*Condition) #pairwise~
#maoi1ph.3 #UNCOMMENT TO VIEW BUT NEXT CHUNK PRINTS ONLY SIG 
contrast(maoi1ph.3, interaction = TRUE, adjust = "holm")

```
 Background effect Realistic image effect    -332.92 57.2 2904  -5.818  <.0001
 Eyes effect       Realistic image effect     231.88 57.2 2904   4.052  0.0010
 Face effect       Realistic image effect    -320.91 57.2 2904  -5.608  <.0001
 Nose effect       Realistic image effect     268.80 57.2 2904   4.697  0.0001
 Eyes effect       (Semi-abstract) effect    -209.21 57.2 2904  -3.656  0.0050
 Face effect       Very Abstract effect       375.86 57.5 2904   6.538  <.0001
 Nose effect       Very Abstract effect      -275.87 57.5 2904  -4.798  <.0001
 
 removed pairwise as too many to print need to do more indepth analysis 
```{r}
# Extract the contrasts from the object
contrasts_1.3 <- as.data.frame(maoi1ph.3$contrasts, adjust='holm')

# Filter significant contrasts based on p.value (e.g., p < 0.05)
significant_contrasts_1.3 <- contrasts_1.3 %>%
  filter(p.value < 0.01)

# Print only significant results
print(significant_contrasts_1.3)
colnames(significant_contrasts_1.3)

```
```{R}
# Main effect of condition and Metric 
maoi1ph.6 <- emmeans(artlm(modelaoi1, "Neurodiverse:Condition"), pairwise~Condition*Neurodiverse) #pairwise~
maoi1ph.6
contrast(maoi1ph.6, interaction = TRUE, adjust = "holm")


```
overall Realistic image effect   No effect          120.93 29.5 2904   4.102  0.0004 and Realistic image effect   Yes effect        -120.93 29.5 2904  -4.102  0.0004

with specifics being: averaged over AOIs
Realistic image No - Very Abstract No          374.60 66.7 2904.0   5.620  <.0001
 Realistic image No - Very Abstract Yes         451.70 95.4   59.4   4.737  0.0006
 Portrait Painting Yes - Very Abstract Yes      385.77 66.7 2904.0   5.787  <.0001
 (Semi-abstract Yes) - Very Abstract Yes        353.88 66.7 2904.0   5.309  <.0001
 Abstract Yes - Very Abstract Yes               265.97 66.7 2904.0   3.990  0.0027

now do all 3 interaction post hoc
```{r}
#interaction between Cond and Neurodiverse within each AOI
maoi1ph.4 <- emmeans(artlm(modelaoi1, "Neurodiverse:Condition:Metric"), pairwise~ Condition*Neurodiverse | Metric)
#maoi1ph.4

# Perform pairwise comparisons within each Metric
contrast(maoi1ph.4, method = "pairwise", interaction = TRUE, adjust = "holm")


```
its seems none of them are significant (indepth are )

```{r}
# Extract the contrasts from the object
contrasts_1.4 <- as.data.frame(maoi1ph.4$contrasts, adjust='holm')

# Filter significant contrasts based on p.value (e.g., p < 0.05)
significant_contrasts_1.4 <- contrasts_1.4 %>%
  filter(p.value < 0.01)

# Print only significant results
print(significant_contrasts_1.4)
colnames(significant_contrasts_1.4)

```
Metric = Background:
 contrast                                    estimate       SE      df t.ratio p.value
 Realistic image No - Abstract No            610.5667 147.5264 2904.00   4.139  0.0016
 Realistic image No - Very Abstract No       687.7167 147.5264 2904.00   4.662  0.0001
 (Semi-abstract No) - Very Abstract No       560.9000 147.5264 2904.00   3.802  0.0057

Metric = Face:
 contrast                                    estimate       SE      df t.ratio p.value
 Portrait Painting Yes - Very Abstract Yes   538.7667 147.5264 2904.00   3.652  0.0099

Metric = Mouth:
 contrast                                    estimate       SE      df t.ratio p.value
 Portrait Painting No - Very Abstract No     759.8958 156.4754 2904.00   4.856  0.0001
 (Semi-abstract No) - Very Abstract No       820.1292 156.4754 2904.00   5.241  <.0001
 Abstract No - Very Abstract No              675.0958 156.4754 2904.00   4.314  0.0007


```{r}
# now lets check interaction for all together ?
maoi1ph.5 <- emmeans(artlm(modelaoi1, "Neurodiverse:Condition:Metric"), pairwise~ Condition*Neurodiverse*Metric) #pairwise~ #add this in to see all specific interaction where i then base wilcoxons on
#maoi1ph.5 
contrast(maoi1ph.5, method = "pairwise", interaction = TRUE, adjust = "holm")

```
none sig overall lets look at significant pariwise (DONT PRINT ALL PAIRWISE TOO MANY)

```{r}
# Extract the contrasts from the object
contrasts_1.5 <- as.data.frame(maoi1ph.5$contrasts, adjust='holm')

# Filter significant contrasts based on p.value (e.g., p < 0.05)
significant_contrasts_1.5 <- contrasts_1.5 %>%
  filter(p.value < 0.01)

# Print only significant results
print(significant_contrasts_1.5)

```
PLOT VISUALISATION FOR EMMEANS POSTHOC AS WILCOXONS JUST CONFIRMED THIS 
```{r}
# df with sig and p-values ADDING MANUALLY AS NP TEST
aoim1_pvalues <- data.frame(
  Metric = c("Background", "Background", "Background", 
             "Face", 
             "Mouth", "Mouth", "Mouth"),
  group1 = c("Realistic image", "Realistic image", "Semi-abstract", 
             "Portrait Painting", 
             "Portrait Painting", "Semi-abstract", "Abstract"),
  group2 = c("Abstract", "Very Abstract", "Very Abstract", 
             "Very Abstract", 
             "Very Abstract", "Very Abstract", "Very Abstract"),
  Neurodiverse = c("No", "No", "No", 
                   "Yes", 
                   "No", "No", "No"),
  p.adj = c("***", "***", "**", 
            "*", 
            "***", "***", "***"),
  y.position = c(25, 21, 18, 
                 28, 
                 21, 17, 13)
)

aoi1_sig_metrics_only <-no_saccades_AOI_anova_df %>%
  filter(!(Metric %in% c("Eyes", "Nose")))

# Add manual p-values to the box plot
bxp_aoim1_filtered <- ggboxplot(
  aoi1_sig_metrics_only, x = "Condition", y = "Value",
  color = "Neurodiverse",# palette = "jco",
  facet.by = "Metric", short.panel.labs = TRUE
)  +
  stat_pvalue_manual(
    aoim1_pvalues, label = "p.adj", 
    y.position = "y.position", 
    remove.bracket = FALSE, 
    xmin = "group1", xmax = "group2", 
    color = "Neurodiverse",
    tip.length = 0.02
  ) +
 scale_color_manual(values = c("No" = "red", "Yes" = "blue"))+
  theme(
    axis.text.x = element_text(size = 10, angle = 45, hjust = 1),  # Adjust x-axis label size
    axis.text.y = element_text(size = 10),  # Adjust y-axis label size
    strip.text = element_text(size = 10)   # Adjust facet label size
  )
bxp_aoim1_filtered
  

#ggsave("AOI_metric_1_anova_significant_interaction_boxplot_emmeans.png", bxp_aoim1_filtered, width=10, height=8, dpi=300)
```


#anova Metric 2: peak velocity of entry saccade aoi anova

```{r}
#Peak Velocity of entry saccade
peak_velocity_entry_saccade_aoi_anova_df <- peak_velocity_entry_saccade_aoi_anova %>%
  filter(Metric %in% c("Background", 
                       "Mouth", 
                       "Nose", 
                       "Eyes", 
                       "Face")) %>%
  select(c(Participant, Neurodiverse, Media, Condition, Metric, Value)) %>%
  distinct(Participant, Neurodiverse, Media, Condition, Metric, Value)
peak_velocity_entry_saccade_aoi_anova_df

peak_velocity_entry_saccade_aoi_anova_df %>%
  group_by(Condition, Neurodiverse, Metric)

```
```{r}
peak_velocity_entry_saccade_aoi_anova_df$Condition <- as.factor(peak_velocity_entry_saccade_aoi_anova_df$Condition)
peak_velocity_entry_saccade_aoi_anova_df$Neurodiverse <- as.factor(peak_velocity_entry_saccade_aoi_anova_df$Neurodiverse)
peak_velocity_entry_saccade_aoi_anova_df$Metric <- as.factor(peak_velocity_entry_saccade_aoi_anova_df$Metric)
str(peak_velocity_entry_saccade_aoi_anova_df)
```



```{R}
#50 groups : 10 with C and ND and 5 AOIs makes 50 !
peak_velocity_entry_saccade_aoi_anova_df$Metric <- as.factor(peak_velocity_entry_saccade_aoi_anova_df$Metric)
peak_velocity_entry_saccade_aoi_anova_df%>%
  group_by(Condition, Neurodiverse, Metric) %>%
  get_summary_stats(Value, type = "mean_sd")

```

```{r}
peak_velocity_entry_saccade_aoi_anova_df %>%
  group_by(Condition, Neurodiverse, Metric) %>%
  shapiro_test(Value)%>%
  filter(p > 0.05) %>% #only print sig gorups 
  print()
```
29/50 groups are significant 

```{r}
bxp_aoim2 <- ggboxplot(
  peak_velocity_entry_saccade_aoi_anova_df, x = "Condition", y = "Value",
  color = "Neurodiverse", palette = "jco",
  facet.by = "Metric", short.panel.labs = FALSE
  ) + 
  theme(
    axis.text.x = element_text(size = 8, angle=45, hjust=1),  # Adjust x-axis label size
    axis.text.y = element_text(size = 8),  # Adjust y-axis label size
    strip.text = element_text(size = 10)   # Adjust facet label size
  )
bxp_aoim2
```

```{r}
peak_velocity_entry_saccade_aoi_anova_df  %>%
  group_by(Condition, Metric, Neurodiverse) %>%
  identify_outliers(Value)

```
52 outliers, most extreme
 
```{r}
leveneTest(Value ~ Neurodiverse * Condition * Metric, data = peak_velocity_entry_saccade_aoi_anova_df )
```
very significant SO NON PARAMETRIC


```{R}
#mixed effects anova NP type 3 ARTnova
options(scipen=999)
modelaoi2 = art(Value ~ Neurodiverse*Condition*Metric + (1|Participant),
               data = peak_velocity_entry_saccade_aoi_anova_df)
maoi2 <-anova(modelaoi2)
maoi2$part.eta.sq = with(maoi2, `F` * `Df` / (`F` * `Df` + `Df.res`)) #ADDS PARTIAL ETA SQUARED FOR EFFECT SIZE
maoi2

#Check the normality of residuals
shapiro.test(residuals(modelaoi2))
qqnorm(residuals(modelaoi2)); qqline(residuals(modelaoi2), col = "red")
```
so condition , metric, n/m, c/m signficnt; metric and nd ; metric and cond

####posthocs aoi metric 2
POSTHOC
```{r}
# Main effect of Metric 
maoi2ph.1 <- emmeans(artlm(modelaoi2, "Metric"), pairwise ~Metric)
maoi2ph.1
contrast(maoi2ph.1, interaction = TRUE, adjust = "holm")
```
so overall background is significant (at these Background - Eyes <.0001; Background - Face <.0001; Background - Mouth  <.0001; Background - Nose <.0001) as is face, mouth and nose 

Background is sig for all all <0.0001
and eyes and nose are sig < 0.001 so all those that seem sig are only in relationship with background 



```{R}
# Main effect of nd and Metric 
maoi2ph.2 <- emmeans(artlm(modelaoi2, "Neurodiverse:Metric"), pairwise~Metric*Neurodiverse)
maoi2ph.2
contrast(maoi2ph.2, interaction = TRUE, adjust = "holm")

```
so overall, sig across eyes/no ; eyes/yes
in depth: BG AND EYES FOR NO CONDITION IS THE ONLY SIG ONE

```{r}
# Main effect of condition and Metric 
maoi2ph.3 <- emmeans(artlm(modelaoi2, "Condition:Metric"), pairwise~Metric*Condition) 
#maoi2ph.3
contrast(maoi2ph.3, interaction = TRUE, adjust = "holm")

```
eyes abstract sig <.0001; bg va sig 0.0053 

```{r}
# Extract the contrasts from the object
contrasts_df <- as.data.frame(maoi2ph.3$contrasts, adjust='holm')

# Filter significant contrasts based on p.value (e.g., p < 0.05)
significant_contrasts <- contrasts_df %>%
  filter(p.value < 0.01)

# Print only significant results
print(significant_contrasts)

```
relevant significant aoi and condition pariwise interactions:

 Eyes Realistic image - Eyes Abstract             449.0479 74.04348 2050.15   6.065  <.0001
 Background Abstract - Eyes Abstract              447.5535 93.97742 2052.63   4.762  0.0006
 Background Abstract - Background Very Abstract   441.4351 99.06152 2051.15   4.456  0.0026
 Eyes Abstract - Eyes Very Abstract              -338.6200 74.51359 2050.22  -4.544  0.0017
 
 interaction between all not significant so no need to run posthoc for it 

#anova metric 3:time to 1st fixation

Metric 3: time to first fixation to aoi

```{r}
#time to first fixation 

time_to_first_fixation_aoi_anova_df <- time_to_first_fixation_aoi_anova_final %>%
  filter(Metric %in% c("Time_to_first_fixation.Background", 
                       "Time_to_first_fixation.Mouth", 
                       "Time_to_first_fixation.Nose", 
                       "Time_to_first_fixation.Eyes", 
                       "Time_to_first_fixation.Face")) %>%
  mutate(Metric = sub("Time_to_first_fixation.", "", Metric)) %>%
  select(c(Participant, Neurodiverse, Media, Condition, Metric, Value)) %>%
  distinct(Participant, Neurodiverse, Media, Condition, Metric, Value)
time_to_first_fixation_aoi_anova_df

time_to_first_fixation_aoi_anova_df %>%
  group_by(Condition, Neurodiverse, Metric)

```
```{r}
time_to_first_fixation_aoi_anova_df$Condition <- as.factor(time_to_first_fixation_aoi_anova_df$Condition)
time_to_first_fixation_aoi_anova_df$Neurodiverse <- as.factor(time_to_first_fixation_aoi_anova_df$Neurodiverse)
time_to_first_fixation_aoi_anova_df$Metric <- as.factor(time_to_first_fixation_aoi_anova_df$Metric)
str(time_to_first_fixation_aoi_anova_df)
```



```{R}
#50 groups : 10 with C and ND and 5 AOIs makes 50 !
time_to_first_fixation_aoi_anova_df$Metric <- as.factor(time_to_first_fixation_aoi_anova_df$Metric)
time_to_first_fixation_aoi_anova_df%>%
  group_by(Condition, Neurodiverse, Metric) %>%
  get_summary_stats(Value, type = "mean_sd")

```

```{r}
time_to_first_fixation_aoi_anova_df %>%
  group_by(Condition, Neurodiverse, Metric) %>%
  shapiro_test(Value)%>%
  filter(p > 0.05) %>%
  print()
```
8/50 groups significant so majority meets noramlity 

```{r}
bxp_aoim3 <- ggboxplot(
  time_to_first_fixation_aoi_anova_df, x = "Condition", y = "Value",
  color = "Neurodiverse", palette = "jco",
  facet.by = "Metric", short.panel.labs = FALSE
  ) + 
  theme(
    axis.text.x = element_text(size = 8, angle=45, hjust=1),  # Adjust x-axis label size
    axis.text.y = element_text(size = 8),  # Adjust y-axis label size
    strip.text = element_text(size = 10)   # Adjust facet label size
  )
bxp_aoim3
```

```{r}
time_to_first_fixation_aoi_anova_df  %>%
  group_by(Condition, Metric, Neurodiverse) %>%
  identify_outliers(Value)

```
197 outliers, most extreme
 
```{r}
leveneTest(Value ~ Neurodiverse * Condition * Metric, data = time_to_first_fixation_aoi_anova_df )
```
very significant SO NON PARAMETRIC

```{R}
#mixed effects anova NP type 3 ARTnova takws a while to run

modelaoi3 = art(Value ~ Neurodiverse*Condition*Metric + (1|Participant),
               data = time_to_first_fixation_aoi_anova_df)
maoi3 <-anova(modelaoi3)
maoi3$part.eta.sq = with(maoi3, `F` * `Df` / (`F` * `Df` + `Df.res`)) #ADDS PARTIAL ETA SQUARED FOR EFFECT SIZE
maoi3

#Check the normality of residuals
shapiro.test(residuals(modelaoi3))
qqnorm(residuals(modelaoi3)); qqline(residuals(modelaoi3), col = "red")
```
cond sig ; metric sig; ND* M ; C*M; and athen all interaction is sig 


###posthocs for aoi metric 3

lets do metric no need for condition
```{r}
# Main effect of Metric 
maoi3ph.1 <- emmeans(artlm(modelaoi3, "Metric"), pairwise~Metric)
maoi3ph.1
contrast(maoi3ph.1, interaction = TRUE, adjust = "holm")


```

SO OVERALL ALL SIG BG EYES FACE MOUTH AND NOSE; IN DEPTH: BG/EYES ; BG/FACE; BG/NOSE; EYES/MOUTH; EYES/NOSE' FACE/MOUTH; FACE/NOSE AND MOUTH/NOSE -->ALL BUT BG/MOUTH AND EYES/FACE ARE SIG 
 

```{R}
# Main effect of ND and Metric 
maoi3ph.2 <- emmeans(artlm(modelaoi3, "Neurodiverse:Metric"), pairwise~Metric*Neurodiverse)
maoi3ph.2
contrast(maoi3ph.2, interaction = TRUE, adjust = "holm")


```
SO OVERALL , EYES/YES AND EYES/NO ARE SIG 
IN DEPTH: FACE/NO - BG/YES ONLY 

```{r}
# Extract the contrasts from the object
contrasts_df <- as.data.frame(maoi3ph.2$contrasts, adjust='holm')

# Filter significant contrasts based on p.value (e.g., p < 0.05)
significant_contrasts <- contrasts_df %>%
  filter(p.value < 0.01)

# Print only significant results
print(significant_contrasts)

```

```{r}
# Main effect of condition and Metric 
maoi3ph.3 <- emmeans(artlm(modelaoi3, "Condition:Metric"), pairwise~Metric*Condition) #pairwise~
#maoi3ph.3
contrast(maoi3ph.3, interaction = TRUE, adjust = "holm")


```

didnt do pairwise as too many so omitts most of them
but overall eyes/RI sig; face/RI; mouth/RI; face/pp; mouth/pp; eyes/SA; mouth/SA; mouth/va; nose/va
so eyes across ri and sa ; 
face across ri, pp,
mouth across ri, pp, sa and va
nose va only

```{r}
# Extract the contrasts from the object
contrasts_df <- as.data.frame(maoi3ph.3$contrasts, adjust='holm')

# Filter significant contrasts based on p.value (e.g., p < 0.05)
significant_contrasts <- contrasts_df %>%
  filter(p.value < 0.01)

# Print only significant results
print(significant_contrasts)

```
CONDITIONS ACROSS AOIS

Background Realistic image - Nose Realistic image    640.8916 123.31454 2264.25   5.197  0.0001
 Eyes Realistic image - Face Realistic image         -483.3852  85.48131 2249.35  -5.655  <.0001
 Face Realistic image - Nose Realistic image          804.0549  85.30381 2248.95   9.426  <.0001
 Mouth Realistic image - Nose Realistic image         583.6842  98.19071 2256.97   5.944  <.0001
 
  Background Very Abstract - Nose Very Abstract       -435.9864  94.13570 2254.03  -4.631  0.0010
 Eyes Very Abstract - Mouth Very Abstract             472.8768  95.89313 2249.41   4.931  0.0002
 Face Very Abstract - Nose Very Abstract             -488.4154  87.89004 2245.64  -5.557  <.0001
 Mouth Very Abstract - Nose Very Abstract            -637.7087  99.93072 2250.87  -6.382  <.0001

 
 AOIS ACROSS CONDITIONS 
 
 Face Realistic image - Face Portrait Painting        581.8474  86.76435 2246.76   6.706  <.0001
  Face Realistic image - Face Abstract                 398.3679  85.63196 2246.86   4.652  0.0009
  Face Realistic image - Face Very Abstract            570.0839  85.30253 2248.78   6.683  <.0001
  
Mouth Realistic image - Mouth Very Abstract          499.0065 109.06722 2255.70   4.575  0.0013
 Mouth Portrait Painting - Mouth Very Abstract        557.0201 119.86219 2252.47   4.647  0.0010
  
  Nose Realistic image - Nose Portrait Painting       -417.2083  82.73568 2243.18  -5.043  0.0001
 Nose Realistic image - (Nose Semi-abstract)         -510.0582  83.45515 2243.64  -6.112  <.0001
 Nose Realistic image - Nose Very Abstract           -722.3863  87.88872 2245.45  -8.219  <.0001
 
(Nose Semi-abstract) - Nose Abstract                 358.4862  85.12897 2244.74   4.211  0.0067
  Nose Abstract - Nose Very Abstract                  -570.8144  89.48079 2246.49  -6.379  <.0001

now do all 3 interaction post hoc
```{r}
#interaction between Cond and Neurodiverse within each AOI
maoi3ph.4 <- emmeans(artlm(modelaoi3, "Neurodiverse:Condition:Metric"), pairwise~ Condition*Neurodiverse | Metric)
#maoi3ph.4

# Perform pairwise comparisons within each Metric
contrast(maoi3ph.4, method = "pairwise", interaction = TRUE, adjust = "holm")


```
FACE  Realistic image - Very Abstract     No - Yes                579.51 174 2248   3.330  0.0079
face  Realistic image - Portrait Painting No - Yes                657.47 177 2246   3.714  0.0021

```{r}
# extract the contrasts from the object
contrasts_df <- as.data.frame(maoi3ph.4$contrasts, adjust='holm')

# *fFilter significant contrasts based on p.value (e.g., p < 0.05)
significant_contrasts <- contrasts_df %>%
  filter(p.value < 0.01)

# print only significant results
print(significant_contrasts)

```

Realistic image Yes - Portrait Painting Yes -536.4576 122.5699 2247.94  -4.377  0.0006
 Realistic image Yes - Very Abstract Yes     -738.1756 121.5685 2247.70  -6.072  <.0001
 Abstract Yes - Very Abstract Yes            -467.1126 119.8691 2243.60  -3.897  0.0041

Realistic image No - Portrait Painting No    462.1500 118.8437 2243.14   3.889  0.0040
  Realistic image Yes - Portrait Painting Yes  508.3390 119.8466 2243.14   4.242  0.0009
 Realistic image Yes - Abstract Yes           539.5915 122.6064 2244.52   4.401  0.0005
 Realistic image Yes - Very Abstract Yes      711.1419 128.8648 2245.46   5.519  <.0001


```{r}
# now lets check interaction for all together ?
maoi3ph.5 <- emmeans(artlm(modelaoi3, "Neurodiverse:Condition:Metric"), pairwise~ Condition*Neurodiverse*Metric)
#maoi3ph.5

# Perform pairwise comparisons within each Metric
contrast(maoi3ph.5, method = "pairwise", interaction = TRUE, adjust = "holm")


```
just this Realistic image - Very Abstract     No - Yes              Face - Nose         1015.29 250 2247   4.063  0.0050
give different results so which ones right?

```{r}
# Extract the contrasts from the object
contrasts_df <- as.data.frame(maoi3ph.5$contrasts, adjust='holm')

# Filter significant contrasts based on p.value (e.g., p < 0.05)
significant_contrasts <- contrasts_df %>%
  filter(p.value < 0.01)

# Print only significant results
print(significant_contrasts)

```
face
Realistic image Yes - Portrait Painting Yes -536.4576 122.5699 2247.94  -4.377  0.0006
 Realistic image Yes - Very Abstract Yes     -738.1756 121.5685 2247.70  -6.072  <.0001
 Abstract Yes - Very Abstract Yes            -467.1126 119.8691 2243.60  -3.897  0.0041

no
Realistic image No - Portrait Painting No    462.1500 118.8437 2243.14   3.889  0.0040
  Realistic image Yes - Portrait Painting Yes  508.3390 119.8466 2243.14   4.242  0.0009
 Realistic image Yes - Abstract Yes           539.5915 122.6064 2244.52   4.401  0.0005
 Realistic image Yes - Very Abstract Yes      711.1419 128.8648 2245.46   5.519  <.0001


####WILCOXONS metric 3 

SO LETS TEST THIS ONE WILCOXONS 
 Realistic image - Very Abstract     No - Yes    Face - Nose  0.0050

 
```{r}
install.packages("maditr")
install.packages("exactRankTests")
library(maditr)
library(exactRankTests)
```

```{R}
#make wide format 
# Convert data to wide format
time_to_first_fixation_wide <- dcast(time_to_first_fixation_aoi_anova_df, 
                                     Participant + Neurodiverse ~ Condition + Metric, 
                                     value.var = "Value",
                                     fun.aggregate=mean)
time_to_first_fixation_wide
View(time_to_first_fixation_aoi_anova_df)
```
now run wilcoxons 

first split into NT and ND 
```{r}
# NT
m3_ph_wilc_nt <- time_to_first_fixation_wide %>% filter(Neurodiverse == "No")
m3_ph_wilc_nd <-time_to_first_fixation_wide %>% filter(Neurodiverse == "Yes")
```

```{r}
# Wilcox face AOI: RI vs VA
face_real_vs_va_nt = wilcox.exact(m3_ph_wilc_nt$`Realistic image_Face`, 
                                  m3_ph_wilc_nt$`Very Abstract_Face`, 
                                  alternative = "two.sided", 
                                  paired = TRUE, 
                                  exact = TRUE,
                                  na.action = na.omit)
face_real_vs_va_nt

```
so for NT individuals there is a sig differnce between time to first fixation for RI vs VA for face aoi 

```{r}
install.packages("coin")
```

```{R}

library(coin)
# Z-value and effect size calculation for Face AOI RI VA NT 
zvalue_face_nt <- wilcoxsign_test(m3_ph_wilc_nt$`Realistic image_Face` ~ 
                              m3_ph_wilc_nt$`Very Abstract_Face`,
                              alternative = "two.sided", 
                              zero.method = c("Wilcoxon"), 
                              distribution = "exact")
zvalue_face_nt
```

```{r}
#effect size 
zvalue_face_nt_ef <- abs(statistic(zvalue_face_nt))/sqrt(2*min(length(na.omit(m3_ph_wilc_nt$`Realistic image_Face`)), 
                                                    length(na.omit(m3_ph_wilc_nt$`Very Abstract_Face`))))
zvalue_face_nt_ef

```
```{r}
# Wilcox nose AOI: RI vs VA NT
nose_real_vs_va_nt = wilcox.exact(m3_ph_wilc_nt$`Realistic image_Nose`, 
                                  m3_ph_wilc_nt$`Very Abstract_Nose`, 
                                  alternative = "two.sided", 
                                  paired = TRUE, 
                                  exact = TRUE,
                                  na.action = na.omit)
nose_real_vs_va_nt

```
```{r}
# Z-value and effect size calculation for Nose
zvalue_nose_nt <- wilcoxsign_test(m3_ph_wilc_nt$`Realistic image_Nose` ~ 
                              m3_ph_wilc_nt$`Very Abstract_Nose`,
                              alternative = "two.sided", 
                              zero.method = c("Wilcoxon"), 
                              distribution = "exact")
zvalue_nose_nt

zvalue_nose_nt_ef <- abs(statistic(zvalue_nose_nt))/sqrt(2*min(length(na.omit(m3_ph_wilc_nt$`Realistic image_Nose`)), 
                                                    length(na.omit(m3_ph_wilc_nt$`Very Abstract_Nose`))))
zvalue_nose_nt_ef


```
interesting its the same as the last one but v=0 

adjust needed for pvalue done all at end

NOW NEURODIVERSE 
```{R}
# face aoi: ri vs va
face_real_vs_va_nd = wilcox.exact(m3_ph_wilc_nd$`Realistic image_Face`, 
                                   m3_ph_wilc_nd$`Very Abstract_Face`, 
                                   alternative = "two.sided", 
                                   paired = TRUE, 
                                   exact = TRUE,
                                   na.action = na.omit)
print(face_real_vs_va_nd)

```
okay cool 
```{R}
# z-value and effect size face nd
zvalue_face_nd <- wilcoxsign_test(m3_ph_wilc_nd$`Realistic image_Face` ~ 
                               m3_ph_wilc_nd$`Very Abstract_Face`,
                               alternative = "two.sided", 
                               zero.method = c("Wilcoxon"), 
                               distribution = "exact")
zvalue_face_nd

zvalue_face_nd_ef <- abs(statistic(zvalue_face_nd))/sqrt(2*min(length(na.omit(m3_ph_wilc_nd$`Realistic image_Face`)), 
                                                     length(na.omit(m3_ph_wilc_nd$`Very Abstract_Face`))))
zvalue_face_nd_ef
```

```{r}
#nose aoi: ri vs va
nose_real_vs_va_nd = wilcox.exact(m3_ph_wilc_nd$`Realistic image_Nose`, 
                                   m3_ph_wilc_nd$`Very Abstract_Nose`, 
                                   alternative = "two.sided", 
                                   paired = TRUE, 
                                   exact = TRUE,
                                   na.action = na.omit)
nose_real_vs_va_nd

```

```{r}
# z-value and effect size nose nd
zvalue_nose_nd <- wilcoxsign_test(m3_ph_wilc_nd$`Realistic image_Nose` ~ 
                               m3_ph_wilc_nd$`Very Abstract_Nose`,
                               alternative = "two.sided", 
                               zero.method = c("Wilcoxon"), 
                               distribution = "exact")
zvalue_nose_nd

zvalue_nose_nd_ef <- abs(statistic(zvalue_nose_nd))/sqrt(2*min(length(na.omit(m3_ph_wilc_nd$`Realistic image_Nose`)), 
                                                     length(na.omit(m3_ph_wilc_nd$`Very Abstract_Nose`))))
zvalue_nose_nd_ef

```
okay cool

now lets do nd vs nt 
NEURODIVERSE VS NEUROTYPICAL 

```{r}
# Test for the Face metric: ri vs ri nd vs nt 
face_real_vs_real_nd_vs_nt = wilcox.exact(m3_ph_wilc_nd$`Realistic image_Face`, 
                                   m3_ph_wilc_nt$`Realistic image_Face`, 
                                   alternative = "two.sided", 
                                   paired = TRUE, 
                                   exact = TRUE,
                                   na.action = na.omit)
face_real_vs_real_nd_vs_nt

```
between nd and nt not sig 

```{r}
# z-value and effect size calculation for Face ri vs ri nt 
zvalue_face_nd_vs_nt_ri <- wilcoxsign_test(m3_ph_wilc_nd$`Realistic image_Face` ~ 
                               m3_ph_wilc_nt$`Realistic image_Face`,
                               alternative = "two.sided", 
                               zero.method = c("Wilcoxon"), 
                               distribution = "exact")
zvalue_face_nd_vs_nt_ri

zvalue_face_nd_vs_nt_ri_ef <- abs(statistic(zvalue_face_nd_vs_nt_ri))/sqrt(2*min(length(na.omit(m3_ph_wilc_nd$`Realistic image_Face`)), 
                                                     length(na.omit(m3_ph_wilc_nt$`Realistic image_Face`))))
zvalue_face_nd_vs_nt_ri_ef

```
NOW NOSE ND VS NT RI 
```{r}
# Test for the Nose metric: Realistic image ND VS NT 
nose_real_vs_real_nd_vs_nt = wilcox.exact(m3_ph_wilc_nd$`Realistic image_Nose`, 
                                   m3_ph_wilc_nt$`Realistic image_Nose`, 
                                   alternative = "two.sided", 
                                   paired = TRUE, 
                                   exact = TRUE,
                                   na.action = na.omit)
nose_real_vs_real_nd_vs_nt
```
not sig  needs to be p value corrected
```{r}

# Z-value and effect size calculation for Nose
zvalue_nose_nd_vs_nt_ri <- wilcoxsign_test(m3_ph_wilc_nd$`Realistic image_Nose` ~ 
                               m3_ph_wilc_nt$`Realistic image_Nose`,
                               alternative = "two.sided", 
                               zero.method = c("Wilcoxon"), 
                               distribution = "exact")
zvalue_nose_nd_vs_nt_ri

zvalue_nose_nd_vs_nt_ri_ef <- abs(statistic(zvalue_nose_nd_vs_nt_ri))/sqrt(2*min(length(na.omit(m3_ph_wilc_nd$`Realistic image_Nose`)), 
                                                     length(na.omit(m3_ph_wilc_nt$`Realistic image_Nose`))))
zvalue_nose_nd_vs_nt_ri_ef

```
now do very abstract nd vs nt 
```{r}
# Test for the Face metric: VA only nd vs nt 
face_va_nd_vs_nt = wilcox.exact(m3_ph_wilc_nd$`Very Abstract_Face`, 
                                   m3_ph_wilc_nt$`Very Abstract_Face`, 
                                   alternative = "two.sided", 
                                   paired = TRUE, 
                                   exact = TRUE,
                                   na.action = na.omit)
face_va_nd_vs_nt
```
not signif
```{r}
# Z-value and effect size calculation for Face very abstract nd vs nt 
zvalue_face_nd_vs_nt_va <- wilcoxsign_test(m3_ph_wilc_nd$`Very Abstract_Face` ~ 
                               m3_ph_wilc_nt$`Very Abstract_Face`,
                               alternative = "two.sided", 
                               zero.method = c("Wilcoxon"), 
                               distribution = "exact")
zvalue_face_nd_vs_nt_va

zvalue_face_nd_vs_nt_va_ef <- abs(statistic(zvalue_face_nd_vs_nt_va))/sqrt(2*min(length(na.omit(m3_ph_wilc_nd$`Very Abstract_Face`)), 
                                                     length(na.omit(m3_ph_wilc_nt$`Very Abstract_Face`))))
zvalue_face_nd_vs_nt_va_ef

```
now nose nd vs nt for very abstract condition
```{R}
# Test for the Nose metric: va vs Very Abstract nd vs nt 
nose_va_nd_vs_nt = wilcox.exact(m3_ph_wilc_nd$`Very Abstract_Nose`, 
                                   m3_ph_wilc_nt$`Very Abstract_Nose`, 
                                   alternative = "two.sided", 
                                   paired = TRUE, 
                                   exact = TRUE,
                                   na.action = na.omit)
nose_va_nd_vs_nt
```
not signifcant 
```{r}
# Z-value and effect size calculation for Nose
zvalue_nose_nd_vs_nt_va <- wilcoxsign_test(m3_ph_wilc_nd$`Very Abstract_Nose` ~ 
                               m3_ph_wilc_nt$`Very Abstract_Nose`,
                               alternative = "two.sided", 
                               zero.method = c("Wilcoxon"), 
                               distribution = "exact")
zvalue_nose_nd_vs_nt_va

zvalue_nose_nd_vs_nt_va_ef <- abs(statistic(zvalue_nose_nd_vs_nt_va))/sqrt(2*min(length(na.omit(m3_ph_wilc_nd$`Realistic image_Nose`)), 
                                                     length(na.omit(m3_ph_wilc_nt$`Very Abstract_Nose`))))
zvalue_nose_nd_vs_nt_va_ef


```

now p.value adjustment using holm 

```{r}
p.adjust(c(face_real_vs_va_nt$p.value, #ri va nt face
           nose_real_vs_va_nt$p.value, #ri va nt nose
           face_real_vs_va_nd$p.value, #ri va nd face
           nose_real_vs_va_nd$p.value, #ri va nd nose
           face_real_vs_real_nd_vs_nt$p.value, #ri ri nd nt face
           nose_real_vs_real_nd_vs_nt$p.value, #ri ri nd nt nose
           face_va_nd_vs_nt$p.value, #va va nd nt face
           nose_va_nd_vs_nt$p.value), method="holm") #va va nd nt nose

```
and this tells us that 
RI VA NT FACE         SIG  *
RI VA NT NOSE         SIG  *
RI VA ND FACE         SIG  *
RI VA ND NOSE         NOT SIG  
RI RI ND NT FACE    NOT SIG
RI RI ND NT NOSE    NOT SIG
VA VA ND NT FACE    NOT SIG 
VA VA ND NT NOSE    NOT SIG

face
Realistic image Yes - Portrait Painting Yes -536.4576 122.5699 2247.94  -4.377  0.0006
 Realistic image Yes - Very Abstract Yes     -738.1756 121.5685 2247.70  -6.072  <.0001
 Abstract Yes - Very Abstract Yes            -467.1126 119.8691 2243.60  -3.897  0.0041

no
Realistic image No - Portrait Painting No    462.1500 118.8437 2243.14   3.889  0.0040
  Realistic image Yes - Portrait Painting Yes  508.3390 119.8466 2243.14   4.242  0.0009
 Realistic image Yes - Abstract Yes           539.5915 122.6064 2244.52   4.401  0.0005
 Realistic image Yes - Very Abstract Yes      711.1419 128.8648 2245.46   5.519  <.0001



```{r}
# df with sig and p-values ADDING MANUALLY AS NP TEST
aoim3_pvalues <- data.frame(
  Metric = c("Face", "Nose", "Face"),
  group1 = c("Realistic image", "Realistic image", "Realistic image"),
  group2 = c("Very Abstract", "Very Abstract", "Very Abstract"),
  Neurodiverse = c("No", "No", "Yes"),
  p.adj = c("*", "*", "*"),
  y.position = c(10500, 11000, 11100)
)

aoi3_sig_metrics_only <-time_to_first_fixation_aoi_anova_df %>%
  filter((Metric %in% c("Face", "Nose")))

# Add manual p-values to the box plot
bxp_aoim3_filtered <- ggboxplot(
  aoi3_sig_metrics_only, x = "Condition", y = "Value",
  color = "Neurodiverse",# palette = "jco",
  facet.by = "Metric", short.panel.labs = TRUE
) +
  stat_pvalue_manual(
    aoim3_pvalues, label = "p.adj", 
    y.position = "y.position", 
    remove.bracket = FALSE, 
    xmin = "group1", xmax = "group2",
    color="Neurodiverse"
  ) +
 scale_color_manual(values = c("No" = "red", "Yes" = "blue"))+
  theme(
    axis.text.x = element_text(size = 10, angle = 45, hjust = 1),  # Adjust x-axis label size
    axis.text.y = element_text(size = 10),  # Adjust y-axis label size
    strip.text = element_text(size = 10)   # Adjust facet label size
  )
bxp_aoim3_filtered
  

#ggsave("aoi_metric_3_significant_interaction_boxplot_wilcoxons.png", bxp_aoim3_filtered, width=10, height=8, dpi=300)
```



#anova Metric 4: avg duration of fixation to aoi

Metric 4: Average duration of fixation to AOI
 
```{r}
#avg duration of fixation 

avg_duration_fixation_aoi_anova_df <- avg_duration_fixation_aoi_anova_final %>%
  filter(Metric %in% c("Average_duration_of_fixations.Background", 
                       "Average_duration_of_fixations.Mouth", 
                       "Average_duration_of_fixations.Nose", 
                       "Average_duration_of_fixations.Eyes", 
                       "Average_duration_of_fixations.Face")) %>%
  mutate(Metric = sub("Average_duration_of_fixations.", "", Metric)) %>%
  select(c(Participant, Neurodiverse, Media, Condition, Metric, Value)) %>%
  distinct(Participant, Neurodiverse, Media, Condition, Metric, Value)
avg_duration_fixation_aoi_anova_df

avg_duration_fixation_aoi_anova_df %>%
  group_by(Condition, Neurodiverse, Metric)

```
```{r}
avg_duration_fixation_aoi_anova_df$Condition <- as.factor(avg_duration_fixation_aoi_anova_df$Condition)
avg_duration_fixation_aoi_anova_df$Neurodiverse <- as.factor(avg_duration_fixation_aoi_anova_df$Neurodiverse)
avg_duration_fixation_aoi_anova_df$Metric <- as.factor(avg_duration_fixation_aoi_anova_df$Metric)
str(avg_duration_fixation_aoi_anova_df)
```



```{R}
#50 groups : 10 with C and ND and 5 AOIs makes 50 !
avg_duration_fixation_aoi_anova_df$Metric <- as.factor(avg_duration_fixation_aoi_anova_df$Metric)
avg_duration_fixation_aoi_anova_df%>%
  group_by(Condition, Neurodiverse, Metric) %>%
  get_summary_stats(Value, type = "mean_sd")

```

```{r}
avg_duration_fixation_aoi_anova_df %>%
  group_by(Condition, Neurodiverse, Metric) %>%
  shapiro_test(Value)%>%
  filter(p > 0.05) %>%
  print()
```
11/50 groups significant so majority meets noramlity 

```{r}
bxp_aoim4 <- ggboxplot(
  avg_duration_fixation_aoi_anova_df, x = "Condition", y = "Value",
  color = "Neurodiverse", palette = "jco",
  facet.by = "Metric", short.panel.labs = FALSE
  ) + 
  theme(
    axis.text.x = element_text(size = 8, angle=45, hjust=1),  # Adjust x-axis label size
    axis.text.y = element_text(size = 8),  # Adjust y-axis label size
    strip.text = element_text(size = 10)   # Adjust facet label size
  )
bxp_aoim4
```

```{r}
avg_duration_fixation_aoi_anova_df  %>%
  group_by(Condition, Metric, Neurodiverse) %>%
  identify_outliers(Value)

```
179 outliers, mabt 1/2 extreme 
 
```{r}
leveneTest(Value ~ Neurodiverse * Condition * Metric, data =avg_duration_fixation_aoi_anova_df)
```
significant SO NON PARAMETRIC

```{R}
#mixed effects anova NP type 3 ARTnova takws a while to run

modelaoi4 = art(Value ~ Neurodiverse*Condition*Metric + (1|Participant),
               data = avg_duration_fixation_aoi_anova_df)
maoi4 <-anova(modelaoi4)
maoi4$part.eta.sq = with(maoi4, `F` * `Df` / (`F` * `Df` + `Df.res`)) #ADDS PARTIAL ETA SQUARED FOR EFFECT SIZE
maoi4

#Check the normality of residuals
shapiro.test(residuals(modelaoi4))
qqnorm(residuals(modelaoi4)); qqline(residuals(modelaoi4), col = "red")
```

condition sig;  metric sig; c:m sig but not interaction between all three

###POSTHOCS aoi 4
```{R}
# Main effect of Metric 
maoi4ph.1 <- emmeans(artlm(modelaoi4, "Metric"), pairwise~Metric) #pairwise~
maoi4ph.1
contrast(maoi4ph.1, interaction = TRUE, adjust = "holm")

```
so overall bg eyes and face;
in depth: bg-eyes; eyes-face; eyes-mouth; eyes-nose ALL EYES SIG 

```{R}
# Main effect of condition and Metric 
maoi4ph.2 <- emmeans(artlm(modelaoi4, "Condition:Metric"), pairwise~Metric*Condition) #pairwise~
#maoi4ph.2
contrast(maoi4ph.2, interaction = TRUE, adjust = "holm")

```

```{r}
# Extract the contrasts from the object
contrasts_df <- as.data.frame(maoi4ph.2$contrasts, adjust='holm')

# Filter significant contrasts based on p.value (e.g., p < 0.05)
significant_contrasts <- contrasts_df %>%
  filter(p.value < 0.01)

# Print only significant results
print(significant_contrasts)

```
  Background Portrait Painting - Face Portrait Painting  408.5042 96.21638 2244.05   4.246  0.0060
 Background Portrait Painting - Nose Portrait Painting  518.6401 95.22950 2244.29   5.446  <.0001
 
  (Background Semi-abstract) - (Eyes Semi-abstract)      382.2203 91.13965 2244.10   4.194  0.0075
 (Eyes Semi-abstract) - (Mouth Semi-abstract)          -373.6964 88.12974 2243.74  -4.240  0.0061
 
  Background Very Abstract - Eyes Very Abstract          638.0493 80.27975 2243.48   7.948  <.0001
 Eyes Very Abstract - Face Very Abstract               -357.6611 74.36465 2243.03  -4.810  0.0004
 Eyes Very Abstract - Mouth Very Abstract              -468.8997 85.67896 2243.32  -5.473  <.0001

so overall sig are: eyes very abstract and thats it 

all interaction not sig so no need to run that posthoc 


#anova Metric 5: total duration fixation aoi
Metric 5: total duration of fixation to aois

```{r}
#metric 5: toal duration of fixation to aoi
total_duration_fixation_aoi_anova_df <- total_duration_fixation_aoi_anova_final %>%
  filter(Metric %in% c("Total_duration_of_fixations.Background", 
                       "Total_duration_of_fixations.Mouth", 
                       "Total_duration_of_fixations.Nose", 
                       "Total_duration_of_fixations.Eyes", 
                       "Total_duration_of_fixations.Face")) %>%
  mutate(Metric = sub("Total_duration_of_fixations.", "", Metric)) %>%
  select(c(Participant, Neurodiverse, Media, Condition, Metric, Value)) %>%
  distinct(Participant, Neurodiverse, Media, Condition, Metric, Value)
total_duration_fixation_aoi_anova_df

total_duration_fixation_aoi_anova_df %>%
  group_by(Condition, Neurodiverse, Metric)

```
```{r}
total_duration_fixation_aoi_anova_df$Condition <- as.factor(total_duration_fixation_aoi_anova_df$Condition)
total_duration_fixation_aoi_anova_df$Neurodiverse <- as.factor(total_duration_fixation_aoi_anova_df$Neurodiverse)
total_duration_fixation_aoi_anova_df$Metric <- as.factor(total_duration_fixation_aoi_anova_df$Metric)
str(total_duration_fixation_aoi_anova_df)
```



```{R}
#50 groups : 10 with C and ND and 5 AOIs makes 50 !
total_duration_fixation_aoi_anova_df$Metric <- as.factor(total_duration_fixation_aoi_anova_df$Metric)
total_duration_fixation_aoi_anova_df%>%
  group_by(Condition, Neurodiverse, Metric) %>%
  get_summary_stats(Value, type = "mean_sd")

```

```{r}
total_duration_fixation_aoi_anova_df %>%
  group_by(Condition, Neurodiverse, Metric) %>%
  shapiro_test(Value)%>%
  filter(p > 0.05) %>%
  print()
```
only 2/50 groups significant wow so majority meets noramlity 

```{r}
bxp_aoim5 <- ggboxplot(
  total_duration_fixation_aoi_anova_df, x = "Condition", y = "Value",
  color = "Neurodiverse", palette = "jco",
  facet.by = "Metric", short.panel.labs = FALSE
  ) + 
  theme(
    axis.text.x = element_text(size = 8, angle=45, hjust=1),  # Adjust x-axis label size
    axis.text.y = element_text(size = 8),  # Adjust y-axis label size
    strip.text = element_text(size = 10)   # Adjust facet label size
  )
bxp_aoim5
```

```{r}
total_duration_fixation_aoi_anova_df  %>%
  group_by(Condition, Metric, Neurodiverse) %>%
  identify_outliers(Value)

```
144 outliers
 
```{r}
leveneTest(Value ~ Neurodiverse * Condition * Metric, data =total_duration_fixation_aoi_anova_df)
```
significant SO NON PARAMETRIC

```{R}
#mixed effects anova NP type 3 ARTnova takws a while to run

modelaoi5 = art(Value ~ Neurodiverse*Condition*Metric + (1|Participant),
               data = total_duration_fixation_aoi_anova_df)
maoi5 <-anova(modelaoi5)
maoi5$part.eta.sq = with(maoi5, `F` * `Df` / (`F` * `Df` + `Df.res`)) #ADDS PARTIAL ETA SQUARED FOR EFFECT SIZE
maoi5

#Check the normality of residuals
shapiro.test(residuals(modelaoi5))
qqnorm(residuals(modelaoi5)); qqline(residuals(modelaoi5), col = "red")
```
so condition sig, metric sig, N/M sig; C/M sig but not interaction between all (its 0.05 so almost)

###Posthocs aoi 5

```{r}
# Main effect ofMetric 
maoi5ph.1 <- emmeans(artlm(modelaoi5, "Metric"), pairwise~Metric)
maoi5ph.1
contrast(maoi5ph.1, interaction = TRUE, adjust = "holm")

```
so overall all AOIS sig; in depth:  all but eyes-face are sig

```{r}
# Main effect of ND and Metric 
maoi5ph.2 <- emmeans(artlm(modelaoi5, "Neurodiverse:Metric"), pairwise~Metric*Neurodiverse) #pairwise~
#maoi5ph.2
contrast(maoi5ph.2, interaction = TRUE, adjust = "holm")


```
overall: bg/no; eyes/no;  nose/no; bg/yes; eyes/no; nose/yes

in depth: bg/no-eyes/no; bg/no-mouth/no;bg/no-nose/no; bg/no-bg/yes; ;eyes/no-eyes/yes;face/no-mouth/no; face/no-bg/yes; face/no-mouth/yes; mouth/no-eyes/yes; mouth/no-nose/yes; nose/no-eyes/yes; bg/yes- eyes/yes; bg/yes-nose/yes; eyes/yes-face/yes; eyes/yes-mouth/yes; mouth/yes-nose/yes

```{r}
# Extract the contrasts from the object
contrasts_df <- as.data.frame(maoi5ph.2$contrasts, adjust='holm')

# Filter significant contrasts based on p.value (e.g., p < 0.05)
significant_contrasts <- contrasts_df %>%
  filter(p.value < 0.01)

# Print only significant results
print(significant_contrasts)

```
 within nt
 Background No - Eyes No        -272.1267 68.68821 2904.00  -3.962  0.0024
 Background No - Mouth No       -388.4192 69.54151 2904.00  -5.585  <.0001
 Background No - Nose No        -277.4767 68.68821 2904.00  -4.040  0.0019
 
 Face No - Mouth No             -274.6358 69.54151 2904.00  -3.949  0.0025
 
  Background Yes - Eyes Yes       497.8400 68.68821 2904.00   7.248  <.0001
 Background Yes - Nose Yes       409.5300 68.68821 2904.00   5.962  <.0001
 
 Eyes Yes - Face Yes            -279.3467 68.68821 2904.00  -4.067  0.0017
 Eyes Yes - Mouth Yes           -472.7925 69.54151 2904.00  -6.799  <.0001
 Mouth Yes - Nose Yes            384.4825 69.54151 2904.00   5.529  <.0001
 
 within aoi
 Background No - Background Yes -487.7000 74.79073  199.83  -6.521  <.0001
 Eyes No - Eyes Yes              282.2667 74.79073  199.83   3.774  0.0061
 
 
```{r}
# Main effect of condition and Metric 
maoi5ph.3 <- emmeans(artlm(modelaoi5, "Condition:Metric"), pairwise~Metric*Condition) #pairwise~
#maoi5ph.3
contrast(maoi5ph.3, interaction = TRUE, adjust = "holm")


```
overall: bg/RI ; eyes/RI; FACE/RI; NOSE/RI; EYES/PP; EYES/SA; EYES/VA; FACE/VA; NOSE/VA

OVERALL INTERACTION BETWEEN ALL THRE NON SIG SO NO NEED TO RUN POSTHOC ON IT 
```{r}
# Extract the contrasts from the object
contrasts_df <- as.data.frame(maoi5ph.3$contrasts, adjust='holm')

# Filter significant contrasts based on p.value (e.g., p < 0.05)
significant_contrasts <- contrasts_df %>%
  filter(p.value < 0.01)

# Print only significant results
print(significant_contrasts)

```

#anova Metric 6:Number of fixations 

Metric 6: number of fixations 

```{r}
#metric 5: toal duration of fixation to aoi

no_fixation_aoi_anova_df <- no_fixation_aoi_anova_final %>%
  filter(Metric %in%  c("Number_of_fixations.Background", 
                       "Number_of_fixations.Mouth", 
                       "Number_of_fixations.Nose", 
                       "Number_of_fixations.Eyes", 
                       "Number_of_fixations.Face")) %>%
  mutate(Metric = sub("Number_of_fixations.", "", Metric)) %>%
  select(c(Participant, Neurodiverse, Media, Condition, Metric, Value)) %>%
  distinct(Participant, Neurodiverse, Media, Condition, Metric, Value)
no_fixation_aoi_anova_df

no_fixation_aoi_anova_df %>%
  group_by(Condition, Neurodiverse, Metric)

```
```{r}
no_fixation_aoi_anova_df$Condition <- as.factor(no_fixation_aoi_anova_df$Condition)
no_fixation_aoi_anova_df$Neurodiverse <- as.factor(no_fixation_aoi_anova_df$Neurodiverse)
no_fixation_aoi_anova_df$Metric <- as.factor(no_fixation_aoi_anova_df$Metric)
str(no_fixation_aoi_anova_df)
```



```{R}
#50 groups : 10 with C and ND and 5 AOIs makes 50 !
no_fixation_aoi_anova_df$Metric <- as.factor(no_fixation_aoi_anova_df$Metric)
no_fixation_aoi_anova_df%>%
  group_by(Condition, Neurodiverse, Metric) %>%
  get_summary_stats(Value, type = "mean_sd")

```

```{r}
no_fixation_aoi_anova_df %>%
  group_by(Condition, Neurodiverse, Metric) %>%
  shapiro_test(Value)%>%
  filter(p > 0.05) %>%
  print()
```
only 3/50 groups significant wow so majority meets noramlity 

```{r}
bxp_aoim6 <- ggboxplot(
  no_fixation_aoi_anova_df, x = "Condition", y = "Value",
  color = "Neurodiverse", palette = "jco",
  facet.by = "Metric", short.panel.labs = FALSE
  ) + 
  theme(
    axis.text.x = element_text(size = 8, angle=45, hjust=1),  # Adjust x-axis label size
    axis.text.y = element_text(size = 8),  # Adjust y-axis label size
    strip.text = element_text(size = 10)   # Adjust facet label size
  )
bxp_aoim6
```

```{r}
no_fixation_aoi_anova_df  %>%
  group_by(Condition, Metric, Neurodiverse) %>%
  identify_outliers(Value)

```
126 outliers
 
```{r}
leveneTest(Value ~ Neurodiverse * Condition * Metric, data =no_fixation_aoi_anova_df)
```
significant SO NON PARAMETRIC

```{R}
#mixed effects anova NP type 3 ARTnova takws a while to run

modelaoi6 = art(Value ~ Neurodiverse*Condition*Metric + (1|Participant),
               data = no_fixation_aoi_anova_df)
maoi6 <-anova(modelaoi6)
maoi6$part.eta.sq = with(maoi6, `F` * `Df` / (`F` * `Df` + `Df.res`)) #ADDS PARTIAL ETA SQUARED FOR EFFECT SIZE
maoi6

#Check the normality of residuals
shapiro.test(residuals(modelaoi6))
qqnorm(residuals(modelaoi6)); qqline(residuals(modelaoi6), col = "red")
```
condition sig ; metric sig; N/C sig; N/M sig; C/M sig; N:C:M SIG (interaction between all significcant)

###posthocs aoi metric 6 


```{R}
# Main effect of  Metric 
maoi6ph.1 <- emmeans(artlm.con(modelaoi6, "Metric"), pairwise~Metric) #pairwise~
maoi6ph.1
contrast(maoi6ph.1, interaction = TRUE, adjust = "holm")

```

overall, all sig; indepth: all sig !
need to run posthocs for sure 



```{r}
# Main effect of ND and Metric 
maoi6ph.2 <- emmeans(artlm(modelaoi6, "Neurodiverse:Metric"), pairwise~Metric*Neurodiverse) #pairwise~
#maoi6ph.2
contrast(maoi6ph.2, interaction = TRUE, adjust = "holm")


```
overall: all but mouth/ no and motuh/yes significant 
in depth: bg/no-eyes/no; bg/no-mouth/no; bg/no-nose/no; bg/no-bg/yes;eyes/no-face/no; face/no-mouth/no;face/no-nose/no; mouth/no-eyes/yes; bg/yes-eyes/yes; bg/yes-nose/yes; eyes/yes-face/yes; mouth/yes-nose/yes

```{r}
# Extract the contrasts from the object
contrasts_df <- as.data.frame(maoi6ph.2$contrasts, adjust='holm')

# Filter significant contrasts based on p.value (e.g., p < 0.05)
significant_contrasts <- contrasts_df %>%
  filter(p.value < 0.01)

# Print only significant results
print(significant_contrasts)

```
Background No - Eyes No        -460.6400  67.06036 2904.00  -6.869  <.0001
 Background No - Mouth No       -498.7167  67.89343 2904.00  -7.346  <.0001
 Background No - Nose No        -427.1667  67.06036 2904.00  -6.370  <.0001
 
 Background No - Background Yes -442.9583 106.00141   47.43  -4.179  0.0044
 
 Eyes No - Face No               366.3900  67.06036 2904.00   5.464  <.0001
 
 Face No - Mouth No             -404.4667  67.89343 2904.00  -5.957  <.0001
 Face No - Nose No              -332.9167  67.06036 2904.00  -4.964  <.0001
 
 Background Yes - Eyes Yes       374.1500  67.06036 2904.00   5.579  <.0001
 Background Yes - Nose Yes       301.3983  67.06036 2904.00   4.494  0.0003
 Eyes Yes - Face Yes            -255.3417  67.06036 2904.00  -3.808  0.0049
 Eyes Yes - Mouth Yes           -341.3942  67.89343 2904.00  -5.028  <.0001
 Mouth Yes - Nose Yes            268.6425  67.89343 2904.00   3.957  0.0028

```{r}
# Main effect of condition and Metric 
maoi6ph.3 <- emmeans(artlm(modelaoi6, "Condition:Metric"), pairwise~Metric*Condition) #pairwise~
#maoi6ph.3
contrast(maoi6ph.3, interaction = TRUE, adjust = "holm")

```
okay so overall:bg/RI; eyes/ri; face/ri; nose/ri; eyes/SA; bg/AB;  face/VA; nose/VA
```{r}
# Extract the contrasts from the object
contrasts_df <- as.data.frame(maoi6ph.3$contrasts, adjust='holm')

# Filter significant contrasts based on p.value (e.g., p < 0.05)
significant_contrasts <- contrasts_df %>%
  filter(p.value < 0.01)

# Print only significant results
print(significant_contrasts)

```
conditions 
Background Realistic image - Eyes Realistic image       -876.4583 103.4033 2904  -8.476  <.0001
 Background Realistic image - Mouth Realistic image      -605.0500 103.4033 2904  -5.851  <.0001
 Background Realistic image - Nose Realistic image       -696.5833 103.4033 2904  -6.737  <.0001
 
 Eyes Realistic image - Face Realistic image              913.5500 103.4033 2904   8.835  <.0001
 Face Realistic image - Mouth Realistic image            -642.1417 103.4033 2904  -6.210  <.0001
 Face Realistic image - Nose Realistic image             -733.6750 103.4033 2904  -7.095  <.0001
 
 Eyes Portrait Painting - Eyes Very Abstract              493.5833 103.4033 2904   4.773  0.0004
  Eyes Portrait Painting - (Eyes Semi-abstract)            528.3417 103.4033 2904   5.110  0.0001
  
  (Eyes Semi-abstract) - (Face Semi-abstract)             -435.3417 103.4033 2904  -4.210  0.0058
 (Eyes Semi-abstract) - (Mouth Semi-abstract)            -693.4250 103.4033 2904  -6.706  <.0001
 (Eyes Semi-abstract) - (Nose Semi-abstract)             -569.6583 103.4033 2904  -5.509  <.0001
 
 
 AOI
 Background Realistic image - (Background Semi-abstract) -446.4083 103.4033 2904  -4.317  0.0037
 Background Realistic image - Background Abstract        -611.6833 103.4033 2904  -5.916  <.0001
 
  Eyes Realistic image - (Eyes Semi-abstract)              837.5000 103.4033 2904   8.099  <.0001
 Eyes Realistic image - Eyes Abstract                     503.3000 103.4033 2904   4.867  0.0003
 Eyes Realistic image - Eyes Very Abstract                802.7417 103.4033 2904   7.763  <.0001
 
  Face Realistic image - (Face Semi-abstract)             -511.3917 103.4033 2904  -4.946  0.0002
 Face Realistic image - Face Abstract                    -448.9167 103.4033 2904  -4.341  0.0033
 Face Realistic image - Face Very Abstract               -641.9417 103.4033 2904  -6.208  <.0001
 
 Nose Realistic image - Nose Very Abstract                912.9750 103.4033 2904   8.829  <.0001
  Nose Portrait Painting - Nose Very Abstract              875.2917 103.4033 2904   8.465  <.0001
  (Nose Semi-abstract) - Nose Very Abstract                825.0083 103.4033 2904   7.979  <.0001
  Nose Abstract - Nose Very Abstract                       595.5250 103.4033 2904   5.759  <.0001

 Background Very Abstract - Nose Very Abstract            597.7667 103.4033 2904   5.781  <.0001
 Eyes Very Abstract - Face Very Abstract                 -531.1333 103.4033 2904  -5.137  0.0001
 Face Very Abstract - Nose Very Abstract                  821.2417 103.4033 2904   7.942  <.0001
 Mouth Very Abstract - Nose Very Abstract                 735.0521 109.6758 2904   6.702  <.0001

now do all 3 interaction post hoc
```{r}
#interaction between Cond and Neurodiverse within each AOI
maoi6ph.4 <- emmeans(artlm(modelaoi6, "Neurodiverse:Condition:Metric"), pairwise~ Condition*Neurodiverse | Metric)
#maoi6ph.4

# Perform pairwise comparisons within each Metric
contrast(maoi6ph.4, method = "pairwise", interaction = TRUE, adjust = "holm")


```
extract only sig 

```{r}
# Extract the contrasts from the object
contrasts_df <- as.data.frame(maoi6ph.4$contrasts, adjust='holm')

# Filter significant contrasts based on p.value (e.g., p < 0.05)
significant_contrasts <- contrasts_df %>%
  filter(p.value < 0.05)

# Print only significant results
print(significant_contrasts)

```


```{r}
# now lets check interaction for all together ?
maoi6ph.5 <- emmeans(artlm(modelaoi6, "Neurodiverse:Condition:Metric"),pairwise~ Condition*Neurodiverse*Metric)
#maoi6ph.5 #can uncomment to print bu tprints alot 

# Perform pairwise comparisons within each Metric
contrast(maoi6ph.5, method = "pairwise", interaction = TRUE, adjust = "holm")


```

```{r}
# Extract the contrasts from the object
contrasts_df <- as.data.frame(maoi6ph.5$contrasts, adjust="holm")

# Filter significant contrasts based on p.value (e.g., p < 0.05)
significant_contrasts <- contrasts_df %>%
  filter(p.value < 0.05)

# Print only significant results
print(significant_contrasts)


```

overall none significant but indepth this is so no need to run wilcoxons 

Metric = Face:
 contrast                                  estimate       SE   df t.ratio p.value
 Portrait Painting Yes - Very Abstract Yes 523.5333 151.9603 2904   3.445  0.0260


#MAKE INTO ANOVA TABLE FOR PAPER 
```{r}
install.packages("flextable")
install.packages("pbkrtest")
install.packages("rempsyc")
install.packages("report")
library(flextable)
library(pbkrtest)
library(rempsyc)
library(report)



```

```{R}

#so first extract only interaction terms from each aoi anova 
interaction_maoi1 <- maoi1 %>%
  filter(str_detect(Term, ":")) %>%
  select(-Df.res)

interaction_maoi2 <- maoi2 %>%
  filter(str_detect(Term, ":"))%>%
  select(-Df.res)

interaction_maoi3 <- maoi3 %>%
  filter(str_detect(Term, ":"))%>%
  select(-Df.res)

interaction_maoi4 <- maoi4 %>%
  filter(str_detect(Term, ":"))%>%
  select(-Df.res)

interaction_maoi5 <- maoi5 %>%
  filter(str_detect(Term, ":"))%>%
  select(-Df.res)

interaction_maoi6 <-maoi6 %>%
  filter(str_detect(Term, ":"))%>%
  select(-Df.res)


```

```{r}

#put altogether into one thing 
all_aoi_anovas <-  bind_rows(
  interaction_maoi1 %>% mutate(Metric = "Number of Saccades"),
  interaction_maoi2 %>% mutate(Metric = "Peak Velocity of Entry Saccades"),
  interaction_maoi3 %>% mutate(Metric = "Time to First Fixation"),
  interaction_maoi5 %>% mutate(Metric = "Total Duration of Fixations"),
  interaction_maoi6 %>% mutate(Metric = "Number of Fixations"),
)

```

```{r}
library(dplyr)
library(tidyr)
library(flextable)

# anova values
interaction_data <- all_aoi_anovas %>%
  select(Term, F, Df, `Pr(>F)`, part.eta.sq, Metric) %>%
  rename(
    `F` = F,
    `Df` = Df,
    `p` = `Pr(>F)`,
    `n` = part.eta.sq
  )

#table 
wide_data <- interaction_data %>%
  pivot_longer(cols = c(`F`, `Df`, `p`, `n`),
               names_to = "Statistic",
               values_to = "Value") %>%
  pivot_wider(names_from = c(Metric, Statistic), values_from = Value)

# add sig *
wide_data <- wide_data %>%
  mutate(across(contains("p"), ~ case_when(
    . < 0.001 ~ paste0(round(., 3), " ***"),
    . < 0.01 ~ paste0(round(., 3), " **"),
    . < 0.05 ~ paste0(round(., 3), " *"),
    . < 0.1 ~ paste0(round(., 3), " ."),
    TRUE ~ as.character(round(., 3))
  )))

# flextable
ft <- flextable(wide_data) %>%
  separate_header() %>%  # seperate headers
  autofit()  

# format
ft <- ft %>%
  align(align = "center", part = "all") %>%  # Center text
  theme_vanilla()  


ft

```
```{r}
metric_change_indices <- which(diff(as.numeric(as.factor(wide_data$Term))) != 0)
border <- fp_border_default()

library(officer)
# Add horizontal lines after each metric
for (i in metric_change_indices) {
  ft <- ft %>%
    hline(i = i, border = fp_border(width = 0), part = "body")
}

# Shade alternate rows based on metric blocks
ft <- ft %>%
  vline(j = c("Number of Saccades_n", "Peak Velocity of Entry Saccades_n", "Time to First Fixation_n", "Total Duration of Fixations_n"), border = border, part = "all") %>%
  bg(i = ~ seq_along(Term) %% 2 == 0, bg = "#D3D3D9", part = "body")
ft
```
```{r}
ft <- add_footer_lines(ft, "Signif. codes:   0 *** 0.001 ** 0.01 *")
ft
```

```{R}
#save_as_image(ft,
 # path = "C:/Users/mande/OneDrive/Masters!/Project/Eye tracking/Data/Visualisations/R visualisations/AOI Metrics/ANOVAS/anova_table.png")
```

